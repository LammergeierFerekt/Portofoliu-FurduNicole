var ng=Object.defineProperty;var pu=d=>{throw TypeError(d)};var rg=(d,t,e)=>t in d?ng(d,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[t]=e;var N=(d,t,e)=>rg(d,typeof t!="symbol"?t+"":t,e),gc=(d,t,e)=>t.has(d)||pu("Cannot "+e);var r=(d,t,e)=>(gc(d,t,"read from private field"),e?e.call(d):t.get(d)),b=(d,t,e)=>t.has(d)?pu("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(d):t.set(d,e),g=(d,t,e,i)=>(gc(d,t,"write to private field"),i?i.call(d,e):t.set(d,e),e),w=(d,t,e)=>(gc(d,t,"access private method"),e);var ie=(d,t,e,i)=>({set _(s){g(d,t,s,e)},get _(){return r(d,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();var po={};po.d=(d,t)=>{for(var e in t)po.o(t,e)&&!po.o(d,e)&&Object.defineProperty(d,e,{enumerable:!0,get:t[e]})};po.o=(d,t)=>Object.prototype.hasOwnProperty.call(d,t);var V=globalThis.pdfjsLib={};po.d(V,{AbortException:()=>en,AnnotationEditorLayer:()=>Nd,AnnotationEditorParamsType:()=>Q,AnnotationEditorType:()=>j,AnnotationEditorUIManager:()=>wr,AnnotationLayer:()=>ud,AnnotationMode:()=>bs,AnnotationType:()=>_t,ColorPicker:()=>Gh,DOMSVGFactory:()=>Fh,DrawLayer:()=>Ud,FeatureTest:()=>Xt,GlobalWorkerOptions:()=>hs,ImageKind:()=>eh,InvalidPDFException:()=>Cc,MathClamp:()=>le,OPS:()=>Rh,OutputScale:()=>ps,PDFDataRangeTransport:()=>Xf,PDFDateString:()=>Zd,PDFWorker:()=>Fr,PasswordResponses:()=>lg,PermissionFlag:()=>og,PixelsPerInch:()=>sn,RenderingCancelledException:()=>Xd,ResponseException:()=>Dh,SignatureExtractor:()=>cs,SupportedImageMimeTypes:()=>Tc,TextLayer:()=>go,TouchManager:()=>Oh,Util:()=>G,VerbosityLevel:()=>lc,XfaLayer:()=>Zf,build:()=>km,createValidAbsoluteUrl:()=>ug,fetchData:()=>Hl,getDocument:()=>wm,getFilenameFromUrl:()=>xg,getPdfFilenameFromUrl:()=>vg,getUuid:()=>qu,getXfaPageViewport:()=>Sg,isDataScheme:()=>dc,isPdfFile:()=>Yd,isValidExplicitDest:()=>Sm,noContextMenu:()=>ri,normalizeUnicode:()=>bg,setLayerDimensions:()=>br,shadow:()=>K,stopEvent:()=>Et,version:()=>Mm});const $t=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Wu=[1,0,0,1,0,0],Ec=[.001,0,0,.001,0,0],mc=1.35,Ie={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},bs={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ag="pdfjs_internal_editor_",j={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Q={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},og={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Zt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},eh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},_t={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Er={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},lc={ERRORS:0,WARNINGS:1,INFOS:5},Rh={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},ql={moveTo:0,lineTo:1,curveTo:2,closePath:3},lg={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let hc=lc.WARNINGS;function hg(d){Number.isInteger(d)&&(hc=d)}function cg(){return hc}function cc(d){hc>=lc.INFOS&&console.log(`Info: ${d}`)}function q(d){hc>=lc.WARNINGS&&console.log(`Warning: ${d}`)}function at(d){throw new Error(d)}function Ct(d,t){d||at(t)}function dg(d){switch(d==null?void 0:d.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ug(d,t=null,e=null){if(!d)return null;if(e&&typeof d=="string"){if(e.addDefaultProtocol&&d.startsWith("www.")){const s=d.match(/\./g);(s==null?void 0:s.length)>=2&&(d=`http://${d}`)}if(e.tryConvertEncoding)try{d=yg(d)}catch{}}const i=t?URL.parse(d,t):URL.parse(d);return dg(i)?i:null}function K(d,t,e,i=!1){return Object.defineProperty(d,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const xr=function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t}();class gu extends xr{constructor(t,e){super(t,"PasswordException"),this.code=e}}class yc extends xr{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Cc extends xr{constructor(t){super(t,"InvalidPDFException")}}class Dh extends xr{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class fg extends xr{constructor(t){super(t,"FormatError")}}class en extends xr{constructor(t){super(t,"AbortException")}}function ju(d){(typeof d!="object"||(d==null?void 0:d.length)===void 0)&&at("Invalid argument for bytesToString");const t=d.length,e=8192;if(t<e)return String.fromCharCode.apply(null,d);const i=[];for(let s=0;s<t;s+=e){const n=Math.min(s+e,t),a=d.subarray(s,n);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Ul(d){typeof d!="string"&&at("Invalid argument for stringToBytes");const t=d.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=d.charCodeAt(i)&255;return e}function pg(d){return String.fromCharCode(d>>24&255,d>>16&255,d>>8&255,d&255)}function jd(d){const t=Object.create(null);for(const[e,i]of d)t[e]=i;return t}function gg(){const d=new Uint8Array(4);return d[0]=1,new Uint32Array(d.buffer,0,1)[0]===1}function mg(){try{return new Function(""),!0}catch{return!1}}class Xt{static get isLittleEndian(){return K(this,"isLittleEndian",gg())}static get isEvalSupported(){return K(this,"isEvalSupported",mg())}static get isOffscreenCanvasSupported(){return K(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return K(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){if(typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"){const{platform:t,userAgent:e}=navigator;return K(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}return K(this,"platform",{isAndroid:!1,isLinux:!1,isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return K(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const bc=Array.from(Array(256).keys(),d=>d.toString(16).padStart(2,"0"));var us,ih,Pc;class G{static makeHexColor(t,e,i){return`#${bc[t]}${bc[e]}${bc[i]}`}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const i=t[0]*e[0]+t[1]*e[2]+e[4],s=t[0]*e[1]+t[1]*e[3]+e[5];return[i,s]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2],s=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,n=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i;return[s,n]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),s=this.applyTransform(t.slice(2,4),e),n=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],s[0],n[0],a[0]),Math.min(i[1],s[1],n[1],a[1]),Math.max(i[0],s[0],n[0],a[0]),Math.max(i[1],s[1],n[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],s=t[0]*e[1]+t[1]*e[3],n=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],o=(i+a)/2,l=Math.sqrt((i+a)**2-4*(i*a-n*s))/2,h=o+l||1,c=o-l||1;return[Math.sqrt(h),Math.sqrt(c)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const n=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return n>a?null:[i,n,s,a]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,s,n){n[0]=Math.min(n[0],t,i),n[1]=Math.min(n[1],e,s),n[2]=Math.max(n[2],t,i),n[3]=Math.max(n[3],e,s)}static bezierBoundingBox(t,e,i,s,n,a,o,l,h){h[0]=Math.min(h[0],t,o),h[1]=Math.min(h[1],e,l),h[2]=Math.max(h[2],t,o),h[3]=Math.max(h[3],e,l),w(this,us,Pc).call(this,t,i,n,o,e,s,a,l,3*(-t+3*(i-n)+o),6*(t-2*i+n),3*(i-t),h),w(this,us,Pc).call(this,t,i,n,o,e,s,a,l,3*(-e+3*(s-a)+l),6*(e-2*s+a),3*(s-e),h)}}us=new WeakSet,ih=function(t,e,i,s,n,a,o,l,h,c){if(h<=0||h>=1)return;const f=1-h,p=h*h,y=p*h,v=f*(f*(f*t+3*h*e)+3*p*i)+y*s,A=f*(f*(f*n+3*h*a)+3*p*o)+y*l;c[0]=Math.min(c[0],v),c[1]=Math.min(c[1],A),c[2]=Math.max(c[2],v),c[3]=Math.max(c[3],A)},Pc=function(t,e,i,s,n,a,o,l,h,c,f,p){if(Math.abs(h)<1e-12){Math.abs(c)>=1e-12&&w(this,us,ih).call(this,t,e,i,s,n,a,o,l,-f/c,p);return}const y=c**2-4*f*h;if(y<0)return;const v=Math.sqrt(y),A=2*h;w(this,us,ih).call(this,t,e,i,s,n,a,o,l,(-c+v)/A,p),w(this,us,ih).call(this,t,e,i,s,n,a,o,l,(-c-v)/A,p)},b(G,us);function yg(d){return decodeURIComponent(escape(d))}let wc=null,mu=null;function bg(d){return wc||(wc=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,mu=new Map([["ﬅ","ſt"]])),d.replaceAll(wc,(t,e,i)=>e?e.normalize("NFKC"):mu.get(i))}function qu(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const d=new Uint8Array(32);return crypto.getRandomValues(d),ju(d)}const qd="pdfjs_internal_id_";function wg(d,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,s,...n]=e;if(!d(i)&&!Number.isInteger(i)||!t(s))return!1;const a=n.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of n)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function le(d,t,e){return Math.min(Math.max(d,t),e)}function Xu(d){return Uint8Array.prototype.toBase64?d.toBase64():btoa(ju(d))}function Ag(d){return Uint8Array.fromBase64?Uint8Array.fromBase64(d):Ul(atob(d))}typeof Promise.try!="function"&&(Promise.try=function(d,...t){return new Promise(e=>{e(d(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(d){return d.reduce((t,e)=>t+e,0)});const Ii="http://www.w3.org/2000/svg",cn=class cn{};N(cn,"CSS",96),N(cn,"PDF",72),N(cn,"PDF_TO_CSS_UNITS",cn.CSS/cn.PDF);let sn=cn;async function Hl(d,t="text"){if(Cr(d,document.baseURI)){const e=await fetch(d);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",d,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class zl{constructor({viewBox:t,userUnit:e,scale:i,rotation:s,offsetX:n=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=s,this.offsetX=n,this.offsetY=a,i*=e;const l=(t[2]+t[0])/2,h=(t[3]+t[1])/2;let c,f,p,y;switch(s%=360,s<0&&(s+=360),s){case 180:c=-1,f=0,p=0,y=1;break;case 90:c=0,f=1,p=1,y=0;break;case 270:c=0,f=-1,p=-1,y=0;break;case 0:c=1,f=0,p=0,y=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,y=-y);let v,A,_,C;c===0?(v=Math.abs(h-t[1])*i+n,A=Math.abs(l-t[0])*i+a,_=(t[3]-t[1])*i,C=(t[2]-t[0])*i):(v=Math.abs(l-t[0])*i+n,A=Math.abs(h-t[1])*i+a,_=(t[2]-t[0])*i,C=(t[3]-t[1])*i),this.transform=[c*i,f*i,p*i,y*i,v-c*i*l-p*i*h,A-f*i*l-y*i*h],this.width=_,this.height=C}get rawDims(){const t=this.viewBox;return K(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:n=!1}={}){return new zl({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:n})}convertToViewportPoint(t,e){return G.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=G.applyTransform([t[0],t[1]],this.transform),i=G.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return G.applyInverseTransform([t,e],this.transform)}}class Xd extends xr{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function dc(d){const t=d.length;let e=0;for(;e<t&&d[e].trim()==="";)e++;return d.substring(e,e+5).toLowerCase()==="data:"}function Yd(d){return typeof d=="string"&&/\.pdf$/i.test(d)}function xg(d){return[d]=d.split(/[#?]/,1),d.substring(d.lastIndexOf("/")+1)}function vg(d,t="document.pdf"){if(typeof d!="string")return t;if(dc(d))return q('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=e.exec(d);let n=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(n&&(n=n[0],n.includes("%")))try{n=i.exec(decodeURIComponent(n))[0]}catch{}return n||t}class yu{constructor(){N(this,"started",Object.create(null));N(this,"times",[])}time(t){t in this.started&&q(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||q(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:n}of this.times)t.push(`${i.padEnd(e)} ${n-s}ms
`);return t.join("")}}function Cr(d,t){const e=t?URL.parse(d,t):URL.parse(d);return(e==null?void 0:e.protocol)==="http:"||(e==null?void 0:e.protocol)==="https:"}function ri(d){d.preventDefault()}function Et(d){d.preventDefault(),d.stopPropagation()}var yo;class Zd{static toDateObject(t){if(!t||typeof t!="string")return null;r(this,yo)||g(this,yo,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=r(this,yo).exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let n=parseInt(e[3],10);n=n>=1&&n<=31?n:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const h=e[7]||"Z";let c=parseInt(e[8],10);c=c>=0&&c<=23?c:0;let f=parseInt(e[9],10)||0;return f=f>=0&&f<=59?f:0,h==="-"?(a+=c,o+=f):h==="+"&&(a-=c,o-=f),new Date(Date.UTC(i,s,n,a,o,l))}}yo=new WeakMap,b(Zd,yo);function Sg(d,{scale:t=1,rotation:e=0}){const{width:i,height:s}=d.attributes.style,n=[0,0,parseInt(i),parseInt(s)];return new zl({viewBox:n,userUnit:1,scale:t,rotation:e})}function Kd(d){if(d.startsWith("#")){const t=parseInt(d.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return d.startsWith("rgb(")?d.slice(4,-1).split(",").map(t=>parseInt(t)):d.startsWith("rgba(")?d.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(q(`Not a valid color format: "${d}"`),[0,0,0])}function _g(d){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of d.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;d.set(e,Kd(i))}t.remove()}function ut(d){const{a:t,b:e,c:i,d:s,e:n,f:a}=d.getTransform();return[t,e,i,s,n,a]}function li(d){const{a:t,b:e,c:i,d:s,e:n,f:a}=d.getTransform().invertSelf();return[t,e,i,s,n,a]}function br(d,t,e=!1,i=!0){if(t instanceof zl){const{pageWidth:s,pageHeight:n}=t.rawDims,{style:a}=d,o=Xt.isCSSRoundSupported,l=`var(--total-scale-factor) * ${s}px`,h=`var(--total-scale-factor) * ${n}px`,c=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,f=o?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!e||t.rotation%180===0?(a.width=c,a.height=f):(a.width=f,a.height=c)}i&&d.setAttribute("data-main-rotation",t.rotation)}class ps{constructor(){const{pixelRatio:t}=ps;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,s){let n=1/0,a=1/0,o=1/0;i>0&&(n=Math.sqrt(i/(t*e))),s!==-1&&(a=s/t,o=s/e);const l=Math.min(n,a,o);return this.sx>l||this.sy>l?(this.sx=l,this.sy=l,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}}const Tc=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var ws,un,Oe,As,bo,Nr,wo,Vh,Yu,qt,Zu,Ku,Ya,Qu,sh;const Li=class Li{constructor(t){b(this,qt);b(this,ws,null);b(this,un,null);b(this,Oe);b(this,As,null);b(this,bo,null);b(this,Nr,null);g(this,Oe,t),r(Li,wo)||g(Li,wo,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=g(this,ws,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=r(this,Oe)._uiManager._signal;t.addEventListener("contextmenu",ri,{signal:e}),t.addEventListener("pointerdown",w(Li,Vh,Yu),{signal:e});const i=g(this,As,document.createElement("div"));i.className="buttons",t.append(i);const s=r(this,Oe).toolbarPosition;if(s){const{style:n}=t,a=r(this,Oe)._uiManager.direction==="ltr"?1-s[0]:s[0];n.insetInlineEnd=`${100*a}%`,n.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return w(this,qt,Qu).call(this),t}get div(){return r(this,ws)}hide(){var t;r(this,ws).classList.add("hidden"),(t=r(this,un))==null||t.hideDropdown()}show(){var t;r(this,ws).classList.remove("hidden"),(t=r(this,bo))==null||t.shown()}async addAltText(t){const e=await t.render();w(this,qt,Ya).call(this,e),r(this,As).prepend(e,r(this,qt,sh)),g(this,bo,t)}addColorPicker(t){g(this,un,t);const e=t.renderButton();w(this,qt,Ya).call(this,e),r(this,As).prepend(e,r(this,qt,sh))}async addEditSignatureButton(t){const e=g(this,Nr,await t.renderEditButton(r(this,Oe)));w(this,qt,Ya).call(this,e),r(this,As).prepend(e,r(this,qt,sh))}updateEditSignatureButton(t){r(this,Nr)&&(r(this,Nr).title=t)}remove(){var t;r(this,ws).remove(),(t=r(this,un))==null||t.destroy(),g(this,un,null)}};ws=new WeakMap,un=new WeakMap,Oe=new WeakMap,As=new WeakMap,bo=new WeakMap,Nr=new WeakMap,wo=new WeakMap,Vh=new WeakSet,Yu=function(t){t.stopPropagation()},qt=new WeakSet,Zu=function(t){r(this,Oe)._focusEventsAllowed=!1,Et(t)},Ku=function(t){r(this,Oe)._focusEventsAllowed=!0,Et(t)},Ya=function(t){const e=r(this,Oe)._uiManager._signal;t.addEventListener("focusin",w(this,qt,Zu).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",w(this,qt,Ku).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",ri,{signal:e})},Qu=function(){const{editorType:t,_uiManager:e}=r(this,Oe),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",r(Li,wo)[t]),w(this,qt,Ya).call(this,i),i.addEventListener("click",s=>{e.delete()},{signal:e._signal}),r(this,As).append(i)},sh=function(){const t=document.createElement("div");return t.className="divider",t},b(Li,Vh),b(Li,wo,null);let Mc=Li;var Ao,fn,pn,nn,Ju,tf,ef;class Eg{constructor(t){b(this,nn);b(this,Ao,null);b(this,fn,null);b(this,pn);g(this,pn,t)}show(t,e,i){const[s,n]=w(this,nn,tf).call(this,e,i),{style:a}=r(this,fn)||g(this,fn,w(this,nn,Ju).call(this));t.append(r(this,fn)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*n}% + var(--editor-toolbar-vert-offset))`}hide(){r(this,fn).remove()}}Ao=new WeakMap,fn=new WeakMap,pn=new WeakMap,nn=new WeakSet,Ju=function(){const t=g(this,fn,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",ri,{signal:r(this,pn)._signal});const e=g(this,Ao,document.createElement("div"));return e.className="buttons",t.append(e),w(this,nn,ef).call(this),t},tf=function(t,e){let i=0,s=0;for(const n of t){const a=n.y+n.height;if(a<i)continue;const o=n.x+(e?n.width:0);if(a>i){s=o,i=a;continue}e?o>s&&(s=o):o<s&&(s=o)}return[e?1-s:s,i]},ef=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=r(this,pn)._signal;t.addEventListener("contextmenu",ri,{signal:i}),t.addEventListener("click",()=>{r(this,pn).highlightSelection("floating_button")},{signal:i}),r(this,Ao).append(t)};function Qd(d,t,e){for(const i of e)t.addEventListener(i,d[i].bind(d))}var $h;class Cg{constructor(){b(this,$h,0)}get id(){return`${ag}${ie(this,$h)._++}`}}$h=new WeakMap;var Gr,xo,Qt,Br,nh;const lu=class lu{constructor(){b(this,Br);b(this,Gr,qu());b(this,xo,0);b(this,Qt,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const n=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return K(this,"_isSVGFittingCanvas",n)}async getFromFile(t){const{lastModified:e,name:i,size:s,type:n}=t;return w(this,Br,nh).call(this,`${e}_${i}_${s}_${n}`,t)}async getFromUrl(t){return w(this,Br,nh).call(this,t,t)}async getFromBlob(t,e){const i=await e;return w(this,Br,nh).call(this,t,i)}async getFromId(t){r(this,Qt)||g(this,Qt,new Map);const e=r(this,Qt).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){r(this,Qt)||g(this,Qt,new Map);let i=r(this,Qt).get(t);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${r(this,Gr)}_${ie(this,xo)._++}`,refCounter:1,isSvg:!1},r(this,Qt).set(t,i),r(this,Qt).set(i.id,i),i}getSvgUrl(t){const e=r(this,Qt).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var s;r(this,Qt)||g(this,Qt,new Map);const e=r(this,Qt).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const n=new OffscreenCanvas(i.width,i.height);n.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=n.convertToBlob()}(s=i.close)==null||s.call(i),e.bitmap=null}isValidId(t){return t.startsWith(`image_${r(this,Gr)}_`)}};Gr=new WeakMap,xo=new WeakMap,Qt=new WeakMap,Br=new WeakSet,nh=async function(t,e){r(this,Qt)||g(this,Qt,new Map);let i=r(this,Qt).get(t);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${r(this,Gr)}_${ie(this,xo)._++}`,refCounter:0,isSvg:!1});let s;if(typeof e=="string"?(i.url=e,s=await Hl(e,"blob")):e instanceof File?s=i.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const n=lu._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((h,c)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,h()},a.onload=async()=>{const f=i.svgUrl=a.result;o.src=await n?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=c});a.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){q(s),i=null}return r(this,Qt).set(t,i),i&&r(this,Qt).set(i.id,i),i};let kc=lu;var wt,xs,vo,gt;class Pg{constructor(t=128){b(this,wt,[]);b(this,xs,!1);b(this,vo);b(this,gt,-1);g(this,vo,t)}add({cmd:t,undo:e,post:i,mustExec:s,type:n=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&t(),r(this,xs))return;const l={cmd:t,undo:e,post:i,type:n};if(r(this,gt)===-1){r(this,wt).length>0&&(r(this,wt).length=0),g(this,gt,0),r(this,wt).push(l);return}if(a&&r(this,wt)[r(this,gt)].type===n){o&&(l.undo=r(this,wt)[r(this,gt)].undo),r(this,wt)[r(this,gt)]=l;return}const h=r(this,gt)+1;h===r(this,vo)?r(this,wt).splice(0,1):(g(this,gt,h),h<r(this,wt).length&&r(this,wt).splice(h)),r(this,wt).push(l)}undo(){if(r(this,gt)===-1)return;g(this,xs,!0);const{undo:t,post:e}=r(this,wt)[r(this,gt)];t(),e==null||e(),g(this,xs,!1),g(this,gt,r(this,gt)-1)}redo(){if(r(this,gt)<r(this,wt).length-1){g(this,gt,r(this,gt)+1),g(this,xs,!0);const{cmd:t,post:e}=r(this,wt)[r(this,gt)];t(),e==null||e(),g(this,xs,!1)}}hasSomethingToUndo(){return r(this,gt)!==-1}hasSomethingToRedo(){return r(this,gt)<r(this,wt).length-1}cleanType(t){if(r(this,gt)!==-1){for(let e=r(this,gt);e>=0;e--)if(r(this,wt)[e].type!==t){r(this,wt).splice(e+1,r(this,gt)-e),g(this,gt,e);return}r(this,wt).length=0,g(this,gt,-1)}}destroy(){g(this,wt,null)}}wt=new WeakMap,xs=new WeakMap,vo=new WeakMap,gt=new WeakMap;var Wh,sf;class Vl{constructor(t){b(this,Wh);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Xt.platform;for(const[i,s,n={}]of t)for(const a of i){const o=a.startsWith("mac+");e&&o?(this.callbacks.set(a.slice(4),{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1))):!e&&!o&&(this.callbacks.set(a,{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(w(this,Wh,sf).call(this,e));if(!i)return;const{callback:s,options:{bubbles:n=!1,args:a=[],checker:o=null}}=i;o&&!o(t,e)||(s.bind(t,...a,e)(),n||Et(e))}}Wh=new WeakSet,sf=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const jh=class jh{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return _g(t),K(this,"_colors",t)}convert(t){const e=Kd(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((n,a)=>n===e[a]))return jh._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?G.makeHexColor(...e):t}};N(jh,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Ic=jh;var Ur,be,kt,Ut,Hr,Fi,zr,Fe,vs,gn,Vr,mn,di,je,yn,So,_o,$r,Eo,ui,Ss,Wr,_s,fi,qh,Es,Co,Cs,bn,wn,Ps,Po,Dt,st,Ni,Ts,An,To,Mo,Ms,pi,Gi,ko,Ne,R,rh,Rc,nf,rf,ah,af,of,lf,Dc,hf,Lc,Oc,cf,se,Ri,df,uf,Fc,ff,Za,Nc;const Dr=class Dr{constructor(t,e,i,s,n,a,o,l,h,c,f,p,y,v){b(this,R);b(this,Ur,new AbortController);b(this,be,null);b(this,kt,new Map);b(this,Ut,new Map);b(this,Hr,null);b(this,Fi,null);b(this,zr,null);b(this,Fe,new Pg);b(this,vs,null);b(this,gn,null);b(this,Vr,0);b(this,mn,new Set);b(this,di,null);b(this,je,null);b(this,yn,new Set);N(this,"_editorUndoBar",null);b(this,So,!1);b(this,_o,!1);b(this,$r,!1);b(this,Eo,null);b(this,ui,null);b(this,Ss,null);b(this,Wr,null);b(this,_s,!1);b(this,fi,null);b(this,qh,new Cg);b(this,Es,!1);b(this,Co,!1);b(this,Cs,null);b(this,bn,null);b(this,wn,null);b(this,Ps,null);b(this,Po,null);b(this,Dt,j.NONE);b(this,st,new Set);b(this,Ni,null);b(this,Ts,null);b(this,An,null);b(this,To,null);b(this,Mo,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});b(this,Ms,[0,0]);b(this,pi,null);b(this,Gi,null);b(this,ko,null);b(this,Ne,null);const A=this._signal=r(this,Ur).signal;g(this,Gi,t),g(this,ko,e),g(this,Hr,i),g(this,Ts,s),this._eventBus=n,n._on("editingaction",this.onEditingAction.bind(this),{signal:A}),n._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),n._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),n._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),n._on("setpreference",this.onSetPreference.bind(this),{signal:A}),n._on("switchannotationeditorparams",_=>this.updateParams(_.type,_.value),{signal:A}),w(this,R,af).call(this),w(this,R,cf).call(this),w(this,R,Dc).call(this),g(this,Fi,a.annotationStorage),g(this,Eo,a.filterFactory),g(this,An,o),g(this,Wr,l||null),g(this,So,h),g(this,_o,c),g(this,$r,f),g(this,Po,p||null),this.viewParameters={realScale:sn.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=v!==!1}static get _keyboardManager(){const t=Dr.prototype,e=a=>r(a,Gi).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,n=this.TRANSLATE_BIG;return K(this,"_keyboardManager",new Vl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&r(a,Gi).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&r(a,Gi).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}]]))}destroy(){var t,e,i,s,n,a,o,l;(t=r(this,Ne))==null||t.resolve(),g(this,Ne,null),(e=r(this,Ur))==null||e.abort(),g(this,Ur,null),this._signal=null;for(const h of r(this,Ut).values())h.destroy();r(this,Ut).clear(),r(this,kt).clear(),r(this,yn).clear(),(i=r(this,Ps))==null||i.clear(),g(this,be,null),r(this,st).clear(),r(this,Fe).destroy(),(s=r(this,Hr))==null||s.destroy(),(n=r(this,Ts))==null||n.destroy(),(a=r(this,fi))==null||a.hide(),g(this,fi,null),(o=r(this,wn))==null||o.destroy(),g(this,wn,null),r(this,ui)&&(clearTimeout(r(this,ui)),g(this,ui,null)),r(this,pi)&&(clearTimeout(r(this,pi)),g(this,pi,null)),(l=this._editorUndoBar)==null||l.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return r(this,Po)}get useNewAltTextFlow(){return r(this,_o)}get useNewAltTextWhenAddingImage(){return r(this,$r)}get hcmFilter(){return K(this,"hcmFilter",r(this,An)?r(this,Eo).addHCMFilter(r(this,An).foreground,r(this,An).background):"none")}get direction(){return K(this,"direction",getComputedStyle(r(this,Gi)).direction)}get highlightColors(){return K(this,"highlightColors",r(this,Wr)?new Map(r(this,Wr).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return K(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),g(this,gn,t)}setMainHighlightColorPicker(t){g(this,wn,t)}editAltText(t,e=!1){var i;(i=r(this,Hr))==null||i.editAltText(this,t,e)}getSignature(t){var e;(e=r(this,Ts))==null||e.getSignature({uiManager:this,editor:t})}get signatureManager(){return r(this,Ts)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":g(this,$r,e);break}}onPageChanging({pageNumber:t}){g(this,Vr,t-1)}focusMainContainer(){r(this,Gi).focus()}findParent(t,e){for(const i of r(this,Ut).values()){const{x:s,y:n,width:a,height:o}=i.div.getBoundingClientRect();if(t>=s&&t<=s+a&&e>=n&&e<=n+o)return i}return null}disableUserSelect(t=!1){r(this,ko).classList.toggle("noUserSelect",t)}addShouldRescale(t){r(this,yn).add(t)}removeShouldRescale(t){r(this,yn).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*sn.PDF_TO_CSS_UNITS;for(const i of r(this,yn))i.onScaleChanging();(e=r(this,gn))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:n,focusOffset:a}=e,o=e.toString(),h=w(this,R,rh).call(this,e).closest(".textLayer"),c=this.getSelectionBoxes(h);if(!c)return;e.empty();const f=w(this,R,Rc).call(this,h),p=r(this,Dt)===j.NONE,y=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:c,anchorNode:i,anchorOffset:s,focusNode:n,focusOffset:a,text:o}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(j.HIGHLIGHT,y);return}y()}addToAnnotationStorage(t){!t.isEmpty()&&r(this,Fi)&&!r(this,Fi).has(t.id)&&r(this,Fi).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,r(this,_s)&&(g(this,_s,!1),w(this,R,ah).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of r(this,st))if(e.div.contains(t)){g(this,bn,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!r(this,bn))return;const[t,e]=r(this,bn);g(this,bn,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){w(this,R,Dc).call(this),w(this,R,Lc).call(this)}removeEditListeners(){w(this,R,hf).call(this),w(this,R,Oc).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of r(this,je))if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of r(this,je))if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var i;if(t.preventDefault(),(i=r(this,be))==null||i.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of r(this,st)){const n=s.serialize(!0);n&&e.push(n)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const n of e.items)for(const a of r(this,je))if(a.isHandlingMimeForPasting(n.type)){a.paste(n,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(n){q(`paste: "${n.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const n=[];for(const l of i){const h=await s.deserialize(l);if(!h)return;n.push(h)}const a=()=>{for(const l of n)w(this,R,Fc).call(this,l);w(this,R,Nc).call(this,n)},o=()=>{for(const l of n)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(n){q(`paste: "${n.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),r(this,Dt)!==j.NONE&&!this.isEditorHandlingKeyboard&&Dr._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,r(this,_s)&&(g(this,_s,!1),w(this,R,ah).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(w(this,R,of).call(this),w(this,R,Lc).call(this),w(this,R,se).call(this,{isEditing:r(this,Dt)!==j.NONE,isEmpty:w(this,R,Za).call(this),hasSomethingToUndo:r(this,Fe).hasSomethingToUndo(),hasSomethingToRedo:r(this,Fe).hasSomethingToRedo(),hasSelectedEditor:!1})):(w(this,R,lf).call(this),w(this,R,Oc).call(this),w(this,R,se).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!r(this,je)){g(this,je,t);for(const e of r(this,je))w(this,R,Ri).call(this,e.defaultPropertiesToUpdate)}}getId(){return r(this,qh).id}get currentLayer(){return r(this,Ut).get(r(this,Vr))}getLayer(t){return r(this,Ut).get(t)}get currentPageIndex(){return r(this,Vr)}addLayer(t){r(this,Ut).set(t.pageIndex,t),r(this,Es)?t.enable():t.disable()}removeLayer(t){r(this,Ut).delete(t.pageIndex)}async updateMode(t,e=null,i=!1){var s,n;if(r(this,Dt)!==t&&!(r(this,Ne)&&(await r(this,Ne).promise,!r(this,Ne)))){if(g(this,Ne,Promise.withResolvers()),g(this,Dt,t),t===j.NONE){this.setEditingState(!1),w(this,R,uf).call(this),(s=this._editorUndoBar)==null||s.hide(),r(this,Ne).resolve();return}t===j.SIGNATURE&&await((n=r(this,Ts))==null?void 0:n.loadSignatures()),this.setEditingState(!0),await w(this,R,df).call(this),this.unselectAll();for(const a of r(this,Ut).values())a.updateMode(t);if(!e){i&&this.addNewEditorFromKeyboard(),r(this,Ne).resolve();return}for(const a of r(this,kt).values())a.annotationElementId===e?(this.setSelected(a),a.enterInEditMode()):a.unselect();r(this,Ne).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==r(this,Dt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var i;if(r(this,je)){switch(t){case Q.CREATE:this.currentLayer.addNewEditor(e);return;case Q.HIGHLIGHT_DEFAULT_COLOR:(i=r(this,wn))==null||i.updateColor(e);break;case Q.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(r(this,To)||g(this,To,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const s of r(this,st))s.updateParams(t,e);for(const s of r(this,je))s.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){var n;for(const a of r(this,kt).values())a.editorType===t&&a.show(e);(((n=r(this,To))==null?void 0:n.get(Q.HIGHLIGHT_SHOW_ALL))??!0)!==e&&w(this,R,Ri).call(this,[[Q.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(r(this,Co)!==t){g(this,Co,t);for(const e of r(this,Ut).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const i of r(this,kt).values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return r(this,kt).get(t)}addEditor(t){r(this,kt).set(t.id,t)}removeEditor(t){var e,i;t.div.contains(document.activeElement)&&(r(this,ui)&&clearTimeout(r(this,ui)),g(this,ui,setTimeout(()=>{this.focusMainContainer(),g(this,ui,null)},0))),r(this,kt).delete(t.id),t.annotationElementId&&((e=r(this,Ps))==null||e.delete(t.annotationElementId)),this.unselect(t),(!t.annotationElementId||!r(this,mn).has(t.annotationElementId))&&((i=r(this,Fi))==null||i.remove(t.id))}addDeletedAnnotationElement(t){r(this,mn).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return r(this,mn).has(t)}removeDeletedAnnotationElement(t){r(this,mn).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){r(this,be)!==t&&(g(this,be,t),t&&w(this,R,Ri).call(this,t.propertiesToUpdate))}updateUI(t){r(this,R,ff)===t&&w(this,R,Ri).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){w(this,R,Ri).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(r(this,st).has(t)){r(this,st).delete(t),t.unselect(),w(this,R,se).call(this,{hasSelectedEditor:this.hasSelection});return}r(this,st).add(t),t.select(),w(this,R,Ri).call(this,t.propertiesToUpdate),w(this,R,se).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;(e=r(this,gn))==null||e.commitOrRemove();for(const i of r(this,st))i!==t&&i.unselect();r(this,st).clear(),r(this,st).add(t),t.select(),w(this,R,Ri).call(this,t.propertiesToUpdate),w(this,R,se).call(this,{hasSelectedEditor:!0})}isSelected(t){return r(this,st).has(t)}get firstSelectedEditor(){return r(this,st).values().next().value}unselect(t){t.unselect(),r(this,st).delete(t),w(this,R,se).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return r(this,st).size!==0}get isEnterHandled(){return r(this,st).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;r(this,Fe).undo(),w(this,R,se).call(this,{hasSomethingToUndo:r(this,Fe).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:w(this,R,Za).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){r(this,Fe).redo(),w(this,R,se).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:r(this,Fe).hasSomethingToRedo(),isEmpty:w(this,R,Za).call(this)})}addCommands(t){r(this,Fe).add(t),w(this,R,se).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:w(this,R,Za).call(this)})}cleanUndoStack(t){r(this,Fe).cleanType(t)}delete(){var n;this.commitOrRemove();const t=(n=this.currentLayer)==null?void 0:n.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...r(this,st)],i=()=>{var a;(a=this._editorUndoBar)==null||a.show(s,e.length===1?e[0].editorType:e.length);for(const o of e)o.remove()},s=()=>{for(const a of e)w(this,R,Fc).call(this,a)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var t;(t=r(this,be))==null||t.commitOrRemove()}hasSomethingToControl(){return r(this,be)||this.hasSelection}selectAll(){for(const t of r(this,st))t.commit();w(this,R,Nc).call(this,r(this,kt).values())}unselectAll(){var t;if(!(r(this,be)&&(r(this,be).commitOrRemove(),r(this,Dt)!==j.NONE))&&!((t=r(this,gn))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of r(this,st))e.unselect();r(this,st).clear(),w(this,R,se).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;r(this,Ms)[0]+=t,r(this,Ms)[1]+=e;const[s,n]=r(this,Ms),a=[...r(this,st)],o=1e3;r(this,pi)&&clearTimeout(r(this,pi)),g(this,pi,setTimeout(()=>{g(this,pi,null),r(this,Ms)[0]=r(this,Ms)[1]=0,this.addCommands({cmd:()=>{for(const l of a)r(this,kt).has(l.id)&&(l.translateInPage(s,n),l.translationDone())},undo:()=>{for(const l of a)r(this,kt).has(l.id)&&(l.translateInPage(-s,-n),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(t,e),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),g(this,di,new Map);for(const t of r(this,st))r(this,di).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!r(this,di))return!1;this.disableUserSelect(!1);const t=r(this,di);g(this,di,null);let e=!1;for(const[{x:s,y:n,pageIndex:a},o]of t)o.newX=s,o.newY=n,o.newPageIndex=a,e||(e=s!==o.savedX||n!==o.savedY||a!==o.savedPageIndex);if(!e)return!1;const i=(s,n,a,o)=>{if(r(this,kt).has(s.id)){const l=r(this,Ut).get(o);l?s._setParentAndPosition(l,n,a):(s.pageIndex=o,s.x=n,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:n,newY:a,newPageIndex:o}]of t)i(s,n,a,o)},undo:()=>{for(const[s,{savedX:n,savedY:a,savedPageIndex:o}]of t)i(s,n,a,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(r(this,di))for(const i of r(this,di).keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||r(this,st).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return r(this,be)===t}getActive(){return r(this,be)}getMode(){return r(this,Dt)}get imageManager(){return K(this,"imageManager",new kc)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let h=0,c=e.rangeCount;h<c;h++)if(!t.contains(e.getRangeAt(h).commonAncestorContainer))return null;const{x:i,y:s,width:n,height:a}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(h,c,f,p)=>({x:(c-s)/a,y:1-(h+f-i)/n,width:p/a,height:f/n});break;case"180":o=(h,c,f,p)=>({x:1-(h+f-i)/n,y:1-(c+p-s)/a,width:f/n,height:p/a});break;case"270":o=(h,c,f,p)=>({x:1-(c+p-s)/a,y:(h-i)/n,width:p/a,height:f/n});break;default:o=(h,c,f,p)=>({x:(h-i)/n,y:(c-s)/a,width:f/n,height:p/a});break}const l=[];for(let h=0,c=e.rangeCount;h<c;h++){const f=e.getRangeAt(h);if(!f.collapsed)for(const{x:p,y,width:v,height:A}of f.getClientRects())v===0||A===0||l.push(o(p,y,v,A))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:e}){(r(this,zr)||g(this,zr,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=r(this,zr))==null||e.delete(t)}renderAnnotationElement(t){var s;const e=(s=r(this,zr))==null?void 0:s.get(t.data.id);if(!e)return;const i=r(this,Fi).getRawValue(e);i&&(r(this,Dt)===j.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){var n;const s=(n=r(this,Ps))==null?void 0:n.get(t);s&&(s.setCanvas(e,i),r(this,Ps).delete(t))}addMissingCanvas(t,e){(r(this,Ps)||g(this,Ps,new Map)).set(t,e)}};Ur=new WeakMap,be=new WeakMap,kt=new WeakMap,Ut=new WeakMap,Hr=new WeakMap,Fi=new WeakMap,zr=new WeakMap,Fe=new WeakMap,vs=new WeakMap,gn=new WeakMap,Vr=new WeakMap,mn=new WeakMap,di=new WeakMap,je=new WeakMap,yn=new WeakMap,So=new WeakMap,_o=new WeakMap,$r=new WeakMap,Eo=new WeakMap,ui=new WeakMap,Ss=new WeakMap,Wr=new WeakMap,_s=new WeakMap,fi=new WeakMap,qh=new WeakMap,Es=new WeakMap,Co=new WeakMap,Cs=new WeakMap,bn=new WeakMap,wn=new WeakMap,Ps=new WeakMap,Po=new WeakMap,Dt=new WeakMap,st=new WeakMap,Ni=new WeakMap,Ts=new WeakMap,An=new WeakMap,To=new WeakMap,Mo=new WeakMap,Ms=new WeakMap,pi=new WeakMap,Gi=new WeakMap,ko=new WeakMap,Ne=new WeakMap,R=new WeakSet,rh=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},Rc=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of r(this,Ut).values())if(i.hasTextLayer(t))return i;return null},nf=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=w(this,R,rh).call(this,t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(r(this,fi)||g(this,fi,new Eg(this)),r(this,fi).show(i,s,this.direction==="ltr"))},rf=function(){var n,a,o;const t=document.getSelection();if(!t||t.isCollapsed){r(this,Ni)&&((n=r(this,fi))==null||n.hide(),g(this,Ni,null),w(this,R,se).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===r(this,Ni))return;const s=w(this,R,rh).call(this,t).closest(".textLayer");if(!s){r(this,Ni)&&((a=r(this,fi))==null||a.hide(),g(this,Ni,null),w(this,R,se).call(this,{hasSelectedText:!1}));return}if((o=r(this,fi))==null||o.hide(),g(this,Ni,e),w(this,R,se).call(this,{hasSelectedText:!0}),!(r(this,Dt)!==j.HIGHLIGHT&&r(this,Dt)!==j.NONE)&&(r(this,Dt)===j.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),g(this,_s,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=r(this,Dt)===j.HIGHLIGHT?w(this,R,Rc).call(this,s):null;l==null||l.toggleDrawing();const h=new AbortController,c=this.combinedSignal(h),f=p=>{p.type==="pointerup"&&p.button!==0||(h.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&w(this,R,ah).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}},ah=function(t=""){r(this,Dt)===j.HIGHLIGHT?this.highlightSelection(t):r(this,So)&&w(this,R,nf).call(this)},af=function(){document.addEventListener("selectionchange",w(this,R,rf).bind(this),{signal:this._signal})},of=function(){if(r(this,Ss))return;g(this,Ss,new AbortController);const t=this.combinedSignal(r(this,Ss));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},lf=function(){var t;(t=r(this,Ss))==null||t.abort(),g(this,Ss,null)},Dc=function(){if(r(this,Cs))return;g(this,Cs,new AbortController);const t=this.combinedSignal(r(this,Cs));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},hf=function(){var t;(t=r(this,Cs))==null||t.abort(),g(this,Cs,null)},Lc=function(){if(r(this,vs))return;g(this,vs,new AbortController);const t=this.combinedSignal(r(this,vs));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},Oc=function(){var t;(t=r(this,vs))==null||t.abort(),g(this,vs,null)},cf=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},se=function(t){Object.entries(t).some(([i,s])=>r(this,Mo)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(r(this,Mo),t)}),r(this,Dt)===j.HIGHLIGHT&&t.hasSelectedEditor===!1&&w(this,R,Ri).call(this,[[Q.HIGHLIGHT_FREE,!0]]))},Ri=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},df=async function(){if(!r(this,Es)){g(this,Es,!0);const t=[];for(const e of r(this,Ut).values())t.push(e.enable());await Promise.all(t);for(const e of r(this,kt).values())e.enable()}},uf=function(){if(this.unselectAll(),r(this,Es)){g(this,Es,!1);for(const t of r(this,Ut).values())t.disable();for(const t of r(this,kt).values())t.disable()}},Fc=function(t){const e=r(this,Ut).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},ff=function(){let t=null;for(t of r(this,st));return t},Za=function(){if(r(this,kt).size===0)return!0;if(r(this,kt).size===1)for(const t of r(this,kt).values())return t.isEmpty();return!1},Nc=function(t){for(const e of r(this,st))e.unselect();r(this,st).clear();for(const e of t)e.isEmpty()||(r(this,st).add(e),e.select());w(this,R,se).call(this,{hasSelectedEditor:this.hasSelection})},N(Dr,"TRANSLATE_SMALL",1),N(Dr,"TRANSLATE_BIG",10);let wr=Dr;var Lt,gi,qe,jr,mi,we,qr,yi,ue,Bi,xn,bi,ks,ni,Ka,oh;const ne=class ne{constructor(t){b(this,ni);b(this,Lt,null);b(this,gi,!1);b(this,qe,null);b(this,jr,null);b(this,mi,null);b(this,we,null);b(this,qr,!1);b(this,yi,null);b(this,ue,null);b(this,Bi,null);b(this,xn,null);b(this,bi,!1);g(this,ue,t),g(this,bi,t._uiManager.useNewAltTextFlow),r(ne,ks)||g(ne,ks,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){ne._l10n??(ne._l10n=t)}async render(){const t=g(this,qe,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=g(this,jr,document.createElement("span"));t.append(e),r(this,bi)?(t.classList.add("new"),t.setAttribute("data-l10n-id",r(ne,ks).missing),e.setAttribute("data-l10n-id",r(ne,ks)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=r(this,ue)._uiManager._signal;t.addEventListener("contextmenu",ri,{signal:i}),t.addEventListener("pointerdown",n=>n.stopPropagation(),{signal:i});const s=n=>{n.preventDefault(),r(this,ue)._uiManager.editAltText(r(this,ue)),r(this,bi)&&r(this,ue)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:r(this,ni,Ka)}})};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",n=>{n.target===t&&n.key==="Enter"&&(g(this,qr,!0),s(n))},{signal:i}),await w(this,ni,oh).call(this),t}finish(){r(this,qe)&&(r(this,qe).focus({focusVisible:r(this,qr)}),g(this,qr,!1))}isEmpty(){return r(this,bi)?r(this,Lt)===null:!r(this,Lt)&&!r(this,gi)}hasData(){return r(this,bi)?r(this,Lt)!==null||!!r(this,Bi):this.isEmpty()}get guessedText(){return r(this,Bi)}async setGuessedText(t){r(this,Lt)===null&&(g(this,Bi,t),g(this,xn,await ne._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),w(this,ni,oh).call(this))}toggleAltTextBadge(t=!1){var e;if(!r(this,bi)||r(this,Lt)){(e=r(this,yi))==null||e.remove(),g(this,yi,null);return}if(!r(this,yi)){const i=g(this,yi,document.createElement("div"));i.className="noAltTextBadge",r(this,ue).div.append(i)}r(this,yi).classList.toggle("hidden",!t)}serialize(t){let e=r(this,Lt);return!t&&r(this,Bi)===e&&(e=r(this,xn)),{altText:e,decorative:r(this,gi),guessedText:r(this,Bi),textWithDisclaimer:r(this,xn)}}get data(){return{altText:r(this,Lt),decorative:r(this,gi)}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:s,cancel:n=!1}){i&&(g(this,Bi,i),g(this,xn,s)),!(r(this,Lt)===t&&r(this,gi)===e)&&(n||(g(this,Lt,t),g(this,gi,e)),w(this,ni,oh).call(this))}toggle(t=!1){r(this,qe)&&(!t&&r(this,we)&&(clearTimeout(r(this,we)),g(this,we,null)),r(this,qe).disabled=!t)}shown(){r(this,ue)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:r(this,ni,Ka)}})}destroy(){var t,e;(t=r(this,qe))==null||t.remove(),g(this,qe,null),g(this,jr,null),g(this,mi,null),(e=r(this,yi))==null||e.remove(),g(this,yi,null)}};Lt=new WeakMap,gi=new WeakMap,qe=new WeakMap,jr=new WeakMap,mi=new WeakMap,we=new WeakMap,qr=new WeakMap,yi=new WeakMap,ue=new WeakMap,Bi=new WeakMap,xn=new WeakMap,bi=new WeakMap,ks=new WeakMap,ni=new WeakSet,Ka=function(){return r(this,Lt)&&"added"||r(this,Lt)===null&&this.guessedText&&"review"||"missing"},oh=async function(){var s,n,a;const t=r(this,qe);if(!t)return;if(r(this,bi)){if(t.classList.toggle("done",!!r(this,Lt)),t.setAttribute("data-l10n-id",r(ne,ks)[r(this,ni,Ka)]),(s=r(this,jr))==null||s.setAttribute("data-l10n-id",r(ne,ks)[`${r(this,ni,Ka)}-label`]),!r(this,Lt)){(n=r(this,mi))==null||n.remove();return}}else{if(!r(this,Lt)&&!r(this,gi)){t.classList.remove("done"),(a=r(this,mi))==null||a.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=r(this,mi);if(!e){g(this,mi,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${r(this,ue).id}`;const o=100,l=r(this,ue)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(r(this,we)),g(this,we,null)},{once:!0}),t.addEventListener("mouseenter",()=>{g(this,we,setTimeout(()=>{g(this,we,null),r(this,mi).classList.add("show"),r(this,ue)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),t.addEventListener("mouseleave",()=>{var h;r(this,we)&&(clearTimeout(r(this,we)),g(this,we,null)),(h=r(this,mi))==null||h.classList.remove("show")},{signal:l})}r(this,gi)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=r(this,Lt)),e.parentNode||t.append(e);const i=r(this,ue).getElementForAltText();i==null||i.setAttribute("aria-describedby",e.id)},b(ne,ks,null),N(ne,"_l10n",null);let Lh=ne;var Xr,vn,Io,Ro,Do,Lo,Oo,Ui,Sn,Hi,_n,Is,rn,pf,gf,mf;const hu=class hu{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:n=null,onPinchEnd:a=null,signal:o}){b(this,rn);b(this,Xr);b(this,vn,!1);b(this,Io,null);b(this,Ro);b(this,Do);b(this,Lo);b(this,Oo);b(this,Ui,null);b(this,Sn);b(this,Hi,null);b(this,_n);b(this,Is,null);g(this,Xr,t),g(this,Io,i),g(this,Ro,e),g(this,Do,s),g(this,Lo,n),g(this,Oo,a),g(this,_n,new AbortController),g(this,Sn,AbortSignal.any([o,r(this,_n).signal])),t.addEventListener("touchstart",w(this,rn,pf).bind(this),{passive:!1,signal:r(this,Sn)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ps.pixelRatio}destroy(){var t,e;(t=r(this,_n))==null||t.abort(),g(this,_n,null),(e=r(this,Ui))==null||e.abort(),g(this,Ui,null)}};Xr=new WeakMap,vn=new WeakMap,Io=new WeakMap,Ro=new WeakMap,Do=new WeakMap,Lo=new WeakMap,Oo=new WeakMap,Ui=new WeakMap,Sn=new WeakMap,Hi=new WeakMap,_n=new WeakMap,Is=new WeakMap,rn=new WeakSet,pf=function(t){var s,n,a;if((s=r(this,Ro))!=null&&s.call(this))return;if(t.touches.length===1){if(r(this,Ui))return;const o=g(this,Ui,new AbortController),l=AbortSignal.any([r(this,Sn),o.signal]),h=r(this,Xr),c={capture:!0,signal:l,passive:!1},f=p=>{var y;p.pointerType==="touch"&&((y=r(this,Ui))==null||y.abort(),g(this,Ui,null))};h.addEventListener("pointerdown",p=>{p.pointerType==="touch"&&(Et(p),f(p))},c),h.addEventListener("pointerup",f,c),h.addEventListener("pointercancel",f,c);return}if(!r(this,Is)){g(this,Is,new AbortController);const o=AbortSignal.any([r(this,Sn),r(this,Is).signal]),l=r(this,Xr),h={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",w(this,rn,gf).bind(this),h);const c=w(this,rn,mf).bind(this);l.addEventListener("touchend",c,h),l.addEventListener("touchcancel",c,h),h.capture=!0,l.addEventListener("pointerdown",Et,h),l.addEventListener("pointermove",Et,h),l.addEventListener("pointercancel",Et,h),l.addEventListener("pointerup",Et,h),(n=r(this,Do))==null||n.call(this)}if(Et(t),t.touches.length!==2||(a=r(this,Io))!=null&&a.call(this)){g(this,Hi,null);return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),g(this,Hi,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY})},gf=function(t){var u;if(!r(this,Hi)||t.touches.length!==2)return;Et(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:s,screenY:n}=e,{screenX:a,screenY:o}=i,l=r(this,Hi),{touch0X:h,touch0Y:c,touch1X:f,touch1Y:p}=l,y=f-h,v=p-c,A=a-s,_=o-n,C=Math.hypot(A,_)||1,T=Math.hypot(y,v)||1;if(!r(this,vn)&&Math.abs(T-C)<=hu.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=n,l.touch1X=a,l.touch1Y=o,!r(this,vn)){g(this,vn,!0);return}const E=[(s+a)/2,(n+o)/2];(u=r(this,Lo))==null||u.call(this,E,T,C)},mf=function(t){var e;t.touches.length>=2||(r(this,Is).abort(),g(this,Is,null),(e=r(this,Oo))==null||e.call(this),r(this,Hi)&&(Et(t),g(this,Hi,null),g(this,vn,!1)))};let Oh=hu;var En,Xe,ht,Yr,Rs,Fo,Cn,Ht,Pn,zi,Ds,No,Tn,Ae,Go,Mn,Vi,wi,Zr,Kr,Ge,kn,Bo,Xh,z,Gc,Uo,Bc,lh,yf,bf,Uc,hh,Hc,wf,Af,xf,zc,vf,Vc,Sf,_f,Ef,$c,Qa;const Y=class Y{constructor(t){b(this,z);b(this,En,null);b(this,Xe,null);b(this,ht,null);b(this,Yr,!1);b(this,Rs,null);b(this,Fo,"");b(this,Cn,!1);b(this,Ht,null);b(this,Pn,null);b(this,zi,null);b(this,Ds,null);b(this,No,"");b(this,Tn,!1);b(this,Ae,null);b(this,Go,!1);b(this,Mn,!1);b(this,Vi,!1);b(this,wi,null);b(this,Zr,0);b(this,Kr,0);b(this,Ge,null);b(this,kn,null);N(this,"_isCopy",!1);N(this,"_editToolbar",null);N(this,"_initialOptions",Object.create(null));N(this,"_initialData",null);N(this,"_isVisible",!0);N(this,"_uiManager",null);N(this,"_focusEventsAllowed",!0);b(this,Bo,!1);b(this,Xh,Y._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:n,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[n,a];const[o,l]=this.parentDimensions;this.x=t.x/o,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=Y.prototype._resizeWithKeyboard,e=wr.TRANSLATE_SMALL,i=wr.TRANSLATE_BIG;return K(this,"_resizerKeyboardManager",new Vl([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Y.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return K(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Tg({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Y._l10n??(Y._l10n=t),Y._l10nResizer||(Y._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Y._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Y._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){at("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return r(this,Bo)}set _isDraggable(t){var e;g(this,Bo,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=r(this,Xh)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):w(this,z,Qa).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(r(this,Tn)?g(this,Tn,!1):this.parent.setSelected(this))}focusout(t){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[n,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/n,this.y=(e+s)/a,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,s]=this.parentDimensions;this.setAt(t*i,e*s,this.width*i,this.height*s),this._onTranslated()}translate(t,e){w(this,z,Gc).call(this,this.parentDimensions,t,e)}translateInPage(t,e){r(this,Ae)||g(this,Ae,[this.x,this.y,this.width,this.height]),w(this,z,Gc).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){r(this,Ae)||g(this,Ae,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[s,n]}=this;if(this.x+=t/s,this.y+=e/n,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,h]=this.getBaseTranslation();a+=l,o+=h;const{style:c}=i;c.left=`${(100*a).toFixed(2)}%`,c.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!r(this,Ae)&&(r(this,Ae)[0]!==this.x||r(this,Ae)[1]!==this.y)}get _hasBeenResized(){return!!r(this,Ae)&&(r(this,Ae)[2]!==this.width||r(this,Ae)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Y,s=i/t,n=i/e;switch(this.rotation){case 90:return[-s,n];case 180:return[s,n];case 270:return[s,-n];default:return[-s,-n]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,s]}=this;let{x:n,y:a,width:o,height:l}=this;if(o*=i,l*=s,n*=i,a*=s,this._mustFixPosition)switch(t){case 0:n=le(n,0,i-o),a=le(a,0,s-l);break;case 90:n=le(n,0,i-l),a=le(a,o,s);break;case 180:n=le(n,o,i),a=le(a,l,s);break;case 270:n=le(n,l,i),a=le(a,0,s-o);break}this.x=n/=i,this.y=a/=s;const[h,c]=this.getBaseTranslation();n+=h,a+=c,e.left=`${(100*n).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var i;return w(i=Y,Uo,Bc).call(i,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var i;return w(i=Y,Uo,Bc).call(i,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(t,e){const[i,s]=this.parentDimensions,{style:n}=this.div;n.width=`${(100*t/i).toFixed(2)}%`,r(this,Cn)||(n.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,s=i.endsWith("%"),n=!r(this,Cn)&&e.endsWith("%");if(s&&n)return;const[a,o]=this.parentDimensions;s||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!r(this,Cn)&&!n&&(t.height=`${(100*parseFloat(e)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=r(this,ht))==null||t.finish()}async addEditToolbar(){return this._editToolbar||r(this,Mn)?this._editToolbar:(this._editToolbar=new Mc(this),this.div.append(this._editToolbar.render()),r(this,ht)&&await this._editToolbar.addAltText(r(this,ht)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=r(this,ht))==null||t.destroy())}addContainer(t){var i;const e=(i=this._editToolbar)==null?void 0:i.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){r(this,ht)||(Lh.initialize(Y._l10n),g(this,ht,new Lh(this)),r(this,En)&&(r(this,ht).data=r(this,En),g(this,En,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=r(this,ht))==null?void 0:t.data}set altTextData(t){r(this,ht)&&(r(this,ht).data=t)}get guessedAltText(){var t;return(t=r(this,ht))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=r(this,ht))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=r(this,ht))==null?void 0:e.serialize(t)}hasAltText(){return!!r(this,ht)&&!r(this,ht).isEmpty()}hasAltTextData(){var t;return((t=r(this,ht))==null?void 0:t.hasData())??!1}render(){var a;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=r(this,Yr)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),w(this,z,Vc).call(this);const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[s,n]=this.getInitialTranslation();return this.translate(s,n),Qd(this,t,["keydown","pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(r(this,kn)||g(this,kn,new Oh({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:w(this,z,wf).bind(this),onPinching:w(this,z,Af).bind(this),onPinchEnd:w(this,z,xf).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),t}pointerdown(t){const{isMac:e}=Xt.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(g(this,Tn,!0),this._isDraggable){w(this,z,vf).call(this,t);return}w(this,z,zc).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){r(this,wi)&&clearTimeout(r(this,wi)),g(this,wi,setTimeout(()=>{var t;g(this,wi,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const s=this.parentScale,[n,a]=this.pageDimensions,[o,l]=this.pageTranslation,h=t/s,c=e/s,f=this.x*n,p=this.y*a,y=this.width*n,v=this.height*a;switch(i){case 0:return[f+h+o,a-p-c-v+l,f+h+y+o,a-p-c+l];case 90:return[f+c+o,a-p+h+l,f+c+v+o,a-p+h+y+l];case 180:return[f-h-y+o,a-p+c+l,f-h+o,a-p+c+v+l];case 270:return[f-c-v+o,a-p-h-y+l,f-c+o,a-p-h+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,n,a]=t,o=n-i,l=a-s;switch(this.rotation){case 0:return[i,e-a,o,l];case 90:return[i,e-s,l,o];case 180:return[n,e-s,o,l];case 270:return[n,e-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){g(this,Mn,!0)}disableEditMode(){g(this,Mn,!1)}isInEditMode(){return r(this,Mn)}shouldGetKeyboardEvents(){return r(this,Vi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:n,innerWidth:a}=window;return e<a&&s>0&&t<n&&i>0}rebuild(){w(this,z,Vc).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){at("An editor must be serializable")}static async deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});s.rotation=t.rotation,g(s,En,t.accessibilityData),s._isCopy=t.isCopy||!1;const[n,a]=s.pageDimensions,[o,l,h,c]=s.getRectInCurrentCoords(t.rect,a);return s.x=o/n,s.y=l/a,s.width=h/n,s.height=c/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=r(this,Ds))==null||t.abort(),g(this,Ds,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),r(this,wi)&&(clearTimeout(r(this,wi)),g(this,wi,null)),w(this,z,Qa).call(this),this.removeEditToolbar(),r(this,Ge)){for(const i of r(this,Ge).values())clearTimeout(i);g(this,Ge,null)}this.parent=null,(e=r(this,kn))==null||e.destroy(),g(this,kn,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(w(this,z,yf).call(this),r(this,Ht).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),g(this,zi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=r(this,Ht).children;if(!r(this,Xe)){g(this,Xe,Array.from(e));const a=w(this,z,Sf).bind(this),o=w(this,z,_f).bind(this),l=this._uiManager._signal;for(const h of r(this,Xe)){const c=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",a,{signal:l}),h.addEventListener("blur",o,{signal:l}),h.addEventListener("focus",w(this,z,Ef).bind(this,c),{signal:l}),h.setAttribute("data-l10n-id",Y._l10nResizer[c])}}const i=r(this,Xe)[0];let s=0;for(const a of e){if(a===i)break;s++}const n=(360-this.rotation+this.parentRotation)%360/90*(r(this,Xe).length/4);if(n!==s){if(n<s)for(let o=0;o<s-n;o++)r(this,Ht).append(r(this,Ht).firstChild);else if(n>s)for(let o=0;o<n-s;o++)r(this,Ht).firstChild.before(r(this,Ht).lastChild);let a=0;for(const o of e){const h=r(this,Xe)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Y._l10nResizer[h])}}w(this,z,$c).call(this,0),g(this,Vi,!0),r(this,Ht).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){r(this,Vi)&&w(this,z,Hc).call(this,r(this,No),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){w(this,z,Qa).call(this),this.div.focus()}select(){var t,e,i;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,n;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((n=this._editToolbar)==null||n.show())});return}(e=this._editToolbar)==null||e.show(),(i=r(this,ht))==null||i.toggleAltTextBadge(!1)}unselect(){var t,e,i,s,n;(t=r(this,Ht))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(n=r(this,ht))==null||n.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return r(this,Go)}set isEditing(t){g(this,Go,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){g(this,Cn,!0);const i=t/e,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){r(this,Ge)||g(this,Ge,new Map);const{action:i}=t;let s=r(this,Ge).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),r(this,Ge).delete(i),r(this,Ge).size===0&&g(this,Ge,null)},Y._telemetryTimeout),r(this,Ge).set(i,s);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),g(this,Yr,!1)}disable(){this.div&&(this.div.tabIndex=-1),g(this,Yr,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};En=new WeakMap,Xe=new WeakMap,ht=new WeakMap,Yr=new WeakMap,Rs=new WeakMap,Fo=new WeakMap,Cn=new WeakMap,Ht=new WeakMap,Pn=new WeakMap,zi=new WeakMap,Ds=new WeakMap,No=new WeakMap,Tn=new WeakMap,Ae=new WeakMap,Go=new WeakMap,Mn=new WeakMap,Vi=new WeakMap,wi=new WeakMap,Zr=new WeakMap,Kr=new WeakMap,Ge=new WeakMap,kn=new WeakMap,Bo=new WeakMap,Xh=new WeakMap,z=new WeakSet,Gc=function([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Uo=new WeakSet,Bc=function(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},lh=function(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}},yf=function(){if(r(this,Ht))return;g(this,Ht,document.createElement("div")),r(this,Ht).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const s=document.createElement("div");r(this,Ht).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",w(this,z,bf).bind(this,i),{signal:e}),s.addEventListener("contextmenu",ri,{signal:e}),s.tabIndex=-1}this.div.prepend(r(this,Ht))},bf=function(t,e){var c;e.preventDefault();const{isMac:i}=Xt.platform;if(e.button!==0||e.ctrlKey&&i)return;(c=r(this,ht))==null||c.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,g(this,Pn,[e.screenX,e.screenY]);const n=new AbortController,a=this._uiManager.combinedSignal(n);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",w(this,z,Hc).bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Et,{passive:!1,signal:a}),window.addEventListener("contextmenu",ri,{signal:a}),g(this,zi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const h=()=>{var f;n.abort(),this.parent.togglePointerEvents(!0),(f=r(this,ht))==null||f.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=l,w(this,z,hh).call(this)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})},Uc=function(t,e,i,s){this.width=i,this.height=s,this.x=t,this.y=e;const[n,a]=this.parentDimensions;this.setDims(n*i,a*s),this.fixAndSetPosition(),this._onResized()},hh=function(){if(!r(this,zi))return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=r(this,zi);g(this,zi,null);const n=this.x,a=this.y,o=this.width,l=this.height;n===t&&a===e&&o===i&&l===s||this.addCommands({cmd:w(this,z,Uc).bind(this,n,a,o,l),undo:w(this,z,Uc).bind(this,t,e,i,s),mustExec:!0})},Hc=function(t,e){const[i,s]=this.parentDimensions,n=this.x,a=this.y,o=this.width,l=this.height,h=Y.MIN_SIZE/i,c=Y.MIN_SIZE/s,f=w(this,z,lh).call(this,this.rotation),p=(O,H)=>[f[0]*O+f[2]*H,f[1]*O+f[3]*H],y=w(this,z,lh).call(this,360-this.rotation),v=(O,H)=>[y[0]*O+y[2]*H,y[1]*O+y[3]*H];let A,_,C=!1,T=!1;switch(t){case"topLeft":C=!0,A=(O,H)=>[0,0],_=(O,H)=>[O,H];break;case"topMiddle":A=(O,H)=>[O/2,0],_=(O,H)=>[O/2,H];break;case"topRight":C=!0,A=(O,H)=>[O,0],_=(O,H)=>[0,H];break;case"middleRight":T=!0,A=(O,H)=>[O,H/2],_=(O,H)=>[0,H/2];break;case"bottomRight":C=!0,A=(O,H)=>[O,H],_=(O,H)=>[0,0];break;case"bottomMiddle":A=(O,H)=>[O/2,H],_=(O,H)=>[O/2,0];break;case"bottomLeft":C=!0,A=(O,H)=>[0,H],_=(O,H)=>[O,0];break;case"middleLeft":T=!0,A=(O,H)=>[0,H/2],_=(O,H)=>[O,H/2];break}const E=A(o,l),u=_(o,l);let m=p(...u);const x=Y._round(n+m[0]),S=Y._round(a+m[1]);let P=1,M=1,I,k;if(e.fromKeyboard)({deltaX:I,deltaY:k}=e);else{const{screenX:O,screenY:H}=e,[me,Ti]=r(this,Pn);[I,k]=this.screenToPageTranslation(O-me,H-Ti),r(this,Pn)[0]=O,r(this,Pn)[1]=H}if([I,k]=v(I/i,k/s),C){const O=Math.hypot(o,l);P=M=Math.max(Math.min(Math.hypot(u[0]-E[0]-I,u[1]-E[1]-k)/O,1/o,1/l),h/o,c/l)}else T?P=le(Math.abs(u[0]-E[0]-I),h,1)/o:M=le(Math.abs(u[1]-E[1]-k),c,1)/l;const U=Y._round(o*P),$=Y._round(l*M);m=p(..._(U,$));const W=x-m[0],mt=S-m[1];r(this,Ae)||g(this,Ae,[this.x,this.y,this.width,this.height]),this.width=U,this.height=$,this.x=W,this.y=mt,this.setDims(i*U,s*$),this.fixAndSetPosition(),this._onResizing()},wf=function(){var t;g(this,zi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=r(this,ht))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},Af=function(t,e,i){let n=.7*(i/e)+1-.7;if(n===1)return;const a=w(this,z,lh).call(this,this.rotation),o=(x,S)=>[a[0]*x+a[2]*S,a[1]*x+a[3]*S],[l,h]=this.parentDimensions,c=this.x,f=this.y,p=this.width,y=this.height,v=Y.MIN_SIZE/l,A=Y.MIN_SIZE/h;n=Math.max(Math.min(n,1/p,1/y),v/p,A/y);const _=Y._round(p*n),C=Y._round(y*n);if(_===p&&C===y)return;r(this,Ae)||g(this,Ae,[c,f,p,y]);const T=o(p/2,y/2),E=Y._round(c+T[0]),u=Y._round(f+T[1]),m=o(_/2,C/2);this.x=E-m[0],this.y=u-m[1],this.width=_,this.height=C,this.setDims(l*_,h*C),this.fixAndSetPosition(),this._onResizing()},xf=function(){var t;(t=r(this,ht))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),w(this,z,hh).call(this)},zc=function(t){const{isMac:e}=Xt.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},vf=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,n=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:n},o=h=>{s.abort(),g(this,Rs,null),g(this,Tn,!1),this._uiManager.endDragSession()||w(this,z,zc).call(this,h),i&&this._onStopDragging()};e&&(g(this,Zr,t.clientX),g(this,Kr,t.clientY),g(this,Rs,t.pointerId),g(this,Fo,t.pointerType),window.addEventListener("pointermove",h=>{i||(i=!0,this._onStartDragging());const{clientX:c,clientY:f,pointerId:p}=h;if(p!==r(this,Rs)){Et(h);return}const[y,v]=this.screenToPageTranslation(c-r(this,Zr),f-r(this,Kr));g(this,Zr,c),g(this,Kr,f),this._uiManager.dragSelectedEditors(y,v)},a),window.addEventListener("touchmove",Et,a),window.addEventListener("pointerdown",h=>{h.pointerType===r(this,Fo)&&(r(this,kn)||h.isPrimary)&&o(h),Et(h)},a));const l=h=>{if(!r(this,Rs)||r(this,Rs)===h.pointerId){o(h);return}Et(h)};window.addEventListener("pointerup",l,{signal:n}),window.addEventListener("blur",l,{signal:n})},Vc=function(){if(r(this,Ds)||!this.div)return;g(this,Ds,new AbortController);const t=this._uiManager.combinedSignal(r(this,Ds));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Sf=function(t){Y._resizerKeyboardManager.exec(this,t)},_f=function(t){var e;r(this,Vi)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==r(this,Ht)&&w(this,z,Qa).call(this)},Ef=function(t){g(this,No,r(this,Vi)?t:"")},$c=function(t){if(r(this,Xe))for(const e of r(this,Xe))e.tabIndex=t},Qa=function(){g(this,Vi,!1),w(this,z,$c).call(this,-1),w(this,z,hh).call(this)},b(Y,Uo),N(Y,"_l10n",null),N(Y,"_l10nResizer",null),N(Y,"_borderLineWidth",-1),N(Y,"_colorManager",new Ic),N(Y,"_zIndex",1),N(Y,"_telemetryTimeout",1e3);let pt=Y;class Tg extends pt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const bu=3285377520,Le=4294901760,hi=65535;class Cf{constructor(t){this.h1=t?t&4294967295:bu,this.h2=t?t&4294967295:bu}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let A=0,_=t.length;A<_;A++){const C=t.charCodeAt(A);C<=255?e[i++]=C:(e[i++]=C>>>8,e[i++]=C&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,n=i-s*4,a=new Uint32Array(e.buffer,0,s);let o=0,l=0,h=this.h1,c=this.h2;const f=3432918353,p=461845907,y=f&hi,v=p&hi;for(let A=0;A<s;A++)A&1?(o=a[A],o=o*f&Le|o*y&hi,o=o<<15|o>>>17,o=o*p&Le|o*v&hi,h^=o,h=h<<13|h>>>19,h=h*5+3864292196):(l=a[A],l=l*f&Le|l*y&hi,l=l<<15|l>>>17,l=l*p&Le|l*v&hi,c^=l,c=c<<13|c>>>19,c=c*5+3864292196);switch(o=0,n){case 3:o^=e[s*4+2]<<16;case 2:o^=e[s*4+1]<<8;case 1:o^=e[s*4],o=o*f&Le|o*y&hi,o=o<<15|o>>>17,o=o*p&Le|o*v&hi,s&1?h^=o:c^=o}this.h1=h,this.h2=c}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Le|t*36045&hi,e=e*4283543511&Le|((e<<16|t>>>16)*2950163797&Le)>>>16,t^=e>>>1,t=t*444984403&Le|t*60499&hi,e=e*3301882366&Le|((e<<16|t>>>16)*3120437893&Le)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Wc=Object.freeze({map:null,hash:"",transfer:void 0});var In,Rn,Ot,Yh,Pf;class Jd{constructor(){b(this,Yh);b(this,In,!1);b(this,Rn,null);b(this,Ot,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=r(this,Ot).get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return r(this,Ot).get(t)}remove(t){if(r(this,Ot).delete(t),r(this,Ot).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of r(this,Ot).values())if(e instanceof pt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=r(this,Ot).get(t);let s=!1;if(i!==void 0)for(const[n,a]of Object.entries(e))i[n]!==a&&(s=!0,i[n]=a);else s=!0,r(this,Ot).set(t,e);s&&w(this,Yh,Pf).call(this),e instanceof pt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return r(this,Ot).has(t)}getAll(){return r(this,Ot).size>0?jd(r(this,Ot)):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return r(this,Ot).size}resetModified(){r(this,In)&&(g(this,In,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Tf(this)}get serializable(){if(r(this,Ot).size===0)return Wc;const t=new Map,e=new Cf,i=[],s=Object.create(null);let n=!1;for(const[a,o]of r(this,Ot)){const l=o instanceof pt?o.serialize(!1,s):o;l&&(t.set(a,l),e.update(`${a}:${JSON.stringify(l)}`),n||(n=!!l.bitmap))}if(n)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:Wc}get editorStats(){let t=null;const e=new Map;for(const i of r(this,Ot).values()){if(!(i instanceof pt))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:n}=s;e.has(n)||e.set(n,Object.getPrototypeOf(i).constructor),t||(t=Object.create(null));const a=t[n]||(t[n]=new Map);for(const[o,l]of Object.entries(s)){if(o==="type")continue;let h=a.get(o);h||(h=new Map,a.set(o,h));const c=h.get(l)??0;h.set(l,c+1)}}for(const[i,s]of e)t[i]=s.computeTelemetryFinalData(t[i]);return t}resetModifiedIds(){g(this,Rn,null)}get modifiedIds(){if(r(this,Rn))return r(this,Rn);const t=[];for(const e of r(this,Ot).values())!(e instanceof pt)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return g(this,Rn,{ids:new Set(t),hash:t.join(",")})}}In=new WeakMap,Rn=new WeakMap,Ot=new WeakMap,Yh=new WeakSet,Pf=function(){r(this,In)||(g(this,In,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Ho;class Tf extends Jd{constructor(e){super();b(this,Ho);const{map:i,hash:s,transfer:n}=e.serializable,a=structuredClone(i,n?{transfer:n}:null);g(this,Ho,{map:a,hash:s,transfer:n})}get print(){at("Should not call PrintAnnotationStorage.print")}get serializable(){return r(this,Ho)}get modifiedIds(){return K(this,"modifiedIds",{ids:new Set,hash:""})}}Ho=new WeakMap;var Qr;class Mg{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){b(this,Qr,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),r(this,Qr).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||r(this,Qr).has(t.loadedName))){if(Ct(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:n,style:a}=t,o=new FontFace(s,n,a);this.addNativeFontFace(o);try{await o.load(),r(this,Qr).add(s),i==null||i(t)}catch{q(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}at("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw q(`Failed to load font '${i.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return K(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return K(this,"isSyncFontLoadingSupported",$t||Xt.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Ct(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const n=i.shift();setTimeout(n.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:e,callback:t};return i.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return K(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(u,m){return u.charCodeAt(m)<<24|u.charCodeAt(m+1)<<16|u.charCodeAt(m+2)<<8|u.charCodeAt(m+3)&255}function s(u,m,x,S){const P=u.substring(0,m),M=u.substring(m+x);return P+S+M}let n,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let h=0;function c(u,m){if(++h>30){q("Load test font never loaded."),m();return}if(l.font="30px "+u,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){m();return}setTimeout(c.bind(null,u,m))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=s(p,976,f.length,f);const v=16,A=1482184792;let _=i(p,v);for(n=0,a=f.length-3;n<a;n+=4)_=_-A+i(f,n)|0;n<f.length&&(_=_-A+i(f+"XXX",n)|0),p=s(p,v,4,pg(_));const C=`url(data:font/opentype;base64,${btoa(p)});`,T=`@font-face {font-family:"${f}";src:${C}}`;this.insertRule(T);const E=this._document.createElement("div");E.style.visibility="hidden",E.style.width=E.style.height="10px",E.style.position="absolute",E.style.top=E.style.left="0px";for(const u of[t.loadedName,f]){const m=this._document.createElement("span");m.textContent="Hi",m.style.fontFamily=u,E.append(m)}this._document.body.append(E),c(f,()=>{E.remove(),e.complete()})}}Qr=new WeakMap;class kg{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const i in t)this[i]=t[i];this._inspectFont=e}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Xu(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return(i=this._inspectFont)==null||i.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let s;try{s=t.get(i)}catch(a){q(`getPathGenerator - ignoring character: "${a}".`)}const n=new Path2D(s||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=n}}const Xl={DATA:1,ERROR:2},St={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function wu(){}function ce(d){if(d instanceof en||d instanceof Cc||d instanceof gu||d instanceof Dh||d instanceof yc)return d;switch(d instanceof Error||typeof d=="object"&&d!==null||at('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),d.name){case"AbortException":return new en(d.message);case"InvalidPDFException":return new Cc(d.message);case"PasswordException":return new gu(d.message,d.code);case"ResponseException":return new Dh(d.message,d.status,d.missing);case"UnknownErrorException":return new yc(d.message,d.details)}return new yc(d.message,d.toString())}var Jr,$e,Mf,kf,If,ch;class Ja{constructor(t,e,i){b(this,$e);b(this,Jr,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",w(this,$e,Mf).bind(this),{signal:r(this,Jr).signal})}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,n=Promise.withResolvers();this.callbackCapabilities[s]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(a){n.reject(a)}return n.promise}sendWithStream(t,e,i,s){const n=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:h=>{const c=Promise.withResolvers();return this.streamControllers[n]={controller:h,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:t,streamId:n,data:e,desiredSize:h.desiredSize},s),c.promise},pull:h=>{const c=Promise.withResolvers();return this.streamControllers[n].pullCall=c,l.postMessage({sourceName:a,targetName:o,stream:St.PULL,streamId:n,desiredSize:h.desiredSize}),c.promise},cancel:h=>{Ct(h instanceof Error,"cancel must have a valid reason");const c=Promise.withResolvers();return this.streamControllers[n].cancelCall=c,this.streamControllers[n].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:St.CANCEL,streamId:n,reason:ce(h)}),c.promise}},i)}destroy(){var t;(t=r(this,Jr))==null||t.abort(),g(this,Jr,null)}}Jr=new WeakMap,$e=new WeakSet,Mf=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){w(this,$e,If).call(this,t);return}if(t.callback){const i=t.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===Xl.DATA)s.resolve(t.data);else if(t.callback===Xl.ERROR)s.reject(ce(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,s=t.sourceName,n=this.comObj;Promise.try(e,t.data).then(function(a){n.postMessage({sourceName:i,targetName:s,callback:Xl.DATA,callbackId:t.callbackId,data:a})},function(a){n.postMessage({sourceName:i,targetName:s,callback:Xl.ERROR,callbackId:t.callbackId,reason:ce(a)})});return}if(t.streamId){w(this,$e,kf).call(this,t);return}e(t.data)},kf=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,n=this.comObj,a=this,o=this.actionHandler[t.action],l={enqueue(h,c=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=c,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),n.postMessage({sourceName:i,targetName:s,stream:St.ENQUEUE,streamId:e,chunk:h},f)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:St.CLOSE,streamId:e}),delete a.streamSinks[e])},error(h){Ct(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:St.ERROR,streamId:e,reason:ce(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[e]=l,Promise.try(o,t.data,l).then(function(){n.postMessage({sourceName:i,targetName:s,stream:St.START_COMPLETE,streamId:e,success:!0})},function(h){n.postMessage({sourceName:i,targetName:s,stream:St.START_COMPLETE,streamId:e,reason:ce(h)})})},If=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,n=this.comObj,a=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case St.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(ce(t.reason));break;case St.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(ce(t.reason));break;case St.PULL:if(!o){n.postMessage({sourceName:i,targetName:s,stream:St.PULL_COMPLETE,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,Promise.try(o.onPull||wu).then(function(){n.postMessage({sourceName:i,targetName:s,stream:St.PULL_COMPLETE,streamId:e,success:!0})},function(h){n.postMessage({sourceName:i,targetName:s,stream:St.PULL_COMPLETE,streamId:e,reason:ce(h)})});break;case St.ENQUEUE:if(Ct(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case St.CLOSE:if(Ct(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),w(this,$e,ch).call(this,a,e);break;case St.ERROR:Ct(a,"error should have stream controller"),a.controller.error(ce(t.reason)),w(this,$e,ch).call(this,a,e);break;case St.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(ce(t.reason)),w(this,$e,ch).call(this,a,e);break;case St.CANCEL:if(!o)break;const l=ce(t.reason);Promise.try(o.onCancel||wu,l).then(function(){n.postMessage({sourceName:i,targetName:s,stream:St.CANCEL_COMPLETE,streamId:e,success:!0})},function(h){n.postMessage({sourceName:i,targetName:s,stream:St.CANCEL_COMPLETE,streamId:e,reason:ce(h)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},ch=async function(t,e){var i,s,n;await Promise.allSettled([(i=t.startCall)==null?void 0:i.promise,(s=t.pullCall)==null?void 0:s.promise,(n=t.cancelCall)==null?void 0:n.promise]),delete this.streamControllers[e]};var zo;class Rf{constructor({enableHWA:t=!1}){b(this,zo,!1);g(this,zo,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!r(this,zo)})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){at("Abstract method `_createCanvas` called.")}}zo=new WeakMap;class Ig extends Rf{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class Df{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){at("Abstract method `_fetch` called.")}}class Au extends Df{async _fetch(t){const e=await Hl(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Ul(e)}}class Lf{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,n){return"none"}destroy(t=!1){}}var Dn,ta,$i,Wi,Jt,Ln,On,D,Kt,to,Pr,dh,Tr,Of,jc,Mr,eo,io,qc,so;class Rg extends Lf{constructor({docId:e,ownerDocument:i=globalThis.document}){super();b(this,D);b(this,Dn);b(this,ta);b(this,$i);b(this,Wi);b(this,Jt);b(this,Ln);b(this,On,0);g(this,Wi,e),g(this,Jt,i)}addFilter(e){if(!e)return"none";let i=r(this,D,Kt).get(e);if(i)return i;const[s,n,a]=w(this,D,dh).call(this,e),o=e.length===1?s:`${s}${n}${a}`;if(i=r(this,D,Kt).get(o),i)return r(this,D,Kt).set(e,i),i;const l=`g_${r(this,Wi)}_transfer_map_${ie(this,On)._++}`,h=w(this,D,Tr).call(this,l);r(this,D,Kt).set(e,h),r(this,D,Kt).set(o,h);const c=w(this,D,Mr).call(this,l);return w(this,D,io).call(this,s,n,a,c),h}addHCMFilter(e,i){var v;const s=`${e}-${i}`,n="base";let a=r(this,D,to).get(n);if((a==null?void 0:a.key)===s||(a?((v=a.filter)==null||v.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},r(this,D,to).set(n,a)),!e||!i))return a.url;const o=w(this,D,so).call(this,e);e=G.makeHexColor(...o);const l=w(this,D,so).call(this,i);if(i=G.makeHexColor(...l),r(this,D,Pr).style.color="",e==="#000000"&&i==="#ffffff"||e===i)return a.url;const h=new Array(256);for(let A=0;A<=255;A++){const _=A/255;h[A]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const c=h.join(","),f=`g_${r(this,Wi)}_hcm_filter`,p=a.filter=w(this,D,Mr).call(this,f);w(this,D,io).call(this,c,c,c,p),w(this,D,jc).call(this,p);const y=(A,_)=>{const C=o[A]/255,T=l[A]/255,E=new Array(_+1);for(let u=0;u<=_;u++)E[u]=C+u/_*(T-C);return E.join(",")};return w(this,D,io).call(this,y(0,5),y(1,5),y(2,5),p),a.url=w(this,D,Tr).call(this,f),a.url}addAlphaFilter(e){let i=r(this,D,Kt).get(e);if(i)return i;const[s]=w(this,D,dh).call(this,[e]),n=`alpha_${s}`;if(i=r(this,D,Kt).get(n),i)return r(this,D,Kt).set(e,i),i;const a=`g_${r(this,Wi)}_alpha_map_${ie(this,On)._++}`,o=w(this,D,Tr).call(this,a);r(this,D,Kt).set(e,o),r(this,D,Kt).set(n,o);const l=w(this,D,Mr).call(this,a);return w(this,D,qc).call(this,s,l),o}addLuminosityFilter(e){let i=r(this,D,Kt).get(e||"luminosity");if(i)return i;let s,n;if(e?([s]=w(this,D,dh).call(this,[e]),n=`luminosity_${s}`):n="luminosity",i=r(this,D,Kt).get(n),i)return r(this,D,Kt).set(e,i),i;const a=`g_${r(this,Wi)}_luminosity_map_${ie(this,On)._++}`,o=w(this,D,Tr).call(this,a);r(this,D,Kt).set(e,o),r(this,D,Kt).set(n,o);const l=w(this,D,Mr).call(this,a);return w(this,D,Of).call(this,l),e&&w(this,D,qc).call(this,s,l),o}addHighlightHCMFilter(e,i,s,n,a){var T;const o=`${i}-${s}-${n}-${a}`;let l=r(this,D,to).get(e);if((l==null?void 0:l.key)===o||(l?((T=l.filter)==null||T.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},r(this,D,to).set(e,l)),!i||!s))return l.url;const[h,c]=[i,s].map(w(this,D,so).bind(this));let f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),p=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[y,v]=[n,a].map(w(this,D,so).bind(this));p<f&&([f,p,y,v]=[p,f,v,y]),r(this,D,Pr).style.color="";const A=(E,u,m)=>{const x=new Array(256),S=(p-f)/m,P=E/255,M=(u-E)/(255*m);let I=0;for(let k=0;k<=m;k++){const U=Math.round(f+k*S),$=P+k*M;for(let W=I;W<=U;W++)x[W]=$;I=U+1}for(let k=I;k<256;k++)x[k]=x[I-1];return x.join(",")},_=`g_${r(this,Wi)}_hcm_${e}_filter`,C=l.filter=w(this,D,Mr).call(this,_);return w(this,D,jc).call(this,C),w(this,D,io).call(this,A(y[0],v[0],5),A(y[1],v[1],5),A(y[2],v[2],5),C),l.url=w(this,D,Tr).call(this,_),l.url}destroy(e=!1){var i,s,n,a;e&&((i=r(this,Ln))!=null&&i.size)||((s=r(this,$i))==null||s.parentNode.parentNode.remove(),g(this,$i,null),(n=r(this,ta))==null||n.clear(),g(this,ta,null),(a=r(this,Ln))==null||a.clear(),g(this,Ln,null),g(this,On,0))}}Dn=new WeakMap,ta=new WeakMap,$i=new WeakMap,Wi=new WeakMap,Jt=new WeakMap,Ln=new WeakMap,On=new WeakMap,D=new WeakSet,Kt=function(){return r(this,ta)||g(this,ta,new Map)},to=function(){return r(this,Ln)||g(this,Ln,new Map)},Pr=function(){if(!r(this,$i)){const e=r(this,Jt).createElement("div"),{style:i}=e;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=r(this,Jt).createElementNS(Ii,"svg");s.setAttribute("width",0),s.setAttribute("height",0),g(this,$i,r(this,Jt).createElementNS(Ii,"defs")),e.append(s),s.append(r(this,$i)),r(this,Jt).body.append(e)}return r(this,$i)},dh=function(e){if(e.length===1){const h=e[0],c=new Array(256);for(let p=0;p<256;p++)c[p]=h[p]/255;const f=c.join(",");return[f,f,f]}const[i,s,n]=e,a=new Array(256),o=new Array(256),l=new Array(256);for(let h=0;h<256;h++)a[h]=i[h]/255,o[h]=s[h]/255,l[h]=n[h]/255;return[a.join(","),o.join(","),l.join(",")]},Tr=function(e){if(r(this,Dn)===void 0){g(this,Dn,"");const i=r(this,Jt).URL;i!==r(this,Jt).baseURI&&(dc(i)?q('#createUrl: ignore "data:"-URL for performance reasons.'):g(this,Dn,i.split("#",1)[0]))}return`url(${r(this,Dn)}#${e})`},Of=function(e){const i=r(this,Jt).createElementNS(Ii,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(i)},jc=function(e){const i=r(this,Jt).createElementNS(Ii,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(i)},Mr=function(e){const i=r(this,Jt).createElementNS(Ii,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",e),r(this,D,Pr).append(i),i},eo=function(e,i,s){const n=r(this,Jt).createElementNS(Ii,i);n.setAttribute("type","discrete"),n.setAttribute("tableValues",s),e.append(n)},io=function(e,i,s,n){const a=r(this,Jt).createElementNS(Ii,"feComponentTransfer");n.append(a),w(this,D,eo).call(this,a,"feFuncR",e),w(this,D,eo).call(this,a,"feFuncG",i),w(this,D,eo).call(this,a,"feFuncB",s)},qc=function(e,i){const s=r(this,Jt).createElementNS(Ii,"feComponentTransfer");i.append(s),w(this,D,eo).call(this,s,"feFuncA",e)},so=function(e){return r(this,D,Pr).style.color=e,Kd(getComputedStyle(r(this,D,Pr)).getPropertyValue("color"))};class Ff{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){at("Abstract method `_fetch` called.")}}class xu extends Ff{async _fetch(t){const e=await Hl(t,"arraybuffer");return new Uint8Array(e)}}class Nf{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){at("Abstract method `_fetch` called.")}}class vu extends Nf{async _fetch(t){const e=await Hl(t,"arraybuffer");return new Uint8Array(e)}}$t&&q("Please use the `legacy` build in Node.js environments.");async function tu(d){const e=await process.getBuiltinModule("fs").promises.readFile(d);return new Uint8Array(e)}class Dg extends Lf{}class Lg extends Rf{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class Og extends Df{async _fetch(t){return tu(t)}}class Fg extends Ff{async _fetch(t){return tu(t)}}class Ng extends Nf{async _fetch(t){return tu(t)}}const Wt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Xc(d,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),d.clip(s)}class eu{isModifyingCurrentTransform(){return!1}getPattern(){at("Abstract method `getPattern` called.")}}class Gg extends eu{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,s){let n;if(s===Wt.STROKE||s===Wt.FILL){const a=e.current.getClippedPathBoundingBox(s,ut(t))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,h=e.cachedCanvases.getCanvas("pattern",o,l),c=h.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-a[0],-a[1]),i=G.transform(i,[1,0,0,1,a[0],a[1]]),c.transform(...e.baseTransform),this.matrix&&c.transform(...this.matrix),Xc(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),n=t.createPattern(h.canvas,"no-repeat");const f=new DOMMatrix(i);n.setTransform(f)}else Xc(t,this._bbox),n=this._createGradient(t);return n}}function Ac(d,t,e,i,s,n,a,o){const l=t.coords,h=t.colors,c=d.data,f=d.width*4;let p;l[e+1]>l[i+1]&&(p=e,e=i,i=p,p=n,n=a,a=p),l[i+1]>l[s+1]&&(p=i,i=s,s=p,p=a,a=o,o=p),l[e+1]>l[i+1]&&(p=e,e=i,i=p,p=n,n=a,a=p);const y=(l[e]+t.offsetX)*t.scaleX,v=(l[e+1]+t.offsetY)*t.scaleY,A=(l[i]+t.offsetX)*t.scaleX,_=(l[i+1]+t.offsetY)*t.scaleY,C=(l[s]+t.offsetX)*t.scaleX,T=(l[s+1]+t.offsetY)*t.scaleY;if(v>=T)return;const E=h[n],u=h[n+1],m=h[n+2],x=h[a],S=h[a+1],P=h[a+2],M=h[o],I=h[o+1],k=h[o+2],U=Math.round(v),$=Math.round(T);let W,mt,O,H,me,Ti,Mi,ki;for(let Yt=U;Yt<=$;Yt++){if(Yt<_){const yt=Yt<v?0:(v-Yt)/(v-_);W=y-(y-A)*yt,mt=E-(E-x)*yt,O=u-(u-S)*yt,H=m-(m-P)*yt}else{let yt;Yt>T?yt=1:_===T?yt=0:yt=(_-Yt)/(_-T),W=A-(A-C)*yt,mt=x-(x-M)*yt,O=S-(S-I)*yt,H=P-(P-k)*yt}let vt;Yt<v?vt=0:Yt>T?vt=1:vt=(v-Yt)/(v-T),me=y-(y-C)*vt,Ti=E-(E-M)*vt,Mi=u-(u-I)*vt,ki=m-(m-k)*vt;const Sr=Math.round(Math.min(W,me)),ms=Math.round(Math.max(W,me));let oi=f*Yt+Sr*4;for(let yt=Sr;yt<=ms;yt++)vt=(W-yt)/(W-me),vt<0?vt=0:vt>1&&(vt=1),c[oi++]=mt-(mt-Ti)*vt|0,c[oi++]=O-(O-Mi)*vt|0,c[oi++]=H-(H-ki)*vt|0,c[oi++]=255}}function Bg(d,t,e){const i=t.coords,s=t.colors;let n,a;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(i.length/o)-1,h=o-1;for(n=0;n<l;n++){let c=n*o;for(let f=0;f<h;f++,c++)Ac(d,e,i[c],i[c+1],i[c+o],s[c],s[c+1],s[c+o]),Ac(d,e,i[c+o+1],i[c+1],i[c+o],s[c+o+1],s[c+1],s[c+o])}break;case"triangles":for(n=0,a=i.length;n<a;n+=3)Ac(d,e,i[n],i[n+1],i[n+2],s[n],s[n+1],s[n+2]);break;default:throw new Error("illegal figure")}}class Ug extends eu{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-o,c=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(h*t[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(c*t[1]*1.1)),3e3),y=h/f,v=c/p,A={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/y,scaleY:1/v},_=f+2*2,C=p+2*2,T=i.getCanvas("mesh",_,C),E=T.context,u=E.createImageData(f,p);if(e){const x=u.data;for(let S=0,P=x.length;S<P;S+=4)x[S]=e[0],x[S+1]=e[1],x[S+2]=e[2],x[S+3]=255}for(const x of this._figures)Bg(u,x,A);return E.putImageData(u,2,2),{canvas:T.canvas,offsetX:o-2*y,offsetY:l-2*v,scaleX:y,scaleY:v}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,s){Xc(t,this._bbox);let n;if(s===Wt.SHADING)n=G.singularValueDecompose2dScale(ut(t));else if(n=G.singularValueDecompose2dScale(e.baseTransform),this.matrix){const o=G.singularValueDecompose2dScale(this.matrix);n=[n[0]*o[0],n[1]*o[1]]}const a=this._createMeshCanvas(n,s===Wt.SHADING?null:this._background,e.cachedCanvases);return s!==Wt.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class Hg extends eu{getPattern(){return"hotpink"}}function zg(d){switch(d[0]){case"RadialAxial":return new Gg(d);case"Mesh":return new Ug(d);case"Dummy":return new Hg}throw new Error(`Unknown IR type: ${d[0]}`)}const Su={COLORED:1,UNCOLORED:2},Zh=class Zh{constructor(t,e,i,s){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:i,paintType:s,tilingType:n,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:h}=this;l=Math.abs(l),h=Math.abs(h),cc("TilingType: "+n);const c=e[0],f=e[1],p=e[2],y=e[3],v=p-c,A=y-f,_=G.singularValueDecompose2dScale(this.matrix),C=G.singularValueDecompose2dScale(this.baseTransform),T=_[0]*C[0],E=_[1]*C[1];let u=v,m=A,x=!1,S=!1;const P=Math.ceil(l*T),M=Math.ceil(h*E),I=Math.ceil(v*T),k=Math.ceil(A*E);P>=I?u=l:x=!0,M>=k?m=h:S=!0;const U=this.getSizeAndScale(u,this.ctx.canvas.width,T),$=this.getSizeAndScale(m,this.ctx.canvas.height,E),W=t.cachedCanvases.getCanvas("pattern",U.size,$.size),mt=W.context,O=o.createCanvasGraphics(mt);if(O.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(O,s,a),mt.translate(-U.scale*c,-$.scale*f),O.transform(U.scale,0,0,$.scale,0,0),mt.save(),this.clipBbox(O,c,f,p,y),O.baseTransform=ut(O.ctx),O.executeOperatorList(i),O.endDrawing(),mt.restore(),x||S){const H=W.canvas;x&&(u=l),S&&(m=h);const me=this.getSizeAndScale(u,this.ctx.canvas.width,T),Ti=this.getSizeAndScale(m,this.ctx.canvas.height,E),Mi=me.size,ki=Ti.size,Yt=t.cachedCanvases.getCanvas("pattern-workaround",Mi,ki),vt=Yt.context,Sr=x?Math.floor(v/l):0,ms=S?Math.floor(A/h):0;for(let oi=0;oi<=Sr;oi++)for(let yt=0;yt<=ms;yt++)vt.drawImage(H,Mi*oi,ki*yt,Mi,ki,0,0,Mi,ki);return{canvas:Yt.canvas,scaleX:me.scale,scaleY:Ti.scale,offsetX:c,offsetY:f}}return{canvas:W.canvas,scaleX:U.scale,scaleY:$.scale,offsetX:c,offsetY:f}}getSizeAndScale(t,e,i){const s=Math.max(Zh.MAX_PATTERN_SIZE,e);let n=Math.ceil(t*i);return n>=s?n=s:i=n/t,{scale:i,size:n}}clipBbox(t,e,i,s,n){const a=s-e,o=n-i;t.ctx.rect(e,i,a,o),t.current.updateRectMinMax(ut(t.ctx),[e,i,s,n]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,n=t.current;switch(e){case Su.COLORED:const a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,n.fillColor=a.fillStyle,n.strokeColor=a.strokeStyle;break;case Su.UNCOLORED:const o=G.makeHexColor(i[0],i[1],i[2]);s.fillStyle=o,s.strokeStyle=o,n.fillColor=o,n.strokeColor=o;break;default:throw new fg(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,s){let n=i;s!==Wt.SHADING&&(n=G.transform(n,e.baseTransform),this.matrix&&(n=G.transform(n,this.matrix)));const a=this.createPatternCanvas(e);let o=new DOMMatrix(n);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=t.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};N(Zh,"MAX_PATTERN_SIZE",3e3);let Yc=Zh;function Vg({src:d,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:n=4294967295,inverseDecode:a=!1}){const o=Xt.isLittleEndian?4278190080:255,[l,h]=a?[n,o]:[o,n],c=i>>3,f=i&7,p=d.length;e=new Uint32Array(e.buffer);let y=0;for(let v=0;v<s;v++){for(const _=t+c;t<_;t++){const C=t<p?d[t]:255;e[y++]=C&128?h:l,e[y++]=C&64?h:l,e[y++]=C&32?h:l,e[y++]=C&16?h:l,e[y++]=C&8?h:l,e[y++]=C&4?h:l,e[y++]=C&2?h:l,e[y++]=C&1?h:l}if(f===0)continue;const A=t<p?d[t++]:255;for(let _=0;_<f;_++)e[y++]=A&1<<7-_?h:l}return{srcPos:t,destPos:y}}const _u=16,Eu=100,$g=15,Cu=10,Pu=1e3,ge=16,xc=new DOMMatrix;function Wg(d,t){if(d._removeMirroring)throw new Error("Context is already forwarding operations.");d.__originalSave=d.save,d.__originalRestore=d.restore,d.__originalRotate=d.rotate,d.__originalScale=d.scale,d.__originalTranslate=d.translate,d.__originalTransform=d.transform,d.__originalSetTransform=d.setTransform,d.__originalResetTransform=d.resetTransform,d.__originalClip=d.clip,d.__originalMoveTo=d.moveTo,d.__originalLineTo=d.lineTo,d.__originalBezierCurveTo=d.bezierCurveTo,d.__originalRect=d.rect,d.__originalClosePath=d.closePath,d.__originalBeginPath=d.beginPath,d._removeMirroring=()=>{d.save=d.__originalSave,d.restore=d.__originalRestore,d.rotate=d.__originalRotate,d.scale=d.__originalScale,d.translate=d.__originalTranslate,d.transform=d.__originalTransform,d.setTransform=d.__originalSetTransform,d.resetTransform=d.__originalResetTransform,d.clip=d.__originalClip,d.moveTo=d.__originalMoveTo,d.lineTo=d.__originalLineTo,d.bezierCurveTo=d.__originalBezierCurveTo,d.rect=d.__originalRect,d.closePath=d.__originalClosePath,d.beginPath=d.__originalBeginPath,delete d._removeMirroring},d.save=function(){t.save(),this.__originalSave()},d.restore=function(){t.restore(),this.__originalRestore()},d.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},d.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},d.transform=function(i,s,n,a,o,l){t.transform(i,s,n,a,o,l),this.__originalTransform(i,s,n,a,o,l)},d.setTransform=function(i,s,n,a,o,l){t.setTransform(i,s,n,a,o,l),this.__originalSetTransform(i,s,n,a,o,l)},d.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},d.rotate=function(i){t.rotate(i),this.__originalRotate(i)},d.clip=function(i){t.clip(i),this.__originalClip(i)},d.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},d.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},d.bezierCurveTo=function(e,i,s,n,a,o){t.bezierCurveTo(e,i,s,n,a,o),this.__originalBezierCurveTo(e,i,s,n,a,o)},d.rect=function(e,i,s,n){t.rect(e,i,s,n),this.__originalRect(e,i,s,n)},d.closePath=function(){t.closePath(),this.__originalClosePath()},d.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class jg{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Yl(d,t,e,i,s,n,a,o,l,h){const[c,f,p,y,v,A]=ut(d);if(f===0&&p===0){const T=a*c+v,E=Math.round(T),u=o*y+A,m=Math.round(u),x=(a+l)*c+v,S=Math.abs(Math.round(x)-E)||1,P=(o+h)*y+A,M=Math.abs(Math.round(P)-m)||1;return d.setTransform(Math.sign(c),0,0,Math.sign(y),E,m),d.drawImage(t,e,i,s,n,0,0,S,M),d.setTransform(c,f,p,y,v,A),[S,M]}if(c===0&&y===0){const T=o*p+v,E=Math.round(T),u=a*f+A,m=Math.round(u),x=(o+h)*p+v,S=Math.abs(Math.round(x)-E)||1,P=(a+l)*f+A,M=Math.abs(Math.round(P)-m)||1;return d.setTransform(0,Math.sign(f),Math.sign(p),0,E,m),d.drawImage(t,e,i,s,n,0,0,M,S),d.setTransform(c,f,p,y,v,A),[M,S]}d.drawImage(t,e,i,s,n,a,o,l,h);const _=Math.hypot(c,f),C=Math.hypot(p,y);return[_*l,C*h]}function qg(d){const{width:t,height:e}=d;if(t>Pu||e>Pu)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=t+1,a=new Uint8Array(n*(e+1));let o,l,h;const c=t+7&-8,f=new Uint8Array(c*e);let p=0;for(const x of d.data){let S=128;for(;S>0;)f[p++]=x&S?0:255,S>>=1}let y=0;for(p=0,f[p]!==0&&(a[0]=1,++y),l=1;l<t;l++)f[p]!==f[p+1]&&(a[l]=f[p]?2:1,++y),p++;for(f[p]!==0&&(a[l]=2,++y),o=1;o<e;o++){p=o*c,h=o*n,f[p-c]!==f[p]&&(a[h]=f[p]?1:8,++y);let x=(f[p]?4:0)+(f[p-c]?8:0);for(l=1;l<t;l++)x=(x>>2)+(f[p+1]?4:0)+(f[p-c+1]?8:0),s[x]&&(a[h+l]=s[x],++y),p++;if(f[p-c]!==f[p]&&(a[h+l]=f[p]?2:4,++y),y>i)return null}for(p=c*(e-1),h=o*n,f[p]!==0&&(a[h]=8,++y),l=1;l<t;l++)f[p]!==f[p+1]&&(a[h+l]=f[p]?4:8,++y),p++;if(f[p]!==0&&(a[h+l]=4,++y),y>i)return null;const v=new Int32Array([0,n,-1,0,-n,0,0,0,1]),A=new Path2D,{a:_,b:C,c:T,d:E,e:u,f:m}=new DOMMatrix().scaleSelf(1/t,-1/e).translateSelf(0,-e);for(o=0;y&&o<=e;o++){let x=o*n;const S=x+t;for(;x<S&&!a[x];)x++;if(x===S)continue;let P=x%n,M=o;A.moveTo(_*P+T*M+u,C*P+E*M+m);const I=x;let k=a[x];do{const U=v[k];do x+=U;while(!a[x]);const $=a[x];$!==5&&$!==10?(k=$,a[x]=0):(k=$&51*k>>4,a[x]&=k>>2|k<<2),P=x%n,M=x/n|0,A.lineTo(_*P+T*M+u,C*P+E*M+m),a[x]||--y}while(I!==x);--o}return A}class Tu{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Wu,this.textMatrixScale=1,this.fontMatrix=Ec,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Zt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}updateRectMinMax(t,e){const i=G.applyTransform(e,t),s=G.applyTransform(e.slice(2),t),n=G.applyTransform([e[0],e[3]],t),a=G.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],s[0],n[0],a[0]),this.minY=Math.min(this.minY,i[1],s[1],n[1],a[1]),this.maxX=Math.max(this.maxX,i[0],s[0],n[0],a[0]),this.maxY=Math.max(this.maxY,i[1],s[1],n[1],a[1])}getPathBoundingBox(t=Wt.FILL,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===Wt.STROKE){e||at("Stroke bounding box must include transform.");const s=G.singularValueDecompose2dScale(e),n=s[0]*this.lineWidth/2,a=s[1]*this.lineWidth/2;i[0]-=n,i[1]-=a,i[2]+=n,i[3]+=a}return i}updateClipFromPath(){const t=G.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Wt.FILL,e=null){return G.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Mu(d,t){if(t instanceof ImageData){d.putImageData(t,0,0);return}const e=t.height,i=t.width,s=e%ge,n=(e-s)/ge,a=s===0?n:n+1,o=d.createImageData(i,ge);let l=0,h;const c=t.data,f=o.data;let p,y,v,A;if(t.kind===eh.GRAYSCALE_1BPP){const _=c.byteLength,C=new Uint32Array(f.buffer,0,f.byteLength>>2),T=C.length,E=i+7>>3,u=4294967295,m=Xt.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(v=p<n?ge:s,h=0,y=0;y<v;y++){const x=_-l;let S=0;const P=x>E?i:x*8-7,M=P&-8;let I=0,k=0;for(;S<M;S+=8)k=c[l++],C[h++]=k&128?u:m,C[h++]=k&64?u:m,C[h++]=k&32?u:m,C[h++]=k&16?u:m,C[h++]=k&8?u:m,C[h++]=k&4?u:m,C[h++]=k&2?u:m,C[h++]=k&1?u:m;for(;S<P;S++)I===0&&(k=c[l++],I=128),C[h++]=k&I?u:m,I>>=1}for(;h<T;)C[h++]=0;d.putImageData(o,0,p*ge)}}else if(t.kind===eh.RGBA_32BPP){for(y=0,A=i*ge*4,p=0;p<n;p++)f.set(c.subarray(l,l+A)),l+=A,d.putImageData(o,0,y),y+=ge;p<a&&(A=i*s*4,f.set(c.subarray(l,l+A)),d.putImageData(o,0,y))}else if(t.kind===eh.RGB_24BPP)for(v=ge,A=i*v,p=0;p<a;p++){for(p>=n&&(v=s,A=i*v),h=0,y=A;y--;)f[h++]=c[l++],f[h++]=c[l++],f[h++]=c[l++],f[h++]=255;d.putImageData(o,0,p*ge)}else throw new Error(`bad image kind: ${t.kind}`)}function ku(d,t){if(t.bitmap){d.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,s=e%ge,n=(e-s)/ge,a=s===0?n:n+1,o=d.createImageData(i,ge);let l=0;const h=t.data,c=o.data;for(let f=0;f<a;f++){const p=f<n?ge:s;({srcPos:l}=Vg({src:h,srcPos:l,dest:c,width:i,height:p,nonBlackColor:0})),d.putImageData(o,0,f*ge)}}function $a(d,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)d[i]!==void 0&&(t[i]=d[i]);d.setLineDash!==void 0&&(t.setLineDash(d.getLineDash()),t.lineDashOffset=d.lineDashOffset)}function Zl(d){if(d.strokeStyle=d.fillStyle="#000000",d.fillRule="nonzero",d.globalAlpha=1,d.lineWidth=1,d.lineCap="butt",d.lineJoin="miter",d.miterLimit=10,d.globalCompositeOperation="source-over",d.font="10px sans-serif",d.setLineDash!==void 0&&(d.setLineDash([]),d.lineDashOffset=0),!$t){const{filter:t}=d;t!=="none"&&t!==""&&(d.filter="none")}}function Iu(d,t){if(t)return!0;const e=G.singularValueDecompose2dScale(d);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround(ps.pixelRatio*sn.PDF_TO_CSS_UNITS);return e[0]<=i&&e[1]<=i}const Xg=["butt","round","square"],Yg=["miter","round","bevel"],Zg={},Ru={};var ai,Zc,Kc,Qc;const cu=class cu{constructor(t,e,i,s,n,{optionalContentConfig:a,markedContentStack:o=null},l,h){b(this,ai);this.ctx=t,this.current=new Tu(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new jg(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const n=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,n,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",n,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...ut(this.compositeCtx))}this.ctx.save(),Zl(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ut(this.ctx)}executeOperatorList(t,e,i,s){const n=t.argsArray,a=t.fnArray;let o=e||0;const l=n.length;if(l===o)return o;const h=l-o>Cu&&typeof i=="function",c=h?Date.now()+$g:0;let f=0;const p=this.commonObjs,y=this.objs;let v;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(v=a[o],v!==Rh.dependency)this[v].apply(this,n[o]);else for(const A of n[o]){const _=A.startsWith("g_")?p:y;if(!_.has(A))return _.get(A,i),o}if(o++,o===l)return o;if(h&&++f>Cu){if(Date.now()>c)return i(),o;f=0}}}endDrawing(){w(this,ai,Zc).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),w(this,ai,Kc).call(this)}_scaleImage(t,e){const i=t.width??t.displayWidth,s=t.height??t.displayHeight;let n=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),o=i,l=s,h="prescale1",c,f;for(;n>2&&o>1||a>2&&l>1;){let p=o,y=l;n>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),n/=o/p),a>2&&l>1&&(y=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/y),c=this.cachedCanvases.getCanvas(h,p,y),f=c.context,f.clearRect(0,0,p,y),f.drawImage(t,0,0,o,l,0,0,p,y),t=c.canvas,o=p,l=y,h=h==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:l}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:s}=t,n=this.current.fillColor,a=this.current.patternFill,o=ut(e);let l,h,c,f;if((t.bitmap||t.data)&&t.count>1){const P=t.bitmap||t.data.buffer;h=JSON.stringify(a?o:[o.slice(0,4),n]),l=this._cachedBitmapsMap.get(P),l||(l=new Map,this._cachedBitmapsMap.set(P,l));const M=l.get(h);if(M&&!a){const I=Math.round(Math.min(o[0],o[2])+o[4]),k=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:M,offsetX:I,offsetY:k}}c=M}c||(f=this.cachedCanvases.getCanvas("maskCanvas",i,s),ku(f.context,t));let p=G.transform(o,[1/i,0,0,-1/s,0,0]);p=G.transform(p,[1,0,0,1,0,-s]);const[y,v,A,_]=G.getAxialAlignedBoundingBox([0,0,i,s],p),C=Math.round(A-y)||1,T=Math.round(_-v)||1,E=this.cachedCanvases.getCanvas("fillCanvas",C,T),u=E.context,m=y,x=v;u.translate(-m,-x),u.transform(...p),c||(c=this._scaleImage(f.canvas,li(u)),c=c.img,l&&a&&l.set(h,c)),u.imageSmoothingEnabled=Iu(ut(u),t.interpolate),Yl(u,c,0,0,c.width,c.height,0,0,i,s),u.globalCompositeOperation="source-in";const S=G.transform(li(u),[1,0,0,1,-m,-x]);return u.fillStyle=a?n.getPattern(e,this,S,Wt.FILL):n,u.fillRect(0,0,i,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(h,E.canvas)),{canvas:E.canvas,offsetX:Math.round(m),offsetY:Math.round(x)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Xg[t]}setLineJoin(t){this.ctx.lineJoin=Yg[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx;const n=this.ctx=s.context;n.setTransform(this.suspendedCtx.getTransform()),$a(this.suspendedCtx,n),Wg(n,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),$a(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,s){const n=s[0],a=s[1],o=s[2]-n,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(e.context,i,o,l,e.subtype,e.backdrop,e.transferMap,n,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,n,a,o,l,h,c,f){let p=t.canvas,y=l-c,v=h-f;if(a){const _=G.makeHexColor(...a);if(y<0||v<0||y+i>p.width||v+s>p.height){const C=this.cachedCanvases.getCanvas("maskExtension",i,s),T=C.context;T.drawImage(p,-y,-v),T.globalCompositeOperation="destination-atop",T.fillStyle=_,T.fillRect(0,0,i,s),T.globalCompositeOperation="source-over",p=C.canvas,y=v=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(y,v,i,s),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=_,t.fillRect(y,v,i,s),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),n==="Alpha"&&o?e.filter=this.filterFactory.addAlphaFilter(o):n==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(o));const A=new Path2D;A.rect(l,h,i,s),e.clip(A),e.globalCompositeOperation="destination-in",e.drawImage(p,y,v,i,s,l,h,i,s),e.restore()}save(){this.inSMaskMode&&$a(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&$a(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,s,n,a){this.ctx.transform(t,e,i,s,n,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){let[s]=e;if(!i){s||(s=e[0]=new Path2D),this[t](s);return}if(!(s instanceof Path2D)){const n=e[0]=new Path2D;for(let a=0,o=s.length;a<o;)switch(s[a++]){case ql.moveTo:n.moveTo(s[a++],s[a++]);break;case ql.lineTo:n.lineTo(s[a++],s[a++]);break;case ql.curveTo:n.bezierCurveTo(s[a++],s[a++],s[a++],s[a++],s[a++],s[a++]);break;case ql.closePath:n.closePath();break;default:q(`Unrecognized drawing path operator: ${s[a-1]}`);break}s=n}this.current.updateRectMinMax(ut(this.ctx),i),this[t](s)}closePath(){this.ctx.closePath()}stroke(t,e=!0){const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const n=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,li(i),Wt.STROKE),n){const a=new Path2D;a.addPath(t,i.getTransform().invertSelf().multiplySelf(n)),t=a}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(Wt.STROKE,ut(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,e=!0){const i=this.ctx,s=this.current.fillColor,n=this.current.patternFill;let a=!1;if(n){const l=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.fillStyle=s.getPattern(i,this,li(i),Wt.FILL),l){const h=new Path2D;h.addPath(t,i.getTransform().invertSelf().multiplySelf(l)),t=h}a=!0}const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),a&&i.restore(),e&&this.consumePath(t,o)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}clip(){this.pendingClip=Zg}eoClip(){this.pendingClip=Ru}beginText(){this.current.textMatrix=Wu,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const i=new Path2D,s=e.getTransform().invertSelf();for(const{transform:n,x:a,y:o,fontSize:l,path:h}of t)i.addPath(h,new DOMMatrix(n).preMultiplySelf(s).translate(a,o).scale(l,-l));e.clip(i),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var c;const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||Ec,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&q("Invalid font matrix for font "+t),e<0?(e=-e,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const n=i.loadedName||"sans-serif",a=((c=i.systemFontInfo)==null?void 0:c.css)||`"${n}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let h=e;e<_u?h=_u:e>Eu&&(h=Eu),this.current.fontSizeScale=e/h,this.ctx.font=`${l} ${o} ${h}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,s,n,a){this.current.textMatrix=[t,e,i,s,n,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,s,n){const a=this.ctx,o=this.current,l=o.font,h=o.textRenderingMode,c=o.fontSize/o.fontSizeScale,f=h&Zt.FILL_STROKE_MASK,p=!!(h&Zt.ADD_TO_PATH_FLAG),y=o.patternFill&&!l.missingFile,v=o.patternStroke&&!l.missingFile;let A;if((l.disableFontFace||p||y||v)&&(A=l.getPathGenerator(this.commonObjs,t)),l.disableFontFace||y||v){a.save(),a.translate(e,i),a.scale(c,-c);let _;if((f===Zt.FILL||f===Zt.FILL_STROKE)&&(s?(_=a.getTransform(),a.setTransform(...s),a.fill(w(this,ai,Qc).call(this,A,_,s))):a.fill(A)),f===Zt.STROKE||f===Zt.FILL_STROKE)if(n){_||(_=a.getTransform()),a.setTransform(...n);const{a:C,b:T,c:E,d:u}=_,m=G.inverseTransform(n),x=G.transform([C,T,E,u,0,0],m),[S,P]=G.singularValueDecompose2dScale(x);a.lineWidth*=Math.max(S,P)/c,a.stroke(w(this,ai,Qc).call(this,A,_,n))}else a.lineWidth/=c,a.stroke(A);a.restore()}else(f===Zt.FILL||f===Zt.FILL_STROKE)&&a.fillText(t,e,i),(f===Zt.STROKE||f===Zt.FILL_STROKE)&&a.strokeText(t,e,i);p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ut(a),x:e,y:i,fontSize:c,path:A})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return K(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const s=e.fontSize;if(s===0)return;const n=this.ctx,a=e.fontSizeScale,o=e.charSpacing,l=e.wordSpacing,h=e.fontDirection,c=e.textHScale*h,f=t.length,p=i.vertical,y=p?1:-1,v=i.defaultVMetrics,A=s*e.fontMatrix[0],_=e.textRenderingMode===Zt.FILL&&!i.disableFontFace&&!e.patternFill;n.save(),n.transform(...e.textMatrix),n.translate(e.x,e.y+e.textRise),h>0?n.scale(c,-1):n.scale(c,1);let C,T;if(e.patternFill){n.save();const S=e.fillColor.getPattern(n,this,li(n),Wt.FILL);C=ut(n),n.restore(),n.fillStyle=S}if(e.patternStroke){n.save();const S=e.strokeColor.getPattern(n,this,li(n),Wt.STROKE);T=ut(n),n.restore(),n.strokeStyle=S}let E=e.lineWidth;const u=e.textMatrixScale;if(u===0||E===0){const S=e.textRenderingMode&Zt.FILL_STROKE_MASK;(S===Zt.STROKE||S===Zt.FILL_STROKE)&&(E=this.getSinglePixelWidth())}else E/=u;if(a!==1&&(n.scale(a,a),E/=a),n.lineWidth=E,i.isInvalidPDFjsFont){const S=[];let P=0;for(const M of t)S.push(M.unicode),P+=M.width;n.fillText(S.join(""),0,0),e.x+=P*A*c,n.restore(),this.compose();return}let m=0,x;for(x=0;x<f;++x){const S=t[x];if(typeof S=="number"){m+=y*S*s/1e3;continue}let P=!1;const M=(S.isSpace?l:0)+o,I=S.fontChar,k=S.accent;let U,$,W=S.width;if(p){const O=S.vmetric||v,H=-(S.vmetric?O[1]:W*.5)*A,me=O[2]*A;W=O?-O[0]:W,U=H/a,$=(m+me)/a}else U=m/a,$=0;if(i.remeasure&&W>0){const O=n.measureText(I).width*1e3/s*a;if(W<O&&this.isFontSubpixelAAEnabled){const H=W/O;P=!0,n.save(),n.scale(H,1),U/=H}else W!==O&&(U+=(W-O)/2e3*s/a)}if(this.contentVisible&&(S.isInFont||i.missingFile)){if(_&&!k)n.fillText(I,U,$);else if(this.paintChar(I,U,$,C,T),k){const O=U+s*k.offset.x/a,H=$-s*k.offset.y/a;this.paintChar(k.fontChar,O,H,C,T)}}const mt=p?W*A-M*h:W*A+M*h;m+=mt,P&&n.restore()}p?e.y-=m:e.x+=m*c,n.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,s=i.font,n=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,l=i.charSpacing,h=i.wordSpacing,c=i.textHScale*a,f=i.fontMatrix||Ec,p=t.length,y=i.textRenderingMode===Zt.INVISIBLE;let v,A,_,C;if(!(y||n===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y+i.textRise),e.scale(c,a),v=0;v<p;++v){if(A=t[v],typeof A=="number"){C=o*A*n/1e3,this.ctx.translate(C,0),i.x+=C*c;continue}const T=(A.isSpace?h:0)+l,E=s.charProcOperatorList[A.operatorListId];E?this.contentVisible&&(this.processingType3=A,this.save(),e.scale(n,n),e.transform(...f),this.executeOperatorList(E),this.restore()):q(`Type3 character "${A.operatorListId}" is not available.`),_=G.applyTransform([A.width,0],f)[0]*n+T,e.translate(_,0),i.x+=_*c}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,s,n,a){this.ctx.rect(i,s,n-i,a-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const i=this.baseTransform||ut(this.ctx),s={createCanvasGraphics:n=>new cu(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Yc(t,this.ctx,s,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){this.ctx.strokeStyle=this.current.strokeColor=G.makeHexColor(t,e,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,i){this.ctx.fillStyle=this.current.fillColor=G.makeHexColor(t,e,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=zg(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,li(e),Wt.SHADING);const s=li(e);if(s){const{width:n,height:a}=e.canvas,[o,l,h,c]=G.getAxialAlignedBoundingBox([0,0,n,a],s);this.ctx.fillRect(o,l,h-o,c-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){at("Should not call beginInlineImage")}beginImageData(){at("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=ut(this.ctx),e)){const i=e[2]-e[0],s=e[3]-e[1];this.ctx.rect(e[0],e[1],i,s),this.current.updateRectMinMax(ut(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||cc("TODO: Support non-isolated groups."),t.knockout&&q("Knockout groups not supported.");const i=ut(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=G.getAxialAlignedBoundingBox(t.bbox,ut(e));const n=[0,0,e.canvas.width,e.canvas.height];s=G.intersect(s,n)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),h=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,h]);let c="groupAt"+this.groupLevel;t.smask&&(c+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(c,l,h),p=f.context;p.translate(-a,-o),p.transform(...i);let y=new Path2D;const[v,A,_,C]=t.bbox;if(y.rect(v,A,_-v,C-A),t.matrix){const T=new Path2D;T.addPath(y,new DOMMatrix(t.matrix)),y=T}p.clip(y),t.smask?this.smaskStack.push({canvas:f.canvas,context:p,offsetX:a,offsetY:o,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,o),e.save()),$a(e,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=ut(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const n=G.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],s);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,e,i,s,n){if(w(this,ai,Zc).call(this),Zl(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],o=e[3]-e[1];if(n&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=o;const[l,h]=G.singularValueDecompose2dScale(ut(this.ctx)),{viewportScale:c}=this,f=Math.ceil(a*this.outputScaleX*c),p=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:y,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(t,y),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(l,0,0,-h,0,o*h),Zl(this.ctx)}else Zl(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new Tu(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),w(this,ai,Kc).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=qg(t)),s.compiled)){i.fill(s.compiled);return}const n=this._createMaskCanvas(t),a=n.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,n.offsetX,n.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,s=0,n,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const o=this.ctx;o.save();const l=ut(o);o.transform(e,i,s,n,0,0);const h=this._createMaskCanvas(t);o.setTransform(1,0,0,1,h.offsetX-l[4],h.offsetY-l[5]);for(let c=0,f=a.length;c<f;c+=2){const p=G.transform(l,[e,i,s,n,a[c],a[c+1]]),[y,v]=G.applyTransform([0,0],p);o.drawImage(h.canvas,y,v)}o.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const n of t){const{data:a,width:o,height:l,transform:h}=n,c=this.cachedCanvases.getCanvas("maskCanvas",o,l),f=c.context;f.save();const p=this.getObject(a,n);ku(f,p),f.globalCompositeOperation="source-in",f.fillStyle=s?i.getPattern(f,this,li(e),Wt.FILL):i,f.fillRect(0,0,o,l),f.restore(),e.save(),e.transform(...h),e.scale(1,-1),Yl(e,c.canvas,0,0,o,l,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){q("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,i,s){if(!this.contentVisible)return;const n=this.getObject(t);if(!n){q("Dependent image isn't ready yet");return}const a=n.width,o=n.height,l=[];for(let h=0,c=s.length;h<c;h+=2)l.push({transform:[e,0,0,i,s[h],s[h+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(n,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:s}=t,n=this.cachedCanvases.getCanvas("inlineImage",i,s),a=n.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",n.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,s=this.ctx;if(this.save(),!$t){const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none")}s.scale(1/e,-1/i);let n;if(t.bitmap)n=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)n=t;else{const l=this.cachedCanvases.getCanvas("inlineImage",e,i).context;Mu(l,t),n=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(n,li(s));s.imageSmoothingEnabled=Iu(ut(s),t.interpolate),Yl(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const n=t.width,a=t.height,l=this.cachedCanvases.getCanvas("inlineImage",n,a).context;Mu(l,t),s=this.applyTransferMapsToCanvas(l)}for(const n of e)i.save(),i.transform(...n.transform),i.scale(1,-1),Yl(i,s,n.x,n.y,n.w,n.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(i||(this.pendingClip===Ru?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ut(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:n}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const l=Math.abs(e),h=Math.abs(n);if(l===h)if(t===0)a=o=1/l;else{const c=l*t;a=o=c<1?1/c:1}else if(t===0)a=1/l,o=1/h;else{const c=l*t,f=h*t;a=c<1?1/c:1,o=f<1?1/f:1}}else{const l=Math.abs(e*n-i*s),h=Math.hypot(e,i),c=Math.hypot(s,n);if(t===0)a=c/l,o=h/l;else{const f=t*l;a=c>f?c/f:1,o=h>f?h/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:s}}=this,[n,a]=this.getScaleForStroking();if(n===a){i.lineWidth=(s||1)*n,i.stroke(t);return}const o=i.getLineDash();e&&i.save(),i.scale(n,a),xc.a=1/n,xc.d=1/a;const l=new Path2D;if(l.addPath(t,xc),o.length>0){const h=Math.max(n,a);i.setLineDash(o.map(c=>c/h)),i.lineDashOffset/=h}i.lineWidth=s||1,i.stroke(l),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};ai=new WeakSet,Zc=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Kc=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},Qc=function(t,e,i){const s=new Path2D;return s.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),s};let Or=cu;for(const d in Rh)Or.prototype[d]!==void 0&&(Or.prototype[Rh[d]]=Or.prototype[d]);var Vo,$o;class hs{static get workerPort(){return r(this,Vo)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");g(this,Vo,t)}static get workerSrc(){return r(this,$o)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");g(this,$o,t)}}Vo=new WeakMap,$o=new WeakMap,b(hs,Vo,null),b(hs,$o,"");var Fn,Wo;class Kg{constructor({parsedData:t,rawData:e}){b(this,Fn);b(this,Wo);g(this,Fn,t),g(this,Wo,e)}getRaw(){return r(this,Wo)}get(t){return r(this,Fn).get(t)??null}getAll(){return jd(r(this,Fn))}has(t){return r(this,Fn).has(t)}}Fn=new WeakMap,Wo=new WeakMap;const kr=Symbol("INTERNAL");var jo,qo,Xo,ea;class Qg{constructor(t,{name:e,intent:i,usage:s,rbGroups:n}){b(this,jo,!1);b(this,qo,!1);b(this,Xo,!1);b(this,ea,!0);g(this,jo,!!(t&Ie.DISPLAY)),g(this,qo,!!(t&Ie.PRINT)),this.name=e,this.intent=i,this.usage=s,this.rbGroups=n}get visible(){if(r(this,Xo))return r(this,ea);if(!r(this,ea))return!1;const{print:t,view:e}=this.usage;return r(this,jo)?(e==null?void 0:e.viewState)!=="OFF":r(this,qo)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,i=!1){t!==kr&&at("Internal method `_setVisible` called."),g(this,Xo,i),g(this,ea,e)}}jo=new WeakMap,qo=new WeakMap,Xo=new WeakMap,ea=new WeakMap;var Ls,nt,ia,sa,Yo,Jc;class Jg{constructor(t,e=Ie.DISPLAY){b(this,Yo);b(this,Ls,null);b(this,nt,new Map);b(this,ia,null);b(this,sa,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,g(this,sa,t.order);for(const i of t.groups)r(this,nt).set(i.id,new Qg(e,i));if(t.baseState==="OFF")for(const i of r(this,nt).values())i._setVisible(kr,!1);for(const i of t.on)r(this,nt).get(i)._setVisible(kr,!0);for(const i of t.off)r(this,nt).get(i)._setVisible(kr,!1);g(this,ia,this.getHash())}}isVisible(t){if(r(this,nt).size===0)return!0;if(!t)return cc("Optional content group not defined."),!0;if(t.type==="OCG")return r(this,nt).has(t.id)?r(this,nt).get(t.id).visible:(q(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return w(this,Yo,Jc).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!r(this,nt).has(e))return q(`Optional content group not found: ${e}`),!0;if(r(this,nt).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!r(this,nt).has(e))return q(`Optional content group not found: ${e}`),!0;if(!r(this,nt).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!r(this,nt).has(e))return q(`Optional content group not found: ${e}`),!0;if(!r(this,nt).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!r(this,nt).has(e))return q(`Optional content group not found: ${e}`),!0;if(r(this,nt).get(e).visible)return!1}return!0}return q(`Unknown optional content policy ${t.policy}.`),!0}return q(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){var n;const s=r(this,nt).get(t);if(!s){q(`Optional content group not found: ${t}`);return}if(i&&e&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==t&&((n=r(this,nt).get(o))==null||n._setVisible(kr,!1,!0));s._setVisible(kr,!!e,!0),g(this,Ls,null)}setOCGState({state:t,preserveRB:e}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const n=r(this,nt).get(s);if(n)switch(i){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!n.visible,e);break}}g(this,Ls,null)}get hasInitialVisibility(){return r(this,ia)===null||this.getHash()===r(this,ia)}getOrder(){return r(this,nt).size?r(this,sa)?r(this,sa).slice():[...r(this,nt).keys()]:null}getGroups(){return r(this,nt).size>0?jd(r(this,nt)):null}getGroup(t){return r(this,nt).get(t)||null}getHash(){if(r(this,Ls)!==null)return r(this,Ls);const t=new Cf;for(const[e,i]of r(this,nt))t.update(`${e}:${i.visible}`);return g(this,Ls,t.hexdigest())}}Ls=new WeakMap,nt=new WeakMap,ia=new WeakMap,sa=new WeakMap,Yo=new WeakSet,Jc=function(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let s=1;s<e;s++){const n=t[s];let a;if(Array.isArray(n))a=w(this,Yo,Jc).call(this,n);else if(r(this,nt).has(n))a=r(this,nt).get(n).visible;else return q(`Optional content group not found: ${n}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class tm{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Ct(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:n,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(n==null?void 0:n.length)>0){const l=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((l,h)=>{this._onReceiveData({begin:l,chunk:h})}),t.addProgressListener((l,h)=>{this._onProgress({loaded:l,total:h})}),t.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(n){return n._begin!==t?!1:(n._enqueue(i),!0)});Ct(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,i,s,n;t.total===void 0?(i=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||i.call(e,{loaded:t.loaded}):(n=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||n.call(s,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Ct(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new em(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new im(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class em{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=Yd(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class im{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function sm(d){let t=!0,e=i("filename\\*","i").exec(d);if(e){e=e[1];let c=o(e);return c=unescape(c),c=l(c),c=h(c),n(c)}if(e=a(d),e){const c=h(e);return n(c)}if(e=i("filename","i").exec(d),e){e=e[1];let c=o(e);return c=h(c),n(c)}function i(c,f){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(c,f){if(c){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(c,{fatal:!0}),y=Ul(f);f=p.decode(y),t=!1}catch{}}return f}function n(c){return t&&/[\x80-\xff]/.test(c)&&(c=s("utf-8",c),t&&(c=s("iso-8859-1",c))),c}function a(c){const f=[];let p;const y=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=y.exec(c))!==null;){let[,A,_,C]=p;if(A=parseInt(A,10),A in f){if(A===0)break;continue}f[A]=[_,C]}const v=[];for(let A=0;A<f.length&&A in f;++A){let[_,C]=f[A];C=o(C),_&&(C=unescape(C),A===0&&(C=l(C))),v.push(C)}return v.join("")}function o(c){if(c.startsWith('"')){const f=c.slice(1).split('\\"');for(let p=0;p<f.length;++p){const y=f[p].indexOf('"');y!==-1&&(f[p]=f[p].slice(0,y),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}c=f.join('"')}return c}function l(c){const f=c.indexOf("'");if(f===-1)return c;const p=c.slice(0,f),v=c.slice(f+1).replace(/^[^']*'/,"");return s(p,v)}function h(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,y,v){if(y==="q"||y==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,_){return String.fromCharCode(parseInt(_,16))}),s(p,v);try{v=atob(v)}catch{}return s(p,v)})}return""}function Gf(d,t){const e=new Headers;if(!d||!t||typeof t!="object")return e;for(const i in t){const s=t[i];s!==void 0&&e.append(i,s)}return e}function uc(d){var t;return((t=URL.parse(d))==null?void 0:t.origin)??null}function Bf({responseHeaders:d,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},n=parseInt(d.get("Content-Length"),10);return!Number.isInteger(n)||(s.suggestedLength=n,n<=2*e)||i||!t||d.get("Accept-Ranges")!=="bytes"||(d.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function Uf(d){const t=d.get("Content-Disposition");if(t){let e=sm(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Yd(e))return e}return null}function $l(d,t){return new Dh(`Unexpected server response (${d}) while retrieving PDF "${t}".`,d,d===404||d===0&&t.startsWith("file:"))}function Hf(d){return d===200||d===206}function zf(d,t,e){return{method:"GET",headers:d,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Vf(d){return d instanceof Uint8Array?d.buffer:d instanceof ArrayBuffer?d:(q(`getArrayBuffer - unexpected data format: ${d}`),new Uint8Array(d).buffer)}class Du{constructor(t){N(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Gf(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Ct(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new nm(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new rm(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class nm{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),s=e.url;fetch(s,zf(i,this._withCredentials,this._abortController)).then(n=>{if(t._responseOrigin=uc(n.url),!Hf(n.status))throw $l(n.status,s);this._reader=n.body.getReader(),this._headersCapability.resolve();const a=n.headers,{allowRangeRequests:o,suggestedLength:l}=Bf({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=Uf(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new en("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Vf(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class rm{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const n=new Headers(t.headers);n.append("Range",`bytes=${e}-${i-1}`);const a=s.url;fetch(a,zf(n,this._withCredentials,this._abortController)).then(o=>{const l=uc(o.url);if(l!==t._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${t._responseOrigin}".`);if(!Hf(o.status))throw $l(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:Vf(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const vc=200,Sc=206;function am(d){const t=d.response;return typeof t!="string"?t:Ul(t).buffer}class om{constructor({url:t,httpHeaders:e,withCredentials:i}){N(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Gf(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[n,a]of this.headers)e.setRequestHeader(n,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=Sc):s.expectedStatus=vc,e.responseType="arraybuffer",Ct(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){var s;const i=this.pendingRequests[t];i&&((s=i.onProgress)==null||s.call(i,e))}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){i.onError(s.status);return}const n=s.status||vc;if(!(n===vc&&i.expectedStatus===Sc)&&n!==i.expectedStatus){i.onError(s.status);return}const o=am(s);if(n===Sc){const l=s.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);h?i.onDone({begin:parseInt(h[1],10),chunk:o}):(q('Missing or invalid "Content-Range" header.'),i.onError(0))}else o?i.onDone({begin:0,chunk:o}):i.onError(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class lm{constructor(t){this._source=t,this._manager=new om(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Ct(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new hm(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new cm(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class hm{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=uc(e.responseURL);const i=e.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...h]=o.split(": ");return[l,h.join(": ")]}):[]),{allowRangeRequests:n,suggestedLength:a}=Bf({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=Uf(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=$l(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class cm{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=uc((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=$l(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const dm=/^[a-z][a-z0-9\-+.]+:/i;function um(d){if(dm.test(d))return new URL(d);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(d))}class fm{constructor(t){this.source=t,this.url=um(t.url),Ct(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Ct(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new pm(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new gm(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class pm{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=$l(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new en("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class gm{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=t.source;this._isStreamingSupported=!s.disableStream;const n=process.getBuiltinModule("fs");this._setReadableStream(n.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const mm=1e5,Lu=30;var $u,Os,fe,Zo,Ko,Nn,ji,Qo,Jo,Gn,na,ra,Fs,aa,tl,oa,Bn,el,il,la,Un,sl,Ns,ha,gs,$f,Wf,td,De,uh,ed,jf,qf;const Tt=class Tt{constructor({textContentSource:t,container:e,viewport:i}){b(this,gs);b(this,Os,Promise.withResolvers());b(this,fe,null);b(this,Zo,!1);b(this,Ko,!!(($u=globalThis.FontInspector)!=null&&$u.enabled));b(this,Nn,null);b(this,ji,null);b(this,Qo,0);b(this,Jo,0);b(this,Gn,null);b(this,na,null);b(this,ra,0);b(this,Fs,0);b(this,aa,Object.create(null));b(this,tl,[]);b(this,oa,null);b(this,Bn,[]);b(this,el,new WeakMap);b(this,il,null);var l;if(t instanceof ReadableStream)g(this,oa,t);else if(typeof t=="object")g(this,oa,new ReadableStream({start(h){h.enqueue(t),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');g(this,fe,g(this,na,e)),g(this,Fs,i.scale*ps.pixelRatio),g(this,ra,i.rotation),g(this,ji,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:n,pageX:a,pageY:o}=i.rawDims;g(this,il,[1,0,0,-1,-a,o+n]),g(this,Jo,s),g(this,Qo,n),w(l=Tt,De,jf).call(l),br(e,i),r(this,Os).promise.finally(()=>{r(Tt,ha).delete(this),g(this,ji,null),g(this,aa,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Xt.platform;return K(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{r(this,Gn).read().then(({value:e,done:i})=>{if(i){r(this,Os).resolve();return}r(this,Nn)??g(this,Nn,e.lang),Object.assign(r(this,aa),e.styles),w(this,gs,$f).call(this,e.items),t()},r(this,Os).reject)};return g(this,Gn,r(this,oa).getReader()),r(Tt,ha).add(this),t(),r(this,Os).promise}update({viewport:t,onBefore:e=null}){var n;const i=t.scale*ps.pixelRatio,s=t.rotation;if(s!==r(this,ra)&&(e==null||e(),g(this,ra,s),br(r(this,na),{rotation:s})),i!==r(this,Fs)){e==null||e(),g(this,Fs,i);const a={div:null,properties:null,ctx:w(n=Tt,De,uh).call(n,r(this,Nn))};for(const o of r(this,Bn))a.properties=r(this,el).get(o),a.div=o,w(this,gs,td).call(this,a)}}cancel(){var e;const t=new en("TextLayer task cancelled.");(e=r(this,Gn))==null||e.cancel(t).catch(()=>{}),g(this,Gn,null),r(this,Os).reject(t)}get textDivs(){return r(this,Bn)}get textContentItemsStr(){return r(this,tl)}static cleanup(){if(!(r(this,ha).size>0)){r(this,la).clear();for(const{canvas:t}of r(this,Un).values())t.remove();r(this,Un).clear()}}};Os=new WeakMap,fe=new WeakMap,Zo=new WeakMap,Ko=new WeakMap,Nn=new WeakMap,ji=new WeakMap,Qo=new WeakMap,Jo=new WeakMap,Gn=new WeakMap,na=new WeakMap,ra=new WeakMap,Fs=new WeakMap,aa=new WeakMap,tl=new WeakMap,oa=new WeakMap,Bn=new WeakMap,el=new WeakMap,il=new WeakMap,la=new WeakMap,Un=new WeakMap,sl=new WeakMap,Ns=new WeakMap,ha=new WeakMap,gs=new WeakSet,$f=function(t){var s,n;if(r(this,Zo))return;(n=r(this,ji)).ctx??(n.ctx=w(s=Tt,De,uh).call(s,r(this,Nn)));const e=r(this,Bn),i=r(this,tl);for(const a of t){if(e.length>mm){q("Ignoring additional textDivs for performance reasons."),g(this,Zo,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=r(this,fe);g(this,fe,document.createElement("span")),r(this,fe).classList.add("markedContent"),a.id!==null&&r(this,fe).setAttribute("id",`${a.id}`),o.append(r(this,fe))}else a.type==="endMarkedContent"&&g(this,fe,r(this,fe).parentNode);continue}i.push(a.str),w(this,gs,Wf).call(this,a)}},Wf=function(t){var A;const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};r(this,Bn).push(e);const s=G.transform(r(this,il),t.transform);let n=Math.atan2(s[1],s[0]);const a=r(this,aa)[t.fontName];a.vertical&&(n+=Math.PI/2);let o=r(this,Ko)&&a.fontSubstitution||a.fontFamily;o=Tt.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),h=l*w(A=Tt,De,qf).call(A,o,a,r(this,Nn));let c,f;n===0?(c=s[4],f=s[5]-h):(c=s[4]+h*Math.sin(n),f=s[5]-h*Math.cos(n));const p="calc(var(--total-scale-factor) *",y=e.style;r(this,fe)===r(this,na)?(y.left=`${(100*c/r(this,Jo)).toFixed(2)}%`,y.top=`${(100*f/r(this,Qo)).toFixed(2)}%`):(y.left=`${p}${c.toFixed(2)}px)`,y.top=`${p}${f.toFixed(2)}px)`),y.fontSize=`${p}${(r(Tt,Ns)*l).toFixed(2)}px)`,y.fontFamily=o,i.fontSize=l,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,r(this,Ko)&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),n!==0&&(i.angle=n*(180/Math.PI));let v=!1;if(t.str.length>1)v=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),C=Math.abs(t.transform[3]);_!==C&&Math.max(_,C)/Math.min(_,C)>1.5&&(v=!0)}if(v&&(i.canvasWidth=a.vertical?t.height:t.width),r(this,el).set(e,i),r(this,ji).div=e,r(this,ji).properties=i,w(this,gs,td).call(this,r(this,ji)),i.hasText&&r(this,fe).append(e),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),r(this,fe).append(_)}},td=function(t){var o;const{div:e,properties:i,ctx:s}=t,{style:n}=e;let a="";if(r(Tt,Ns)>1&&(a=`scale(${1/r(Tt,Ns)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=n,{canvasWidth:h,fontSize:c}=i;w(o=Tt,De,ed).call(o,s,c*r(this,Fs),l);const{width:f}=s.measureText(e.textContent);f>0&&(a=`scaleX(${h*r(this,Fs)/f}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(n.transform=a)},De=new WeakSet,uh=function(t=null){let e=r(this,Un).get(t||(t=""));if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),r(this,Un).set(t,e),r(this,sl).set(e,{size:0,family:""})}return e},ed=function(t,e,i){const s=r(this,sl).get(t);e===s.size&&i===s.family||(t.font=`${e}px ${i}`,s.size=e,s.family=i)},jf=function(){if(r(this,Ns)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),g(this,Ns,t.getBoundingClientRect().height),t.remove()},qf=function(t,e,i){const s=r(this,la).get(t);if(s)return s;const n=w(this,De,uh).call(this,i);n.canvas.width=n.canvas.height=Lu,w(this,De,ed).call(this,n,Lu,t);const a=n.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);n.canvas.width=n.canvas.height=0;let h=.8;return o?h=o/(o+l):(Xt.platform.isFirefox&&q("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?h=e.ascent:e.descent&&(h=1+e.descent)),r(this,la).set(t,h),h},b(Tt,De),b(Tt,la,new Map),b(Tt,Un,new Map),b(Tt,sl,new WeakMap),b(Tt,Ns,null),b(Tt,ha,new Set);let go=Tt;class mo{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function s(n){var l;if(!n)return;let a=null;const o=n.name;if(o==="#text")a=n.value;else if(mo.shouldBuildText(o))(l=n==null?void 0:n.attributes)!=null&&l.textContent?a=n.attributes.textContent:n.value&&(a=n.value);else return;if(a!==null&&e.push({str:a}),!!n.children)for(const h of n.children)s(h)}return s(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const ym=65536,bm=100;function wm(d={}){typeof d=="string"||d instanceof URL?d={url:d}:(d instanceof ArrayBuffer||ArrayBuffer.isView(d))&&(d={data:d});const t=new sd,{docId:e}=t,i=d.url?Am(d.url):null,s=d.data?xm(d.data):null,n=d.httpHeaders||null,a=d.withCredentials===!0,o=d.password??null,l=d.range instanceof Xf?d.range:null,h=Number.isInteger(d.rangeChunkSize)&&d.rangeChunkSize>0?d.rangeChunkSize:ym;let c=d.worker instanceof Fr?d.worker:null;const f=d.verbosity,p=typeof d.docBaseUrl=="string"&&!dc(d.docBaseUrl)?d.docBaseUrl:null,y=Kl(d.cMapUrl),v=d.cMapPacked!==!1,A=d.CMapReaderFactory||($t?Og:Au),_=Kl(d.iccUrl),C=Kl(d.standardFontDataUrl),T=d.StandardFontDataFactory||($t?Fg:xu),E=Kl(d.wasmUrl),u=d.WasmFactory||($t?Ng:vu),m=d.stopAtErrors!==!0,x=Number.isInteger(d.maxImageSize)&&d.maxImageSize>-1?d.maxImageSize:-1,S=d.isEvalSupported!==!1,P=typeof d.isOffscreenCanvasSupported=="boolean"?d.isOffscreenCanvasSupported:!$t,M=typeof d.isImageDecoderSupported=="boolean"?d.isImageDecoderSupported:!$t&&(Xt.platform.isFirefox||!globalThis.chrome),I=Number.isInteger(d.canvasMaxAreaInBytes)?d.canvasMaxAreaInBytes:-1,k=typeof d.disableFontFace=="boolean"?d.disableFontFace:$t,U=d.fontExtraProperties===!0,$=d.enableXfa===!0,W=d.ownerDocument||globalThis.document,mt=d.disableRange===!0,O=d.disableStream===!0,H=d.disableAutoFetch===!0,me=d.pdfBug===!0,Ti=d.CanvasFactory||($t?Lg:Ig),Mi=d.FilterFactory||($t?Dg:Rg),ki=d.enableHWA===!0,Yt=d.useWasm!==!1,vt=l?l.length:d.length??NaN,Sr=typeof d.useSystemFonts=="boolean"?d.useSystemFonts:!$t&&!k,ms=typeof d.useWorkerFetch=="boolean"?d.useWorkerFetch:!!(A===Au&&T===xu&&u===vu&&y&&C&&E&&Cr(y,document.baseURI)&&Cr(C,document.baseURI)&&Cr(E,document.baseURI)),oi=null;hg(f);const yt={canvasFactory:new Ti({ownerDocument:W,enableHWA:ki}),filterFactory:new Mi({docId:e,ownerDocument:W}),cMapReaderFactory:ms?null:new A({baseUrl:y,isCompressed:v}),standardFontDataFactory:ms?null:new T({baseUrl:C}),wasmFactory:ms?null:new u({baseUrl:E})};if(!c){const Va={verbosity:f,port:hs.workerPort};c=Va.port?Fr.fromPort(Va):new Fr(Va),t._worker=c}const eg={docId:e,apiVersion:"5.1.91",data:s,password:o,disableAutoFetch:H,rangeChunkSize:h,length:vt,docBaseUrl:p,enableXfa:$,evaluatorOptions:{maxImageSize:x,disableFontFace:k,ignoreErrors:m,isEvalSupported:S,isOffscreenCanvasSupported:P,isImageDecoderSupported:M,canvasMaxAreaInBytes:I,fontExtraProperties:U,useSystemFonts:Sr,useWasm:Yt,useWorkerFetch:ms,cMapUrl:y,iccUrl:_,standardFontDataUrl:C,wasmUrl:E}},ig={ownerDocument:W,pdfBug:me,styleElement:oi,loadingParams:{disableAutoFetch:H,enableXfa:$}};return c.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const Va=c.messageHandler.sendWithPromise("GetDocRequest",eg,s?[s.buffer]:null);let pc;if(l)pc=new tm(l,{disableRange:mt,disableStream:O});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let _r;if($t)if(Cr(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");_r=Du}else _r=fm;else _r=Cr(i)?Du:lm;pc=new _r({url:i,length:vt,httpHeaders:n,withCredentials:a,rangeChunkSize:h,disableRange:mt,disableStream:O})}return Va.then(_r=>{if(t.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const fu=new Ja(e,_r,c.port),sg=new Pm(fu,t,pc,ig,yt);t._transport=sg,fu.send("Ready",null)})}).catch(t._capability.reject),t}function Am(d){if(d instanceof URL)return d.href;if(typeof d=="string"){if($t)return d;const t=URL.parse(d,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function xm(d){if($t&&typeof Buffer<"u"&&d instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength)return d;if(typeof d=="string")return Ul(d);if(d instanceof ArrayBuffer||ArrayBuffer.isView(d)||typeof d=="object"&&!isNaN(d==null?void 0:d.length))return new Uint8Array(d);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Kl(d){if(typeof d!="string")return null;if(d.endsWith("/"))return d;throw new Error(`Invalid factory url: "${d}" must include trailing slash.`)}const id=d=>typeof d=="object"&&Number.isInteger(d==null?void 0:d.num)&&d.num>=0&&Number.isInteger(d==null?void 0:d.gen)&&d.gen>=0,vm=d=>typeof d=="object"&&typeof(d==null?void 0:d.name)=="string",Sm=wg.bind(null,id,vm);var Kh;const Qh=class Qh{constructor(){N(this,"_capability",Promise.withResolvers());N(this,"_transport",null);N(this,"_worker",null);N(this,"docId",`d${ie(Qh,Kh)._++}`);N(this,"destroyed",!1);N(this,"onPassword",null);N(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var t,e,i,s;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(n){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,n}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};Kh=new WeakMap,b(Qh,Kh,0);let sd=Qh;class Xf{constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const i of this._rangeListeners)i(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){at("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class _m{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return K(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var qi,Hn,no;class Em{constructor(t,e,i,s=!1){b(this,Hn);b(this,qi,!1);this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new yu:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new Yf,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:n=!1}={}){return new zl({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:n})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return K(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:s=bs.ENABLE,transform:n=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:h=null,printAnnotationStorage:c=null,isEditing:f=!1}){var u,m;(u=this._stats)==null||u.time("Overall");const p=this._transport.getRenderingIntent(i,s,c,f),{renderingIntent:y,cacheKey:v}=p;g(this,qi,!1),o||(o=this._transport.getOptionalContentConfig(y));let A=this._intentStates.get(v);A||(A=Object.create(null),this._intentStates.set(v,A)),A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null);const _=!!(y&Ie.PRINT);A.displayReadyCapability||(A.displayReadyCapability=Promise.withResolvers(),A.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(m=this._stats)==null||m.time("Page Request"),this._pumpOperatorList(p));const C=x=>{var S;A.renderTasks.delete(T),_&&g(this,qi,!0),w(this,Hn,no).call(this),x?(T.capability.reject(x),this._abortOperatorList({intentState:A,reason:x instanceof Error?x:new Error(x)})):T.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(S=globalThis.Stats)!=null&&S.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},T=new rd({callback:C,params:{canvasContext:t,viewport:e,transform:n,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:A.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:h});(A.renderTasks||(A.renderTasks=new Set)).add(T);const E=T.task;return Promise.all([A.displayReadyCapability.promise,o]).then(([x,S])=>{var P;if(this.destroyed){C();return}if((P=this._stats)==null||P.time("Rendering"),!(S.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");T.initializeGraphics({transparency:x,optionalContentConfig:S}),T.operatorListChanged()}).catch(C),E}getOperatorList({intent:t="display",annotationMode:e=bs.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var h;function n(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(t,e,i,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=n,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>mo.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){function n(){a.read().then(function({value:l,done:h}){if(h){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),n()},s)}const a=e.getReader(),o={items:[],styles:Object.create(null),lang:null};n()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),g(this,qi,!1),Promise.all(t)}cleanup(t=!1){g(this,qi,!0);const e=w(this,Hn,no).call(this);return t&&e&&this._stats&&(this._stats=new yu),e}_startRenderPage(t,e){var s,n;const i=this._intentStates.get(e);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(n=i.displayReadyCapability)==null||n.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&w(this,Hn,no).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:s}){const{map:n,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:n,modifiedIds:s},a).getReader(),h=this._intentStates.get(e);h.streamReader=l;const c=()=>{l.read().then(({value:f,done:p})=>{if(p){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,h),c())},f=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const p of h.renderTasks)p.operatorListChanged();w(this,Hn,no).call(this)}if(h.displayReadyCapability)h.displayReadyCapability.reject(f);else if(h.opListReadCapability)h.opListReadCapability.reject(f);else throw f}})};c()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof Xd){let s=bm;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new en(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,n]of this._intentStates)if(n===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}qi=new WeakMap,Hn=new WeakSet,no=function(){if(!r(this,qi)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),g(this,qi,!1),!0};var Xi,Jh;class Cm{constructor(){b(this,Xi,new Map);b(this,Jh,Promise.resolve())}postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};r(this,Jh).then(()=>{for(const[s]of r(this,Xi))s.call(this,i)})}addEventListener(t,e,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:n}=i;if(n.aborted){q("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);s=()=>n.removeEventListener("abort",a),n.addEventListener("abort",a)}r(this,Xi).set(e,s)}removeEventListener(t,e){const i=r(this,Xi).get(e);i==null||i(),r(this,Xi).delete(e)}terminate(){for(const[,t]of r(this,Xi))t==null||t();r(this,Xi).clear()}}Xi=new WeakMap,Jh=new WeakMap;var tc,zn,Vn,ca,fh,da,ph;const ct=class ct{constructor({name:t=null,port:e=null,verbosity:i=cg()}={}){b(this,ca);var s;if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((s=r(ct,Vn))!=null&&s.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(r(ct,Vn)||g(ct,Vn,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Ja("main","worker",t),this._messageHandler.on("ready",function(){}),w(this,ca,fh).call(this)}_initialize(){if(r(ct,zn)||r(ct,da,ph)){this._setupFakeWorker();return}let{workerSrc:t}=ct;try{ct._isSameOrigin(window.location,t)||(t=ct._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Ja("main","worker",e),s=()=>{n.abort(),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=new AbortController;e.addEventListener("error",()=>{this._webWorker||s()},{signal:n.signal}),i.on("test",o=>{if(n.abort(),this.destroyed||!o){s();return}this._messageHandler=i,this._port=e,this._webWorker=e,w(this,ca,fh).call(this)}),i.on("ready",o=>{if(n.abort(),this.destroyed){s();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{cc("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){r(ct,zn)||(q("Setting up fake worker."),g(ct,zn,!0)),ct._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new Cm;this._port=e;const i=`fake${ie(ct,tc)._++}`,s=new Ja(i+"_worker",i,e);t.setup(s,e),this._messageHandler=new Ja(i,i+"_worker",e),w(this,ca,fh).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t,e,i;this.destroyed=!0,(t=this._webWorker)==null||t.terminate(),this._webWorker=null,(e=r(ct,Vn))==null||e.delete(this._port),this._port=null,(i=this._messageHandler)==null||i.destroy(),this._messageHandler=null}static fromPort(t){var i;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(i=r(this,Vn))==null?void 0:i.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new ct(t)}static get workerSrc(){if(hs.workerSrc)return hs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return K(this,"_setupFakeWorkerGlobal",(async()=>r(this,da,ph)?r(this,da,ph):(await import(this.workerSrc)).WorkerMessageHandler)())}};tc=new WeakMap,zn=new WeakMap,Vn=new WeakMap,ca=new WeakSet,fh=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},da=new WeakSet,ph=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},b(ct,da),b(ct,tc,0),b(ct,zn,!1),b(ct,Vn),$t&&(g(ct,zn,!0),hs.workerSrc||(hs.workerSrc="./pdf.worker.mjs")),ct._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const s=new URL(e,i);return i.origin===s.origin},ct._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let Fr=ct;var Yi,Ai,ua,fa,Zi,$n,ro;class Pm{constructor(t,e,i,s,n){b(this,$n);b(this,Yi,new Map);b(this,Ai,new Map);b(this,ua,new Map);b(this,fa,new Map);b(this,Zi,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Yf,this.fontLoader=new Mg({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.wasmFactory=n.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return K(this,"annotationStorage",new Jd)}getRenderingIntent(t,e=bs.ENABLE,i=null,s=!1,n=!1){let a=Ie.DISPLAY,o=Wc;switch(t){case"any":a=Ie.ANY;break;case"display":break;case"print":a=Ie.PRINT;break;default:q(`getRenderingIntent - invalid intent: ${t}`)}const l=a&Ie.PRINT&&i instanceof Tf?i:this.annotationStorage;switch(e){case bs.DISABLE:a+=Ie.ANNOTATIONS_DISABLE;break;case bs.ENABLE:break;case bs.ENABLE_FORMS:a+=Ie.ANNOTATIONS_FORMS;break;case bs.ENABLE_STORAGE:a+=Ie.ANNOTATIONS_STORAGE,o=l.serializable;break;default:q(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(a+=Ie.IS_EDITING),n&&(a+=Ie.OPLIST);const{ids:h,hash:c}=l.modifiedIds,f=[a,o.hash,c];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:h}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=r(this,Zi))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of r(this,Ai).values())t.push(s._destroy());r(this,Ai).clear(),r(this,ua).clear(),r(this,fa).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var s,n;this.commonObjs.clear(),this.fontLoader.clear(),r(this,Yi).clear(),this.filterFactory.destroy(),go.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new en("Worker was terminated.")),(n=this.messageHandler)==null||n.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{Ct(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},s.onPull=()=>{this._fullReader.read().then(function({value:n,done:a}){if(a){s.close();return}Ct(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{s.error(n)})},s.onCancel=n=>{this._fullReader.cancel(n),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async i=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:n,contentLength:a}=this._fullReader;return(!s||!n)&&(this._lastProgress&&((o=e.onProgress)==null||o.call(e,this._lastProgress)),this._fullReader.onProgress=l=>{var h;(h=e.onProgress)==null||h.call(e,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:n,contentLength:a}}),t.on("GetRangeReader",(i,s)=>{Ct(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(i.begin,i.end);if(!n){s.close();return}s.onPull=()=>{n.read().then(function({value:a,done:o}){if(o){s.close();return}Ct(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{n.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new _m(i,this))}),t.on("DocException",i=>{e._capability.reject(ce(i))}),t.on("PasswordRequest",i=>{g(this,Zi,Promise.withResolvers());try{if(!e.onPassword)throw ce(i);const s=n=>{n instanceof Error?r(this,Zi).reject(n):r(this,Zi).resolve({password:n})};e.onPassword(s,i.code)}catch(s){r(this,Zi).reject(s)}return r(this,Zi).promise}),t.on("DataLoaded",i=>{var s;(s=e.onProgress)==null||s.call(e,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;r(this,Ai).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,n])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in n){const c=n.error;q(`Error during font loading: ${c}`),this.commonObjs.resolve(i,c);break}const o=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(c,f)=>globalThis.FontInspector.fontAdded(c,f):null,l=new kg(n,o);this.fontLoader.bind(l).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(i,l)});break;case"CopyLocalImage":const{imageRef:h}=n;Ct(h,"The imageRef must be defined.");for(const c of r(this,Ai).values())for(const[,f]of c.objs)if((f==null?void 0:f.ref)===h)return f.dataLen?(this.commonObjs.resolve(i,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,n);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,n,a])=>{var l;if(this.destroyed)return;const o=r(this,Ai).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(n){case"Image":case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${n}`)}}}),t.on("DocProgress",i=>{var s;this.destroyed||(s=e.onProgress)==null||s.call(e,{loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&q("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((i=this._fullReader)==null?void 0:i.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=r(this,ua).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&r(this,fa).set(n.refStr,t);const a=new Em(e,n,this,this._params.pdfBug);return r(this,Ai).set(e,a),a});return r(this,ua).set(e,s),s}getPageIndex(t){return id(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return w(this,$n,ro).call(this,"GetFieldObjects")}hasJSActions(){return w(this,$n,ro).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return w(this,$n,ro).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return w(this,$n,ro).call(this,"GetOptionalContentConfig").then(e=>new Jg(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=r(this,Yi).get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>{var n,a;return{info:s[0],metadata:s[1]?new Kg(s[1]):null,contentDispositionFilename:((n=this._fullReader)==null?void 0:n.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return r(this,Yi).set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of r(this,Ai).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),r(this,Yi).clear(),this.filterFactory.destroy(!0),go.cleanup()}}cachedPageNumber(t){if(!id(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return r(this,fa).get(e)??null}}Yi=new WeakMap,Ai=new WeakMap,ua=new WeakMap,fa=new WeakMap,Zi=new WeakMap,$n=new WeakSet,ro=function(t,e=null){const i=r(this,Yi).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return r(this,Yi).set(t,s),s};const Wa=Symbol("INITIAL_DATA");var xe,nl,nd;class Yf{constructor(){b(this,nl);b(this,xe,Object.create(null))}get(t,e=null){if(e){const s=w(this,nl,nd).call(this,t);return s.promise.then(()=>e(s.data)),null}const i=r(this,xe)[t];if(!i||i.data===Wa)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=r(this,xe)[t];return!!e&&e.data!==Wa}delete(t){const e=r(this,xe)[t];return!e||e.data===Wa?!1:(delete r(this,xe)[t],!0)}resolve(t,e=null){const i=w(this,nl,nd).call(this,t);i.data=e,i.resolve()}clear(){var t;for(const e in r(this,xe)){const{data:i}=r(this,xe)[e];(t=i==null?void 0:i.bitmap)==null||t.close()}g(this,xe,Object.create(null))}*[Symbol.iterator](){for(const t in r(this,xe)){const{data:e}=r(this,xe)[t];e!==Wa&&(yield[t,e])}}}xe=new WeakMap,nl=new WeakSet,nd=function(t){var e;return(e=r(this,xe))[t]||(e[t]={...Promise.withResolvers(),data:Wa})};var Gs;class Tm{constructor(t){b(this,Gs,null);N(this,"onContinue",null);N(this,"onError",null);g(this,Gs,t)}get promise(){return r(this,Gs).capability.promise}cancel(t=0){r(this,Gs).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=r(this,Gs).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=r(this,Gs);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}Gs=new WeakMap;var Bs,Wn;const dn=class dn{constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:n,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:h,useRequestAnimationFrame:c=!1,pdfBug:f=!1,pageColors:p=null}){b(this,Bs,null);this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=h,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Tm(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var o,l;if(this.cancelled)return;if(this._canvas){if(r(dn,Wn).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r(dn,Wn).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:n,background:a}=this.params;this.gfx=new Or(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:n,viewport:s,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(t=null,e=0){var i,s,n;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),r(this,Bs)&&(window.cancelAnimationFrame(r(this,Bs)),g(this,Bs,null)),r(dn,Wn).delete(this._canvas),t||(t=new Xd(`Rendering cancelled, page ${this._pageIndex+1}`,e)),this.callback(t),(n=(s=this.task).onError)==null||n.call(s,t)}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?g(this,Bs,window.requestAnimationFrame(()=>{g(this,Bs,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),r(dn,Wn).delete(this._canvas),this.callback())))}};Bs=new WeakMap,Wn=new WeakMap,b(dn,Wn,new WeakSet);let rd=dn;const Mm="5.1.91",km="45cbe8bb0";function Ou(d){return Math.floor(Math.max(0,Math.min(1,d))*255).toString(16).padStart(2,"0")}function ja(d){return Math.max(0,Math.min(255,255*d))}class Fu{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=ja(t),[t,t,t]}static G_HTML([t]){const e=Ou(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(ja)}static RGB_HTML(t){return`#${t.map(Ou).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[ja(1-Math.min(1,t+s)),ja(1-Math.min(1,i+s)),ja(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,n=1-e,a=1-i,o=Math.min(s,n,a);return["CMYK",s,n,a,o]}}class Im{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){at("Abstract method `_createSVG` called.")}}class Fh extends Im{_createSVG(t){return document.createElementNS(Ii,t)}}class Zf{static setupStorage(t,e,i,s,n){const a=s.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),n==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),n==="print")break;t.addEventListener("change",o=>{s.setValue(e,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),n==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const l=o.target.options,h=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(e,{value:h})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:n}){const{attributes:a}=e,o=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,h]of Object.entries(a))if(h!=null)switch(l){case"class":h.length&&t.setAttribute(l,h.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",h);break;case"style":Object.assign(t.style,h);break;case"textContent":t.textContent=h;break;default:(!o||l!=="href"&&l!=="newWindow")&&t.setAttribute(l,h)}o&&n.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){var f,p;const e=t.annotationStorage,i=t.linkService,s=t.xfaHtml,n=t.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:n,linkService:i});const o=n!=="richText",l=t.div;if(l.append(a),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=y}o&&l.setAttribute("class","xfaLayer xfaFont");const h=[];if(s.children.length===0){if(s.value){const y=document.createTextNode(s.value);a.append(y),o&&mo.shouldBuildText(s.name)&&h.push(y)}return{textDivs:h}}const c=[[s,-1,a]];for(;c.length>0;){const[y,v,A]=c.at(-1);if(v+1===y.children.length){c.pop();continue}const _=y.children[++c.at(-1)[1]];if(_===null)continue;const{name:C}=_;if(C==="#text"){const E=document.createTextNode(_.value);h.push(E),A.append(E);continue}const T=(f=_==null?void 0:_.attributes)!=null&&f.xmlns?document.createElementNS(_.attributes.xmlns,C):document.createElement(C);if(A.append(T),_.attributes&&this.setAttributes({html:T,element:_,storage:e,intent:n,linkService:i}),((p=_.children)==null?void 0:p.length)>0)c.push([_,-1,T]);else if(_.value){const E=document.createTextNode(_.value);o&&mo.shouldBuildText(C)&&h.push(E),T.append(E)}}for(const y of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:h}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Wl=1e3,Rm=9,Ar=new WeakSet;class Nu{static create(t){switch(t.data.annotationType){case _t.LINK:return new Kf(t);case _t.TEXT:return new Dm(t);case _t.WIDGET:switch(t.data.fieldType){case"Tx":return new Lm(t);case"Btn":return t.data.radioButton?new tp(t):t.data.checkBox?new Fm(t):new Nm(t);case"Ch":return new Gm(t);case"Sig":return new Om(t)}return new vr(t);case _t.POPUP:return new od(t);case _t.FREETEXT:return new rp(t);case _t.LINE:return new Um(t);case _t.SQUARE:return new Hm(t);case _t.CIRCLE:return new zm(t);case _t.POLYLINE:return new ap(t);case _t.CARET:return new $m(t);case _t.INK:return new iu(t);case _t.POLYGON:return new Vm(t);case _t.HIGHLIGHT:return new op(t);case _t.UNDERLINE:return new Wm(t);case _t.SQUIGGLY:return new jm(t);case _t.STRIKEOUT:return new qm(t);case _t.STAMP:return new lp(t);case _t.FILEATTACHMENT:return new Xm(t);default:return new xt(t)}}}var jn,pa,ga,rl,ad;const du=class du{constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){b(this,rl);b(this,jn,null);b(this,pa,!1);b(this,ga,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t!=null&&t.str||e!=null&&e.str||i!=null&&i.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return du._hasPopupData(this.data)}updateEdited(t){var i;if(!this.container)return;r(this,jn)||g(this,jn,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&w(this,rl,ad).call(this,e),(i=r(this,ga))==null||i.popup.updateEdited(t)}resetEdited(){var t;r(this,jn)&&(w(this,rl,ad).call(this,r(this,jn).rect),(t=r(this,ga))==null||t.popup.resetEdited(),g(this,jn,null))}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",e.id),this instanceof vr||(n.tabIndex=Wl);const{style:a}=n;if(a.zIndex=this.parent.zIndex++,e.alternativeText&&(n.title=e.alternativeText),e.noRotate&&n.classList.add("norotate"),!e.rect||this instanceof od){const{rotation:A}=e;return!e.hasOwnCanvas&&A!==0&&this.setRotation(A,n),n}const{width:o,height:l}=this;if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const A=e.borderStyle.horizontalCornerRadius,_=e.borderStyle.verticalCornerRadius;if(A>0||_>0){const T=`calc(${A}px * var(--total-scale-factor)) / calc(${_}px * var(--total-scale-factor))`;a.borderRadius=T}else if(this instanceof tp){const T=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=T}switch(e.borderStyle.style){case Er.SOLID:a.borderStyle="solid";break;case Er.DASHED:a.borderStyle="dashed";break;case Er.BEVELED:q("Unimplemented border style: beveled");break;case Er.INSET:q("Unimplemented border style: inset");break;case Er.UNDERLINE:a.borderBottomStyle="solid";break}const C=e.borderColor||null;C?(g(this,pa,!0),a.borderColor=G.makeHexColor(C[0]|0,C[1]|0,C[2]|0)):a.borderWidth=0}const h=G.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:c,pageHeight:f,pageX:p,pageY:y}=s.rawDims;a.left=`${100*(h[0]-p)/c}%`,a.top=`${100*(h[1]-y)/f}%`;const{rotation:v}=e;return e.hasOwnCanvas||v===0?(a.width=`${100*o/c}%`,a.height=`${100*l/f}%`):this.setRotation(v,n),n}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:n,height:a}=this;t%180!==0&&([n,a]=[a,n]),e.style.width=`${100*n/i}%`,e.style.height=`${100*a/s}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const n=s.detail[e],a=n[0],o=n.slice(1);s.target.style[i]=Fu[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:Fu[`${a}_rgb`](o)})};return K(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail)){const n=t[s]||i[s];n==null||n(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,n]of Object.entries(e)){const a=i[s];if(a){const o={detail:{[s]:n},target:t};a(o),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,n]=this.data.rect.map(A=>Math.fround(A));if(t.length===8){const[A,_,C,T]=t.subarray(2,6);if(s===A&&n===_&&e===C&&i===T)return}const{style:a}=this.container;let o;if(r(this,pa)){const{borderColor:A,borderWidth:_}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const l=s-e,h=n-i,{svgFactory:c}=this,f=c.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const p=c.createElement("defs");f.append(p);const y=c.createElement("clipPath"),v=`clippath_${this.data.id}`;y.setAttribute("id",v),y.setAttribute("clipPathUnits","objectBoundingBox"),p.append(y);for(let A=2,_=t.length;A<_;A+=8){const C=t[A],T=t[A+1],E=t[A+2],u=t[A+3],m=c.createElement("rect"),x=(E-e)/l,S=(n-T)/h,P=(C-E)/l,M=(T-u)/h;m.setAttribute("x",x),m.setAttribute("y",S),m.setAttribute("width",P),m.setAttribute("height",M),y.append(m),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${x}" y="${S}" width="${P}" height="${M}"/>`)}r(this,pa)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${v})`}_createPopup(){const{data:t}=this,e=g(this,ga,new od({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){at("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:n,id:a,exportValues:o}of s){if(n===-1||a===e)continue;const l=typeof o=="string"?o:null,h=document.querySelector(`[data-element-id="${a}"]`);if(h&&!Ar.has(h)){q(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:h})}return i}for(const s of document.getElementsByName(t)){const{exportValue:n}=s,a=s.getAttribute("data-element-id");a!==e&&Ar.has(s)&&i.push({id:a,exportValue:n,domElement:s})}return i}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};jn=new WeakMap,pa=new WeakMap,ga=new WeakMap,rl=new WeakSet,ad=function(t){const{container:{style:e},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:n,pageHeight:a,pageX:o,pageY:l}}}}=this;i==null||i.splice(0,4,...t),e.left=`${100*(t[0]-o)/n}%`,e.top=`${100*(a-t[3]+l)/a}%`,s===0?(e.width=`${100*(t[2]-t[0])/n}%`,e.height=`${100*(t[3]-t[1])/a}%`):this.setRotation(s)};let xt=du;var Re,on,Qf,Jf;class Kf extends xt{constructor(e,i=null){super(e,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});b(this,Re);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let n=!1;return e.url?(i.addLinkAttributes(s,e.url,e.newWindow),n=!0):e.action?(this._bindNamedAction(s,e.action),n=!0):e.attachment?(w(this,Re,Qf).call(this,s,e.attachment,e.attachmentDest),n=!0):e.setOCGState?(w(this,Re,Jf).call(this,s,e.setOCGState),n=!0):e.dest?(this._bindLink(s,e.dest),n=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),n=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(s,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(s),this.container}_bindLink(e,i){e.href=this.linkService.getDestinationHash(i),e.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&w(this,Re,on).call(this)}_bindNamedAction(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(i),!1),w(this,Re,on).call(this)}_bindJSAction(e,i){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(i.actions)){const a=s.get(n);a&&(e[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:n}}),!1})}e.onclick||(e.onclick=()=>!1),w(this,Re,on).call(this)}_bindResetFormAction(e,i){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),w(this,Re,on).call(this),!this._fieldObjects){q('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{var f;s==null||s();const{fields:n,refs:a,include:o}=i,l=[];if(n.length!==0||a.length!==0){const p=new Set(a);for(const y of n){const v=this._fieldObjects[y]||[];for(const{id:A}of v)p.add(A)}for(const y of Object.values(this._fieldObjects))for(const v of y)p.has(v.id)===o&&l.push(v)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const h=this.annotationStorage,c=[];for(const p of l){const{id:y}=p;switch(c.push(y),p.type){case"text":{const A=p.defaultValue||"";h.setValue(y,{value:A});break}case"checkbox":case"radiobutton":{const A=p.defaultValue===p.exportValues;h.setValue(y,{value:A});break}case"combobox":case"listbox":{const A=p.defaultValue||"";h.setValue(y,{value:A});break}default:continue}const v=document.querySelector(`[data-element-id="${y}"]`);if(v){if(!Ar.has(v)){q(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}})),!1}}}Re=new WeakSet,on=function(){this.container.setAttribute("data-internal-link","")},Qf=function(e,i,s=null){e.href=this.linkService.getAnchorUrl(""),i.description&&(e.title=i.description),e.onclick=()=>{var n;return(n=this.downloadManager)==null||n.openOrDownloadData(i.content,i.filename,s),!1},w(this,Re,on).call(this)},Jf=function(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(i),!1),w(this,Re,on).call(this)};class Dm extends xt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class vr extends xt{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Xt.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,n){i.includes("mouse")?t.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{var o;if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}n&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a)}}))})}_setEventListeners(t,e,i,s){var n,a,o;for(const[l,h]of i)(h==="Action"||(n=this.data.actions)!=null&&n[h])&&((h==="Focus"||h==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,l,h,s),h==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(t,e,"blur","Blur",null):h==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":G.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||Rm,n=t.style;let a;const o=2,l=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-o),c=Math.round(h/(mc*s))||1,f=h/c;a=Math.min(s,l(f/mc))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(h/mc))}n.fontSize=`calc(${a}px * var(--total-scale-factor))`,n.color=G.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(n.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Lm extends vr{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,s){const n=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),n.setValue(a.id,{[s]:i})}render(){var s,n;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let o=a.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let h=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const c={userValue:o,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=h??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",h??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Ar.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=Wl,this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",p=>{t.setValue(e,{value:p.target.value}),this.setPropertyOnSiblings(i,"value",p.target.value,"value"),c.formattedValue=null}),i.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue??"";i.value=c.userValue=y,c.formattedValue=null});let f=p=>{const{formattedValue:y}=c;y!=null&&(p.target.value=y),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",y=>{var A;if(c.focused)return;const{target:v}=y;c.userValue&&(v.value=c.userValue),c.lastCommittedValue=v.value,c.commitKey=1,(A=this.data.actions)!=null&&A.Focus||(c.focused=!0)}),i.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const v={value(A){c.userValue=A.detail.value??"",t.setValue(e,{value:c.userValue.toString()}),A.target.value=c.userValue},formattedValue(A){const{formattedValue:_}=A.detail;c.formattedValue=_,_!=null&&A.target!==document.activeElement&&(A.target.value=_),t.setValue(e,{formattedValue:_})},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{var E;const{charLimit:_}=A.detail,{target:C}=A;if(_===0){C.removeAttribute("maxLength");return}C.setAttribute("maxLength",_);let T=c.userValue;!T||T.length<=_||(T=T.slice(0,_),C.value=c.userValue=T,t.setValue(e,{value:T}),(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:T,willCommit:!0,commitKey:1,selStart:C.selectionStart,selEnd:C.selectionEnd}}))}};this._dispatchEventFromSandbox(v,y)}),i.addEventListener("keydown",y=>{var _;c.commitKey=1;let v=-1;if(y.key==="Escape"?v=0:y.key==="Enter"&&!this.data.multiLine?v=2:y.key==="Tab"&&(c.commitKey=3),v===-1)return;const{value:A}=y.target;c.lastCommittedValue!==A&&(c.lastCommittedValue=A,c.userValue=A,(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:A,willCommit:!0,commitKey:v,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const p=f;f=null,i.addEventListener("blur",y=>{var A,_;if(!c.focused||!y.relatedTarget)return;(A=this.data.actions)!=null&&A.Blur||(c.focused=!1);const{value:v}=y.target;c.userValue=v,c.lastCommittedValue!==v&&((_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:v,willCommit:!0,commitKey:c.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}})),p(y)}),(n=this.data.actions)!=null&&n.Keystroke&&i.addEventListener("beforeinput",y=>{var m;c.lastCommittedValue=null;const{data:v,target:A}=y,{value:_,selectionStart:C,selectionEnd:T}=A;let E=C,u=T;switch(y.inputType){case"deleteWordBackward":{const x=_.substring(0,C).match(/\w*[^\w]*$/);x&&(E-=x[0].length);break}case"deleteWordForward":{const x=_.substring(C).match(/^[^\w]*\w*/);x&&(u+=x[0].length);break}case"deleteContentBackward":C===T&&(E-=1);break;case"deleteContentForward":C===T&&(u+=1);break}y.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,change:v||"",willCommit:!1,selStart:E,selEnd:u}})}),this._setEventListeners(i,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(f&&i.addEventListener("blur",f),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Om extends vr{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Fm extends vr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const n=document.createElement("input");return Ar.add(n),n.setAttribute("data-element-id",i),n.disabled=e.readOnly,this._setRequired(n,this.data.required),n.type="checkbox",n.name=e.fieldName,s&&n.setAttribute("checked",!0),n.setAttribute("exportValue",e.exportValue),n.tabIndex=Wl,n.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const h of this._getElementsByName(o,i)){const c=l&&h.exportValue===e.exportValue;h.domElement&&(h.domElement.checked=c),t.setValue(h.id,{value:c})}t.setValue(i,{value:l})}),n.addEventListener("resetform",a=>{const o=e.defaultFieldValue||"Off";a.target.checked=o===e.exportValue}),this.enableScripting&&this.hasJSActions&&(n.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",t.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class tp extends vr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const n=document.createElement("input");if(Ar.add(n),n.setAttribute("data-element-id",i),n.disabled=e.readOnly,this._setRequired(n,this.data.required),n.type="radio",n.name=e.fieldName,s&&n.setAttribute("checked",!0),n.tabIndex=Wl,n.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const h of this._getElementsByName(o,i))t.setValue(h.id,{value:!1});t.setValue(i,{value:l})}),n.addEventListener("resetform",a=>{const o=e.defaultFieldValue;a.target.checked=o!=null&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;n.addEventListener("updatefromsandbox",o=>{const l={value:h=>{const c=a===h.detail.value;for(const f of this._getElementsByName(h.target.name)){const p=c&&f.id===i;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Nm extends Kf{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class Gm extends vr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");Ar.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=Wl;let n=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",c=>{const f=this.data.defaultFieldValue;for(const p of s.options)p.selected=p.value===f});for(const c of this.data.options){const f=document.createElement("option");f.textContent=c.displayValue,f.value=c.exportValue,i.value.includes(c.exportValue)&&(f.setAttribute("selected",!0),n=!1),s.append(f)}let a=null;if(n){const c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),s.prepend(c),a=()=>{c.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=c=>{const f=c?"value":"textContent",{options:p,multiple:y}=s;return y?Array.prototype.filter.call(p,v=>v.selected).map(v=>v[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=o(!1);const h=c=>{const f=c.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",c=>{const f={value(p){a==null||a();const y=p.detail.value,v=new Set(Array.isArray(y)?y:[y]);for(const A of s.options)A.selected=v.has(A.value);t.setValue(e,{value:o(!0)}),l=o(!1)},multipleSelection(p){s.multiple=!0},remove(p){const y=s.options,v=p.detail.remove;y[v].selected=!1,s.remove(v),y.length>0&&Array.prototype.findIndex.call(y,_=>_.selected)===-1&&(y[0].selected=!0),t.setValue(e,{value:o(!0),items:h(p)}),l=o(!1)},clear(p){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),l=o(!1)},insert(p){const{index:y,displayValue:v,exportValue:A}=p.detail.insert,_=s.children[y],C=document.createElement("option");C.textContent=v,C.value=A,_?_.before(C):s.append(C),t.setValue(e,{value:o(!0),items:h(p)}),l=o(!1)},items(p){const{items:y}=p.detail;for(;s.length!==0;)s.remove(0);for(const v of y){const{displayValue:A,exportValue:_}=v,C=document.createElement("option");C.textContent=A,C.value=_,s.append(C)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:o(!0),items:h(p)}),l=o(!1)},indices(p){const y=new Set(p.detail.indices);for(const v of p.target.options)v.selected=y.has(v.index);t.setValue(e,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,c)}),s.addEventListener("input",c=>{var y;const f=o(!0),p=o(!1);t.setValue(e,{value:f}),c.preventDefault(),(y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:l,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):s.addEventListener("input",function(c){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class od extends xt{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:xt._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new Bm({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${qd}${i}`).join(",")),this.container}}var ma,ec,ic,ya,ba,bt,Ki,wa,al,ol,Aa,Qi,Ye,Ji,ll,ts,hl,qn,Xn,ot,gh,ld,ep,ip,sp,np,mh,yh,hd;class Bm{constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:n,contentsObj:a,richText:o,parent:l,rect:h,parentRect:c,open:f}){b(this,ot);b(this,ma,w(this,ot,sp).bind(this));b(this,ec,w(this,ot,hd).bind(this));b(this,ic,w(this,ot,yh).bind(this));b(this,ya,w(this,ot,mh).bind(this));b(this,ba,null);b(this,bt,null);b(this,Ki,null);b(this,wa,null);b(this,al,null);b(this,ol,null);b(this,Aa,null);b(this,Qi,!1);b(this,Ye,null);b(this,Ji,null);b(this,ll,null);b(this,ts,null);b(this,hl,null);b(this,qn,null);b(this,Xn,!1);var p;g(this,bt,t),g(this,hl,s),g(this,Ki,a),g(this,ts,o),g(this,ol,l),g(this,ba,e),g(this,ll,h),g(this,Aa,c),g(this,al,i),g(this,wa,Zd.toDateObject(n)),this.trigger=i.flatMap(y=>y.getElementsToTriggerPopup());for(const y of this.trigger)y.addEventListener("click",r(this,ya)),y.addEventListener("mouseenter",r(this,ic)),y.addEventListener("mouseleave",r(this,ec)),y.classList.add("popupTriggerArea");for(const y of i)(p=y.container)==null||p.addEventListener("keydown",r(this,ma));r(this,bt).hidden=!0,f&&w(this,ot,mh).call(this)}render(){if(r(this,Ye))return;const t=g(this,Ye,document.createElement("div"));if(t.className="popup",r(this,ba)){const n=t.style.outlineColor=G.makeHexColor(...r(this,ba));t.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),{dir:i.dir,str:i.textContent}=r(this,hl),t.append(e),r(this,wa)){const n=document.createElement("span");n.classList.add("popupDate"),n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:r(this,wa).valueOf()})),e.append(n)}const s=r(this,ot,gh);if(s)Zf.render({xfaHtml:s,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const n=this._formatContents(r(this,Ki));t.append(n)}r(this,bt).append(t)}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let n=0,a=s.length;n<a;++n){const o=s[n];i.append(document.createTextNode(o)),n<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:t,popupContent:e}){var i;r(this,qn)||g(this,qn,{contentsObj:r(this,Ki),richText:r(this,ts)}),t&&g(this,Ji,null),e&&(g(this,ts,w(this,ot,ip).call(this,e)),g(this,Ki,null)),(i=r(this,Ye))==null||i.remove(),g(this,Ye,null)}resetEdited(){var t;r(this,qn)&&({contentsObj:ie(this,Ki)._,richText:ie(this,ts)._}=r(this,qn),g(this,qn,null),(t=r(this,Ye))==null||t.remove(),g(this,Ye,null),g(this,Ji,null))}forceHide(){g(this,Xn,this.isVisible),r(this,Xn)&&(r(this,bt).hidden=!0)}maybeShow(){r(this,Xn)&&(r(this,Ye)||w(this,ot,yh).call(this),g(this,Xn,!1),r(this,bt).hidden=!1)}get isVisible(){return r(this,bt).hidden===!1}}ma=new WeakMap,ec=new WeakMap,ic=new WeakMap,ya=new WeakMap,ba=new WeakMap,bt=new WeakMap,Ki=new WeakMap,wa=new WeakMap,al=new WeakMap,ol=new WeakMap,Aa=new WeakMap,Qi=new WeakMap,Ye=new WeakMap,Ji=new WeakMap,ll=new WeakMap,ts=new WeakMap,hl=new WeakMap,qn=new WeakMap,Xn=new WeakMap,ot=new WeakSet,gh=function(){const t=r(this,ts),e=r(this,Ki);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&r(this,ts).html||null},ld=function(){var t,e,i;return((i=(e=(t=r(this,ot,gh))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.fontSize)||0},ep=function(){var t,e,i;return((i=(e=(t=r(this,ot,gh))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.color)||null},ip=function(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:r(this,ot,ep),fontSize:r(this,ot,ld)?`calc(${r(this,ot,ld)}px * var(--total-scale-factor))`:""}};for(const n of t.split(`
`))e.push({name:"span",value:n,attributes:s});return i},sp=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&r(this,Qi))&&w(this,ot,mh).call(this)},np=function(){if(r(this,Ji)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:s,pageY:n}}}=r(this,ol);let a=!!r(this,Aa),o=a?r(this,Aa):r(this,ll);for(const v of r(this,al))if(!o||G.intersect(v.data.rect,o)!==null){o=v.data.rect,a=!0;break}const l=G.normalizeRect([o[0],t[3]-o[1]+t[1],o[2],t[3]-o[3]+t[1]]),c=a?o[2]-o[0]+5:0,f=l[0]+c,p=l[1];g(this,Ji,[100*(f-s)/e,100*(p-n)/i]);const{style:y}=r(this,bt);y.left=`${r(this,Ji)[0]}%`,y.top=`${r(this,Ji)[1]}%`},mh=function(){g(this,Qi,!r(this,Qi)),r(this,Qi)?(w(this,ot,yh).call(this),r(this,bt).addEventListener("click",r(this,ya)),r(this,bt).addEventListener("keydown",r(this,ma))):(w(this,ot,hd).call(this),r(this,bt).removeEventListener("click",r(this,ya)),r(this,bt).removeEventListener("keydown",r(this,ma)))},yh=function(){r(this,Ye)||this.render(),this.isVisible?r(this,Qi)&&r(this,bt).classList.add("focused"):(w(this,ot,np).call(this),r(this,bt).hidden=!1,r(this,bt).style.zIndex=parseInt(r(this,bt).style.zIndex)+1e3)},hd=function(){r(this,bt).classList.remove("focused"),!(r(this,Qi)||!this.isVisible)&&(r(this,bt).hidden=!0,r(this,bt).style.zIndex=parseInt(r(this,bt).style.zIndex)-1e3)};class rp extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=j.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var cl;class Um extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,cl,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:i,height:s}=this,n=this.svgFactory.create(i,s,!0),a=g(this,cl,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,cl)}addHighlightArea(){this.container.classList.add("highlightArea")}}cl=new WeakMap;var dl;class Hm extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,dl,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:i,height:s}=this,n=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=g(this,dl,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,dl)}addHighlightArea(){this.container.classList.add("highlightArea")}}dl=new WeakMap;var ul;class zm extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,ul,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:i,height:s}=this,n=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=g(this,ul,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,ul)}addHighlightArea(){this.container.classList.add("highlightArea")}}ul=new WeakMap;var fl;class ap extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,fl,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:i,borderStyle:s,popupRef:n},width:a,height:o}=this;if(!i)return this.container;const l=this.svgFactory.create(a,o,!0);let h=[];for(let f=0,p=i.length;f<p;f+=2){const y=i[f]-e[0],v=e[3]-i[f+1];h.push(`${y},${v}`)}h=h.join(" ");const c=g(this,fl,this.svgFactory.createElement(this.svgElementName));return c.setAttribute("points",h),c.setAttribute("stroke-width",s.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),l.append(c),this.container.append(l),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,fl)}addHighlightArea(){this.container.classList.add("highlightArea")}}fl=new WeakMap;class Vm extends ap{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $m extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var pl,Yn,gl,cd;class iu extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,gl);b(this,pl,null);b(this,Yn,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?j.HIGHLIGHT:j.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:i,inkLists:s,borderStyle:n,popupRef:a}}=this,{transform:o,width:l,height:h}=w(this,gl,cd).call(this,i,e),c=this.svgFactory.create(l,h,!0),f=g(this,pl,this.svgFactory.createElement("svg:g"));c.append(f),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,y=s.length;p<y;p++){const v=this.svgFactory.createElement(this.svgElementName);r(this,Yn).push(v),v.setAttribute("points",s[p].join(",")),f.append(v)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:i,points:s,rect:n}=e,a=r(this,pl);if(i>=0&&a.setAttribute("stroke-width",i||1),s)for(let o=0,l=r(this,Yn).length;o<l;o++)r(this,Yn)[o].setAttribute("points",s[o].join(","));if(n){const{transform:o,width:l,height:h}=w(this,gl,cd).call(this,this.data.rotation,n);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${h}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return r(this,Yn)}addHighlightArea(){this.container.classList.add("highlightArea")}}pl=new WeakMap,Yn=new WeakMap,gl=new WeakSet,cd=function(e,i){switch(e){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class op extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=j.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Wm extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class jm extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class qm extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class lp extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=j.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ml,yl,dd;class Xm extends xt{constructor(e){var s;super(e,{isRenderable:!0});b(this,yl);b(this,ml,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",w(this,yl,dd).bind(this)),g(this,ml,s);const{isMac:n}=Xt.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(n?a.metaKey:a.ctrlKey)&&w(this,yl,dd).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return r(this,ml)}addHighlightArea(){this.container.classList.add("highlightArea")}}ml=new WeakMap,yl=new WeakSet,dd=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var bl,Zn,Us,wl,an,fd,pd;const uu=class uu{constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:s,page:n,viewport:a,structTreeLayer:o}){b(this,an);b(this,bl,null);b(this,Zn,null);b(this,Us,new Map);b(this,wl,null);this.div=t,g(this,bl,e),g(this,Zn,i),g(this,wl,o||null),this.page=n,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return r(this,Us).size>0}async render(t){var a;const{annotations:e}=t,i=this.div;br(i,this.viewport);const s=new Map,n={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Fh,annotationStorage:t.annotationStorage||new Jd,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const l=o.annotationType===_t.POPUP;if(l){const f=s.get(o.id);if(!f)continue;n.elements=f}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;n.data=o;const h=Nu.create(n);if(!h.isRenderable)continue;if(!l&&o.popupRef){const f=s.get(o.popupRef);f?f.push(h):s.set(o.popupRef,[h])}const c=h.render();o.hidden&&(c.style.visibility="hidden"),await w(this,an,fd).call(this,c,o.id),h._isEditable&&(r(this,Us).set(h.data.id,h),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(h))}w(this,an,pd).call(this)}async addLinkAnnotations(t,e){const i={data:null,layer:this.div,linkService:e,svgFactory:new Fh,parent:this};for(const s of t){s.borderStyle||(s.borderStyle=uu._defaultBorderStyle),i.data=s;const n=Nu.create(i);if(!n.isRenderable)continue;const a=n.render();await w(this,an,fd).call(this,a,s.id)}}update({viewport:t}){const e=this.div;this.viewport=t,br(e,{rotation:t.rotation}),w(this,an,pd).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(r(this,Us).values())}getEditableAnnotation(t){return r(this,Us).get(t)}static get _defaultBorderStyle(){return K(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Er.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};bl=new WeakMap,Zn=new WeakMap,Us=new WeakMap,wl=new WeakMap,an=new WeakSet,fd=async function(t,e){var a,o;const i=t.firstChild||t,s=i.id=`${qd}${e}`,n=await((a=r(this,wl))==null?void 0:a.getAriaAttributes(s));if(n)for(const[l,h]of n)i.setAttribute(l,h);this.div.append(t),(o=r(this,bl))==null||o.moveElementInDOM(this.div,t,i,!1)},pd=function(){var e;if(!r(this,Zn))return;const t=this.div;for(const[i,s]of r(this,Zn)){const n=t.querySelector(`[data-annotation-id="${i}"]`);if(!n)continue;s.className="annotationContent";const{firstChild:a}=n;a?a.nodeName==="CANVAS"?a.replaceWith(s):a.classList.contains("annotationContent")?a.after(s):a.before(s):n.append(s);const o=r(this,Us).get(i);o&&(o._hasNoCanvas?((e=this._annotationEditorUIManager)==null||e.setMissingCanvas(i,n.id,s),o._hasNoCanvas=!1):o.canvas=s)}r(this,Zn).clear()};let ud=uu;const Ql=/\r\n?|\n/g;var Ze,ve,Al,Kn,Se,Pt,hp,cp,dp,bh,fs,wh,Ah,up,md,fp;const lt=class lt extends pt{constructor(e){super({...e,name:"freeTextEditor"});b(this,Pt);b(this,Ze);b(this,ve,"");b(this,Al,`${this.id}-editor`);b(this,Kn,null);b(this,Se);g(this,Ze,e.color||lt._defaultColor||pt._defaultLineColor),g(this,Se,e.fontSize||lt._defaultFontSize)}static get _keyboardManager(){const e=lt.prototype,i=a=>a.isEmpty(),s=wr.TRANSLATE_SMALL,n=wr.TRANSLATE_BIG;return K(this,"_keyboardManager",new Vl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:i}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[n,0],checker:i}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:i}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,n],checker:i}]]))}static initialize(e,i){pt.initialize(e,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,i){switch(e){case Q.FREETEXT_SIZE:lt._defaultFontSize=i;break;case Q.FREETEXT_COLOR:lt._defaultColor=i;break}}updateParams(e,i){switch(e){case Q.FREETEXT_SIZE:w(this,Pt,hp).call(this,i);break;case Q.FREETEXT_COLOR:w(this,Pt,cp).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Q.FREETEXT_SIZE,lt._defaultFontSize],[Q.FREETEXT_COLOR,lt._defaultColor||pt._defaultLineColor]]}get propertiesToUpdate(){return[[Q.FREETEXT_SIZE,r(this,Se)],[Q.FREETEXT_COLOR,r(this,Ze)]]}_translateEmpty(e,i){this._uiManager.translateSelectedEditors(e,i,!0)}getInitialTranslation(){const e=this.parentScale;return[-lt._internalPadding*e,-(lt._internalPadding+r(this,Se))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(j.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),g(this,Kn,new AbortController);const e=this._uiManager.combinedSignal(r(this,Kn));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",r(this,Al)),this._isDraggable=!0,(e=r(this,Kn))==null||e.abort(),g(this,Kn,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var i;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=r(this,ve),i=g(this,ve,w(this,Pt,dp).call(this).trimEnd());if(e===i)return;const s=n=>{if(g(this,ve,n),!n){this.remove();return}w(this,Pt,Ah).call(this),this._uiManager.rebuild(this),w(this,Pt,bh).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(e)},mustExec:!1}),w(this,Pt,bh).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){lt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,i;(this._isCopy||this.annotationElementId)&&(e=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",r(this,Al)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${r(this,Se)}px * var(--total-scale-factor))`,s.color=r(this,Ze),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Qd(this,this.div,["dblclick","keydown"]),this._isCopy||this.annotationElementId){const[n,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,h]=this.getInitialTranslation();[l,h]=this.pageTranslationToScreen(l,h);const[c,f]=this.pageDimensions,[p,y]=this.pageTranslation;let v,A;switch(this.rotation){case 0:v=e+(o[0]-p)/c,A=i+this.height-(o[1]-y)/f;break;case 90:v=e+(o[0]-p)/c,A=i-(o[1]-y)/f,[l,h]=[h,-l];break;case 180:v=e-this.width+(o[0]-p)/c,A=i-(o[1]-y)/f,[l,h]=[-l,-h];break;case 270:v=e+(o[0]-p-this.height*f)/c,A=i+(o[1]-y-this.width*c)/f,[l,h]=[-h,l];break}this.setAt(v*n,A*a,l,h)}else this._moveAfterPaste(e,i);w(this,Pt,Ah).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var v,A,_;const i=e.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const n=w(v=lt,fs,md).call(v,i.getData("text")||"").replaceAll(Ql,`
`);if(!n)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!n.includes(`
`)){o.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:h}=o,c=[],f=[];if(l.nodeType===Node.TEXT_NODE){const C=l.parentElement;if(f.push(l.nodeValue.slice(h).replaceAll(Ql,"")),C!==this.editorDiv){let T=c;for(const E of this.editorDiv.childNodes){if(E===C){T=f;continue}T.push(w(A=lt,fs,wh).call(A,E))}}c.push(l.nodeValue.slice(0,h).replaceAll(Ql,""))}else if(l===this.editorDiv){let C=c,T=0;for(const E of this.editorDiv.childNodes)T++===h&&(C=f),C.push(w(_=lt,fs,wh).call(_,E))}g(this,ve,`${c.join(`
`)}${n}${f.join(`
`)}`),w(this,Pt,Ah).call(this);const p=new Range;let y=Math.sumPrecise(c.map(C=>C.length));for(const{firstChild:C}of this.editorDiv.childNodes)if(C.nodeType===Node.TEXT_NODE){const T=C.nodeValue.length;if(y<=T){p.setStart(C,y),p.setEnd(C,y);break}y-=T}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}static async deserialize(e,i,s){var o;let n=null;if(e instanceof rp){const{data:{defaultAppearanceData:{fontSize:l,fontColor:h},rect:c,rotation:f,id:p,popupRef:y},textContent:v,textPosition:A,parent:{page:{pageNumber:_}}}=e;if(!v||v.length===0)return null;n=e={annotationType:j.FREETEXT,color:Array.from(h),fontSize:l,value:v.join(`
`),position:A,pageIndex:_-1,rect:c.slice(0),rotation:f,id:p,deleted:!1,popupRef:y}}const a=await super.deserialize(e,i,s);return g(a,Se,e.fontSize),g(a,Ze,G.makeHexColor(...e.color)),g(a,ve,w(o=lt,fs,md).call(o,e.value)),a.annotationElementId=e.id||null,a._initialData=n,a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=lt._internalPadding*this.parentScale,s=this.getRect(i,i),n=pt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:r(this,Ze)),a={annotationType:j.FREETEXT,color:n,fontSize:r(this,Se),value:w(this,Pt,up).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(a.isCopy=!0,a):this.annotationElementId&&!w(this,Pt,fp).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(e){const i=super.renderAnnotationElement(e);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${r(this,Se)}px * var(--total-scale-factor))`,s.color=r(this,Ze),i.replaceChildren();for(const a of r(this,ve).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const n=lt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(n,n),popupContent:r(this,ve)}),i}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Ze=new WeakMap,ve=new WeakMap,Al=new WeakMap,Kn=new WeakMap,Se=new WeakMap,Pt=new WeakSet,hp=function(e){const i=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--total-scale-factor))`,this.translate(0,-(n-r(this,Se))*this.parentScale),g(this,Se,n),w(this,Pt,bh).call(this)},s=r(this,Se);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Q.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},cp=function(e){const i=n=>{g(this,Ze,this.editorDiv.style.color=n)},s=r(this,Ze);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Q.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},dp=function(){var s;const e=[];this.editorDiv.normalize();let i=null;for(const n of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(w(s=lt,fs,wh).call(s,n)),i=n);return e.join(`
`)},bh=function(){const[e,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:n,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",n.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/i):(this.width=s.height/e,this.height=s.width/i),this.fixAndSetPosition()},fs=new WeakSet,wh=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Ql,"")},Ah=function(){if(this.editorDiv.replaceChildren(),!!r(this,ve))for(const e of r(this,ve).split(`
`)){const i=document.createElement("div");i.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(i)}},up=function(){return r(this,ve).replaceAll(" "," ")},md=function(e){return e.replaceAll(" "," ")},fp=function(e){const{value:i,fontSize:s,color:n,pageIndex:a}=this._initialData;return this._hasBeenMoved||e.value!==i||e.fontSize!==s||e.color.some((o,l)=>o!==n[l])||e.pageIndex!==a},b(lt,fs),N(lt,"_freeTextDefaultContent",""),N(lt,"_internalPadding",0),N(lt,"_defaultColor",null),N(lt,"_defaultFontSize",10),N(lt,"_type","freetext"),N(lt,"_editorType",j.FREETEXT);let gd=lt;class L{toSVGPath(){at("Abstract method `toSVGPath` must be implemented.")}get box(){at("Abstract getter `box` must be implemented.")}serialize(t,e){at("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,s,n,a){a||(a=new Float32Array(t.length));for(let o=0,l=t.length;o<l;o+=2)a[o]=e+t[o]*s,a[o+1]=i+t[o+1]*n;return a}static _rescaleAndSwap(t,e,i,s,n,a){a||(a=new Float32Array(t.length));for(let o=0,l=t.length;o<l;o+=2)a[o]=e+t[o+1]*s,a[o+1]=i+t[o]*n;return a}static _translate(t,e,i,s){s||(s=new Float32Array(t.length));for(let n=0,a=t.length;n<a;n+=2)s[n]=e+t[n],s[n+1]=i+t[n+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,s,n){switch(n){case 90:return[1-e/i,t/s];case 180:return[1-t/i,1-e/s];case 270:return[e/i,1-t/s];default:return[t/i,e/s]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,s,n,a){return[(t+5*i)/6,(e+5*s)/6,(5*i+n)/6,(5*s+a)/6,(i+n)/2,(s+a)/2]}}N(L,"PRECISION",1e-4);var _e,Ke,xa,va,xi,Z,Qn,Jn,xl,vl,Sa,_a,Hs,Sl,sc,nc,Rt,ao,pp,gp,mp,yp,bp,wp;const Oi=class Oi{constructor({x:t,y:e},i,s,n,a,o=0){b(this,Rt);b(this,_e);b(this,Ke,[]);b(this,xa);b(this,va);b(this,xi,[]);b(this,Z,new Float32Array(18));b(this,Qn);b(this,Jn);b(this,xl);b(this,vl);b(this,Sa);b(this,_a);b(this,Hs,[]);g(this,_e,i),g(this,_a,n*s),g(this,va,a),r(this,Z).set([NaN,NaN,NaN,NaN,t,e],6),g(this,xa,o),g(this,vl,r(Oi,Sl)*s),g(this,xl,r(Oi,nc)*s),g(this,Sa,s),r(this,Hs).push(t,e)}isEmpty(){return isNaN(r(this,Z)[8])}add({x:t,y:e}){var M;g(this,Qn,t),g(this,Jn,e);const[i,s,n,a]=r(this,_e);let[o,l,h,c]=r(this,Z).subarray(8,12);const f=t-h,p=e-c,y=Math.hypot(f,p);if(y<r(this,xl))return!1;const v=y-r(this,vl),A=v/y,_=A*f,C=A*p;let T=o,E=l;o=h,l=c,h+=_,c+=C,(M=r(this,Hs))==null||M.push(t,e);const u=-C/v,m=_/v,x=u*r(this,_a),S=m*r(this,_a);return r(this,Z).set(r(this,Z).subarray(2,8),0),r(this,Z).set([h+x,c+S],4),r(this,Z).set(r(this,Z).subarray(14,18),12),r(this,Z).set([h-x,c-S],16),isNaN(r(this,Z)[6])?(r(this,xi).length===0&&(r(this,Z).set([o+x,l+S],2),r(this,xi).push(NaN,NaN,NaN,NaN,(o+x-i)/n,(l+S-s)/a),r(this,Z).set([o-x,l-S],14),r(this,Ke).push(NaN,NaN,NaN,NaN,(o-x-i)/n,(l-S-s)/a)),r(this,Z).set([T,E,o,l,h,c],6),!this.isEmpty()):(r(this,Z).set([T,E,o,l,h,c],6),Math.abs(Math.atan2(E-l,T-o)-Math.atan2(C,_))<Math.PI/2?([o,l,h,c]=r(this,Z).subarray(2,6),r(this,xi).push(NaN,NaN,NaN,NaN,((o+h)/2-i)/n,((l+c)/2-s)/a),[o,l,T,E]=r(this,Z).subarray(14,18),r(this,Ke).push(NaN,NaN,NaN,NaN,((T+o)/2-i)/n,((E+l)/2-s)/a),!0):([T,E,o,l,h,c]=r(this,Z).subarray(0,6),r(this,xi).push(((T+5*o)/6-i)/n,((E+5*l)/6-s)/a,((5*o+h)/6-i)/n,((5*l+c)/6-s)/a,((o+h)/2-i)/n,((l+c)/2-s)/a),[h,c,o,l,T,E]=r(this,Z).subarray(12,18),r(this,Ke).push(((T+5*o)/6-i)/n,((E+5*l)/6-s)/a,((5*o+h)/6-i)/n,((5*l+c)/6-s)/a,((o+h)/2-i)/n,((l+c)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=r(this,xi),e=r(this,Ke);if(isNaN(r(this,Z)[6])&&!this.isEmpty())return w(this,Rt,pp).call(this);const i=[];i.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);w(this,Rt,mp).call(this,i);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return w(this,Rt,gp).call(this,i),i.join(" ")}newFreeDrawOutline(t,e,i,s,n,a){return new Ap(t,e,i,s,n,a)}getOutlines(){var f;const t=r(this,xi),e=r(this,Ke),i=r(this,Z),[s,n,a,o]=r(this,_e),l=new Float32Array((((f=r(this,Hs))==null?void 0:f.length)??0)+2);for(let p=0,y=l.length-2;p<y;p+=2)l[p]=(r(this,Hs)[p]-s)/a,l[p+1]=(r(this,Hs)[p+1]-n)/o;if(l[l.length-2]=(r(this,Qn)-s)/a,l[l.length-1]=(r(this,Jn)-n)/o,isNaN(i[6])&&!this.isEmpty())return w(this,Rt,yp).call(this,l);const h=new Float32Array(r(this,xi).length+24+r(this,Ke).length);let c=t.length;for(let p=0;p<c;p+=2){if(isNaN(t[p])){h[p]=h[p+1]=NaN;continue}h[p]=t[p],h[p+1]=t[p+1]}c=w(this,Rt,wp).call(this,h,c);for(let p=e.length-6;p>=6;p-=6)for(let y=0;y<6;y+=2){if(isNaN(e[p+y])){h[c]=h[c+1]=NaN,c+=2;continue}h[c]=e[p+y],h[c+1]=e[p+y+1],c+=2}return w(this,Rt,bp).call(this,h,c),this.newFreeDrawOutline(h,l,r(this,_e),r(this,Sa),r(this,xa),r(this,va))}};_e=new WeakMap,Ke=new WeakMap,xa=new WeakMap,va=new WeakMap,xi=new WeakMap,Z=new WeakMap,Qn=new WeakMap,Jn=new WeakMap,xl=new WeakMap,vl=new WeakMap,Sa=new WeakMap,_a=new WeakMap,Hs=new WeakMap,Sl=new WeakMap,sc=new WeakMap,nc=new WeakMap,Rt=new WeakSet,ao=function(){const t=r(this,Z).subarray(4,6),e=r(this,Z).subarray(16,18),[i,s,n,a]=r(this,_e);return[(r(this,Qn)+(t[0]-e[0])/2-i)/n,(r(this,Jn)+(t[1]-e[1])/2-s)/a,(r(this,Qn)+(e[0]-t[0])/2-i)/n,(r(this,Jn)+(e[1]-t[1])/2-s)/a]},pp=function(){const[t,e,i,s]=r(this,_e),[n,a,o,l]=w(this,Rt,ao).call(this);return`M${(r(this,Z)[2]-t)/i} ${(r(this,Z)[3]-e)/s} L${(r(this,Z)[4]-t)/i} ${(r(this,Z)[5]-e)/s} L${n} ${a} L${o} ${l} L${(r(this,Z)[16]-t)/i} ${(r(this,Z)[17]-e)/s} L${(r(this,Z)[14]-t)/i} ${(r(this,Z)[15]-e)/s} Z`},gp=function(t){const e=r(this,Ke);t.push(`L${e[4]} ${e[5]} Z`)},mp=function(t){const[e,i,s,n]=r(this,_e),a=r(this,Z).subarray(4,6),o=r(this,Z).subarray(16,18),[l,h,c,f]=w(this,Rt,ao).call(this);t.push(`L${(a[0]-e)/s} ${(a[1]-i)/n} L${l} ${h} L${c} ${f} L${(o[0]-e)/s} ${(o[1]-i)/n}`)},yp=function(t){const e=r(this,Z),[i,s,n,a]=r(this,_e),[o,l,h,c]=w(this,Rt,ao).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(e[2]-i)/n,(e[3]-s)/a,NaN,NaN,NaN,NaN,(e[4]-i)/n,(e[5]-s)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,h,c,NaN,NaN,NaN,NaN,(e[16]-i)/n,(e[17]-s)/a,NaN,NaN,NaN,NaN,(e[14]-i)/n,(e[15]-s)/a],0),this.newFreeDrawOutline(f,t,r(this,_e),r(this,Sa),r(this,xa),r(this,va))},bp=function(t,e){const i=r(this,Ke);return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6},wp=function(t,e){const i=r(this,Z).subarray(4,6),s=r(this,Z).subarray(16,18),[n,a,o,l]=r(this,_e),[h,c,f,p]=w(this,Rt,ao).call(this);return t.set([NaN,NaN,NaN,NaN,(i[0]-n)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,h,c,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(s[0]-n)/o,(s[1]-a)/l],e),e+=24},b(Oi,Sl,8),b(Oi,sc,2),b(Oi,nc,r(Oi,Sl)+r(Oi,sc));let Nh=Oi;var Ea,tr,es,_l,Ee,El,At,rc,xp;class Ap extends L{constructor(e,i,s,n,a,o){super();b(this,rc);b(this,Ea);b(this,tr,new Float32Array(4));b(this,es);b(this,_l);b(this,Ee);b(this,El);b(this,At);g(this,At,e),g(this,Ee,i),g(this,Ea,s),g(this,El,n),g(this,es,a),g(this,_l,o),this.lastPoint=[NaN,NaN],w(this,rc,xp).call(this,o);const[l,h,c,f]=r(this,tr);for(let p=0,y=e.length;p<y;p+=2)e[p]=(e[p]-l)/c,e[p+1]=(e[p+1]-h)/f;for(let p=0,y=i.length;p<y;p+=2)i[p]=(i[p]-l)/c,i[p+1]=(i[p+1]-h)/f}toSVGPath(){const e=[`M${r(this,At)[4]} ${r(this,At)[5]}`];for(let i=6,s=r(this,At).length;i<s;i+=6){if(isNaN(r(this,At)[i])){e.push(`L${r(this,At)[i+4]} ${r(this,At)[i+5]}`);continue}e.push(`C${r(this,At)[i]} ${r(this,At)[i+1]} ${r(this,At)[i+2]} ${r(this,At)[i+3]} ${r(this,At)[i+4]} ${r(this,At)[i+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,i,s,n],a){const o=s-e,l=n-i;let h,c;switch(a){case 0:h=L._rescale(r(this,At),e,n,o,-l),c=L._rescale(r(this,Ee),e,n,o,-l);break;case 90:h=L._rescaleAndSwap(r(this,At),e,i,o,l),c=L._rescaleAndSwap(r(this,Ee),e,i,o,l);break;case 180:h=L._rescale(r(this,At),s,i,-o,l),c=L._rescale(r(this,Ee),s,i,-o,l);break;case 270:h=L._rescaleAndSwap(r(this,At),s,n,-o,-l),c=L._rescaleAndSwap(r(this,Ee),s,n,-o,-l);break}return{outline:Array.from(h),points:[Array.from(c)]}}get box(){return r(this,tr)}newOutliner(e,i,s,n,a,o=0){return new Nh(e,i,s,n,a,o)}getNewOutline(e,i){const[s,n,a,o]=r(this,tr),[l,h,c,f]=r(this,Ea),p=a*c,y=o*f,v=s*c+l,A=n*f+h,_=this.newOutliner({x:r(this,Ee)[0]*p+v,y:r(this,Ee)[1]*y+A},r(this,Ea),r(this,El),e,r(this,_l),i??r(this,es));for(let C=2;C<r(this,Ee).length;C+=2)_.add({x:r(this,Ee)[C]*p+v,y:r(this,Ee)[C+1]*y+A});return _.getOutlines()}}Ea=new WeakMap,tr=new WeakMap,es=new WeakMap,_l=new WeakMap,Ee=new WeakMap,El=new WeakMap,At=new WeakMap,rc=new WeakSet,xp=function(e){const i=r(this,At);let s=i[4],n=i[5];const a=[s,n,s,n];let o=s,l=n;const h=e?Math.max:Math.min;for(let f=6,p=i.length;f<p;f+=6){const y=i[f+4],v=i[f+5];if(isNaN(i[f]))G.pointBoundingBox(y,v,a),l<v?(o=y,l=v):l===v&&(o=h(o,y));else{const A=[1/0,1/0,-1/0,-1/0];G.bezierBoundingBox(s,n,...i.slice(f,f+6),A),G.rectBoundingBox(...A,a),l<A[3]?(o=A[2],l=A[3]):l===A[3]&&(o=h(o,A[2]))}s=y,n=v}const c=r(this,tr);c[0]=a[0]-r(this,es),c[1]=a[1]-r(this,es),c[2]=a[2]-a[0]+2*r(this,es),c[3]=a[3]-a[1]+2*r(this,es),this.lastPoint=[o,l]};var Cl,Pl,zs,Qe,he,vp,xh,Sp,_p,bd;class yd{constructor(t,e=0,i=0,s=!0){b(this,he);b(this,Cl);b(this,Pl);b(this,zs,[]);b(this,Qe,[]);const n=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:y,y:v,width:A,height:_}of t){const C=Math.floor((y-e)/a)*a,T=Math.ceil((y+A+e)/a)*a,E=Math.floor((v-e)/a)*a,u=Math.ceil((v+_+e)/a)*a,m=[C,E,u,!0],x=[T,E,u,!1];r(this,zs).push(m,x),G.rectBoundingBox(C,E,T,u,n)}const o=n[2]-n[0]+2*i,l=n[3]-n[1]+2*i,h=n[0]-i,c=n[1]-i,f=r(this,zs).at(s?-1:-2),p=[f[0],f[2]];for(const y of r(this,zs)){const[v,A,_]=y;y[0]=(v-h)/o,y[1]=(A-c)/l,y[2]=(_-c)/l}g(this,Cl,new Float32Array([h,c,o,l])),g(this,Pl,p)}getOutlines(){r(this,zs).sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of r(this,zs))e[3]?(t.push(...w(this,he,bd).call(this,e)),w(this,he,Sp).call(this,e)):(w(this,he,_p).call(this,e),t.push(...w(this,he,bd).call(this,e)));return w(this,he,vp).call(this,t)}}Cl=new WeakMap,Pl=new WeakMap,zs=new WeakMap,Qe=new WeakMap,he=new WeakSet,vp=function(t){const e=[],i=new Set;for(const a of t){const[o,l,h]=a;e.push([o,l,a],[o,h,a])}e.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=e.length;a<o;a+=2){const l=e[a][2],h=e[a+1][2];l.push(h),h.push(l),i.add(l),i.add(h)}const s=[];let n;for(;i.size>0;){const a=i.values().next().value;let[o,l,h,c,f]=a;i.delete(a);let p=o,y=l;for(n=[o,h],s.push(n);;){let v;if(i.has(c))v=c;else if(i.has(f))v=f;else break;i.delete(v),[o,l,h,c,f]=v,p!==o&&(n.push(p,y,o,y===l?l:h),p=o),y=y===l?h:l}n.push(p,y)}return new Ym(s,r(this,Cl),r(this,Pl))},xh=function(t){const e=r(this,Qe);let i=0,s=e.length-1;for(;i<=s;){const n=i+s>>1,a=e[n][0];if(a===t)return n;a<t?i=n+1:s=n-1}return s+1},Sp=function([,t,e]){const i=w(this,he,xh).call(this,t);r(this,Qe).splice(i,0,[t,e])},_p=function([,t,e]){const i=w(this,he,xh).call(this,t);for(let s=i;s<r(this,Qe).length;s++){const[n,a]=r(this,Qe)[s];if(n!==t)break;if(n===t&&a===e){r(this,Qe).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[n,a]=r(this,Qe)[s];if(n!==t)break;if(n===t&&a===e){r(this,Qe).splice(s,1);return}}},bd=function(t){const[e,i,s]=t,n=[[e,i,s]],a=w(this,he,xh).call(this,s);for(let o=0;o<a;o++){const[l,h]=r(this,Qe)[o];for(let c=0,f=n.length;c<f;c++){const[,p,y]=n[c];if(!(h<=p||y<=l)){if(p>=l){if(y>h)n[c][1]=h;else{if(f===1)return[];n.splice(c,1),c--,f--}continue}n[c][2]=l,y>h&&n.push([e,h,y])}}}return n};var Tl,Ca;class Ym extends L{constructor(e,i,s){super();b(this,Tl);b(this,Ca);g(this,Ca,e),g(this,Tl,i),this.lastPoint=s}toSVGPath(){const e=[];for(const i of r(this,Ca)){let[s,n]=i;e.push(`M${s} ${n}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===s?(e.push(`V${l}`),n=l):l===n&&(e.push(`H${o}`),s=o)}e.push("Z")}return e.join(" ")}serialize([e,i,s,n],a){const o=[],l=s-e,h=n-i;for(const c of r(this,Ca)){const f=new Array(c.length);for(let p=0;p<c.length;p+=2)f[p]=e+c[p]*l,f[p+1]=n-c[p+1]*h;o.push(f)}return o}get box(){return r(this,Tl)}get classNamesForOutlining(){return["highlightOutline"]}}Tl=new WeakMap,Ca=new WeakMap;class wd extends Nh{newFreeDrawOutline(t,e,i,s,n,a){return new Zm(t,e,i,s,n,a)}}class Zm extends Ap{newOutliner(t,e,i,s,n,a=0){return new wd(t,e,i,s,n,a)}}var Je,er,Pa,It,Ml,Ta,kl,Il,Vs,ti,Ma,Rl,rt,Ad,xd,vd,ln,Ep,ys;const de=class de{constructor({editor:t=null,uiManager:e=null}){b(this,rt);b(this,Je,null);b(this,er,null);b(this,Pa);b(this,It,null);b(this,Ml,!1);b(this,Ta,!1);b(this,kl,null);b(this,Il);b(this,Vs,null);b(this,ti,null);b(this,Ma);var i;t?(g(this,Ta,!1),g(this,Ma,Q.HIGHLIGHT_COLOR),g(this,kl,t)):(g(this,Ta,!0),g(this,Ma,Q.HIGHLIGHT_DEFAULT_COLOR)),g(this,ti,(t==null?void 0:t._uiManager)||e),g(this,Il,r(this,ti)._eventBus),g(this,Pa,(t==null?void 0:t.color)||((i=r(this,ti))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),r(de,Rl)||g(de,Rl,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return K(this,"_keyboardManager",new Vl([[["Escape","mac+Escape"],de.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],de.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],de.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],de.prototype._moveToPrevious],[["Home","mac+Home"],de.prototype._moveToBeginning],[["End","mac+End"],de.prototype._moveToEnd]]))}renderButton(){const t=g(this,Je,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=r(this,ti)._signal;t.addEventListener("click",w(this,rt,ln).bind(this),{signal:e}),t.addEventListener("keydown",w(this,rt,vd).bind(this),{signal:e});const i=g(this,er,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=r(this,Pa),t.append(i),t}renderMainDropdown(){const t=g(this,It,w(this,rt,Ad).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===r(this,Je)){w(this,rt,ln).call(this,t);return}const e=t.target.getAttribute("data-color");e&&w(this,rt,xd).call(this,e,t)}_moveToNext(t){var e,i;if(!r(this,rt,ys)){w(this,rt,ln).call(this,t);return}if(t.target===r(this,Je)){(e=r(this,It).firstChild)==null||e.focus();return}(i=t.target.nextSibling)==null||i.focus()}_moveToPrevious(t){var e,i;if(t.target===((e=r(this,It))==null?void 0:e.firstChild)||t.target===r(this,Je)){r(this,rt,ys)&&this._hideDropdownFromKeyboard();return}r(this,rt,ys)||w(this,rt,ln).call(this,t),(i=t.target.previousSibling)==null||i.focus()}_moveToBeginning(t){var e;if(!r(this,rt,ys)){w(this,rt,ln).call(this,t);return}(e=r(this,It).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!r(this,rt,ys)){w(this,rt,ln).call(this,t);return}(e=r(this,It).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=r(this,It))==null||t.classList.add("hidden"),(e=r(this,Vs))==null||e.abort(),g(this,Vs,null)}_hideDropdownFromKeyboard(){var t;if(!r(this,Ta)){if(!r(this,rt,ys)){(t=r(this,kl))==null||t.unselect();return}this.hideDropdown(),r(this,Je).focus({preventScroll:!0,focusVisible:r(this,Ml)})}}updateColor(t){if(r(this,er)&&(r(this,er).style.backgroundColor=t),!r(this,It))return;const e=r(this,ti).highlightColors.values();for(const i of r(this,It).children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=r(this,Je))==null||t.remove(),g(this,Je,null),g(this,er,null),(e=r(this,It))==null||e.remove(),g(this,It,null)}};Je=new WeakMap,er=new WeakMap,Pa=new WeakMap,It=new WeakMap,Ml=new WeakMap,Ta=new WeakMap,kl=new WeakMap,Il=new WeakMap,Vs=new WeakMap,ti=new WeakMap,Ma=new WeakMap,Rl=new WeakMap,rt=new WeakSet,Ad=function(){const t=document.createElement("div"),e=r(this,ti)._signal;t.addEventListener("contextmenu",ri,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of r(this,ti).highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",s),n.title=i,n.setAttribute("data-l10n-id",r(de,Rl)[i]);const a=document.createElement("span");n.append(a),a.className="swatch",a.style.backgroundColor=s,n.setAttribute("aria-selected",s===r(this,Pa)),n.addEventListener("click",w(this,rt,xd).bind(this,s),{signal:e}),t.append(n)}return t.addEventListener("keydown",w(this,rt,vd).bind(this),{signal:e}),t},xd=function(t,e){e.stopPropagation(),r(this,Il).dispatch("switchannotationeditorparams",{source:this,type:r(this,Ma),value:t})},vd=function(t){de._keyboardManager.exec(this,t)},ln=function(t){if(r(this,rt,ys)){this.hideDropdown();return}if(g(this,Ml,t.detail===0),r(this,Vs)||(g(this,Vs,new AbortController),window.addEventListener("pointerdown",w(this,rt,Ep).bind(this),{signal:r(this,ti).combinedSignal(r(this,Vs))})),r(this,It)){r(this,It).classList.remove("hidden");return}const e=g(this,It,w(this,rt,Ad).call(this));r(this,Je).append(e)},Ep=function(t){var e;(e=r(this,It))!=null&&e.contains(t.target)||this.hideDropdown()},ys=function(){return r(this,It)&&!r(this,It).classList.contains("hidden")},b(de,Rl,null);let Gh=de;var ka,Dl,is,ir,Ia,pe,Ll,Ol,sr,Be,Ce,zt,Ra,ss,te,Da,Ue,Fl,X,Sd,vh,Cp,Pp,Tp,_d,hn,Ve,Ir,Mp,Sh,oo,kp,Ip,Rp,Dp,Lp;const et=class et extends pt{constructor(e){super({...e,name:"highlightEditor"});b(this,X);b(this,ka,null);b(this,Dl,0);b(this,is);b(this,ir,null);b(this,Ia,null);b(this,pe,null);b(this,Ll,null);b(this,Ol,0);b(this,sr,null);b(this,Be,null);b(this,Ce,null);b(this,zt,!1);b(this,Ra,null);b(this,ss);b(this,te,null);b(this,Da,"");b(this,Ue);b(this,Fl,"");this.color=e.color||et._defaultColor,g(this,Ue,e.thickness||et._defaultThickness),g(this,ss,e.opacity||et._defaultOpacity),g(this,is,e.boxes||null),g(this,Fl,e.methodOfCreation||""),g(this,Da,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(g(this,zt,!0),w(this,X,vh).call(this,e),w(this,X,hn).call(this)):r(this,is)&&(g(this,ka,e.anchorNode),g(this,Dl,e.anchorOffset),g(this,Ll,e.focusNode),g(this,Ol,e.focusOffset),w(this,X,Sd).call(this),w(this,X,hn).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=et.prototype;return K(this,"_keyboardManager",new Vl([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:r(this,zt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:r(this,Ue),methodOfCreation:r(this,Fl)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,i){var s;pt.initialize(e,i),et._defaultColor||(et._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(e,i){switch(e){case Q.HIGHLIGHT_DEFAULT_COLOR:et._defaultColor=i;break;case Q.HIGHLIGHT_THICKNESS:et._defaultThickness=i;break}}translateInPage(e,i){}get toolbarPosition(){return r(this,Ra)}updateParams(e,i){switch(e){case Q.HIGHLIGHT_COLOR:w(this,X,Cp).call(this,i);break;case Q.HIGHLIGHT_THICKNESS:w(this,X,Pp).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Q.HIGHLIGHT_DEFAULT_COLOR,et._defaultColor],[Q.HIGHLIGHT_THICKNESS,et._defaultThickness]]}get propertiesToUpdate(){return[[Q.HIGHLIGHT_COLOR,this.color||et._defaultColor],[Q.HIGHLIGHT_THICKNESS,r(this,Ue)||et._defaultThickness],[Q.HIGHLIGHT_FREE,r(this,zt)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(g(this,Ia,new Gh({editor:this})),e.addColorPicker(r(this,Ia))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(w(this,X,oo).call(this))}getBaseTranslation(){return[0,0]}getRect(e,i){return super.getRect(e,i,w(this,X,oo).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){w(this,X,_d).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,X,hn).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var s;let i=!1;this.parent&&!e?w(this,X,_d).call(this):e&&(w(this,X,hn).call(this,e),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),i&&this.select()}rotate(e){var n,a,o;const{drawLayer:i}=this.parent;let s;r(this,zt)?(e=(e-this.rotation+360)%360,s=w(n=et,Ve,Ir).call(n,r(this,Be).box,e)):s=w(a=et,Ve,Ir).call(a,[this.x,this.y,this.width,this.height],e),i.updateProperties(r(this,Ce),{bbox:s,root:{"data-main-rotation":e}}),i.updateProperties(r(this,te),{bbox:w(o=et,Ve,Ir).call(o,r(this,pe).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();r(this,Da)&&(e.setAttribute("aria-label",r(this,Da)),e.setAttribute("role","mark")),r(this,zt)?e.classList.add("free"):this.div.addEventListener("keydown",w(this,X,Mp).bind(this),{signal:this._uiManager._signal});const i=g(this,sr,document.createElement("div"));e.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=r(this,ir);const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),Qd(this,r(this,sr),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(r(this,te),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(r(this,te),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:w(this,X,Sh).call(this,!0);break;case 1:case 3:w(this,X,Sh).call(this,!1);break}}select(){var e;super.select(),r(this,te)&&((e=this.parent)==null||e.drawLayer.updateProperties(r(this,te),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),r(this,te)&&((e=this.parent)==null||e.drawLayer.updateProperties(r(this,te),{rootClass:{selected:!1}}),r(this,zt)||w(this,X,Sh).call(this,!1))}get _mustFixPosition(){return!r(this,zt)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(r(this,Ce),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(r(this,te),{rootClass:{hidden:!e}}))}static startHighlighting(e,i,{target:s,x:n,y:a}){const{x:o,y:l,width:h,height:c}=s.getBoundingClientRect(),f=new AbortController,p=e.combinedSignal(f),y=v=>{f.abort(),w(this,Ve,Dp).call(this,e,v)};window.addEventListener("blur",y,{signal:p}),window.addEventListener("pointerup",y,{signal:p}),window.addEventListener("pointerdown",Et,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",ri,{signal:p}),s.addEventListener("pointermove",w(this,Ve,Rp).bind(this,e),{signal:p}),this._freeHighlight=new wd({x:n,y:a},[o,l,h,c],e.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,i,s){var A,_,C,T;let n=null;if(e instanceof op){const{data:{quadPoints:E,rect:u,rotation:m,id:x,color:S,opacity:P,popupRef:M},parent:{page:{pageNumber:I}}}=e;n=e={annotationType:j.HIGHLIGHT,color:Array.from(S),opacity:P,quadPoints:E,boxes:null,pageIndex:I-1,rect:u.slice(0),rotation:m,id:x,deleted:!1,popupRef:M}}else if(e instanceof iu){const{data:{inkLists:E,rect:u,rotation:m,id:x,color:S,borderStyle:{rawWidth:P},popupRef:M},parent:{page:{pageNumber:I}}}=e;n=e={annotationType:j.HIGHLIGHT,color:Array.from(S),thickness:P,inkLists:E,boxes:null,pageIndex:I-1,rect:u.slice(0),rotation:m,id:x,deleted:!1,popupRef:M}}const{color:a,quadPoints:o,inkLists:l,opacity:h}=e,c=await super.deserialize(e,i,s);c.color=G.makeHexColor(...a),g(c,ss,h||1),l&&g(c,Ue,e.thickness),c.annotationElementId=e.id||null,c._initialData=n;const[f,p]=c.pageDimensions,[y,v]=c.pageTranslation;if(o){const E=g(c,is,[]);for(let u=0;u<o.length;u+=8)E.push({x:(o[u]-y)/f,y:1-(o[u+1]-v)/p,width:(o[u+2]-o[u])/f,height:(o[u+1]-o[u+5])/p});w(A=c,X,Sd).call(A),w(_=c,X,hn).call(_),c.rotate(c.rotation)}else if(l){g(c,zt,!0);const E=l[0],u={x:E[0]-y,y:p-(E[1]-v)},m=new wd(u,[0,0,f,p],1,r(c,Ue)/2,!0,.001);for(let P=0,M=E.length;P<M;P+=2)u.x=E[P]-y,u.y=p-(E[P+1]-v),m.add(u);const{id:x,clipPathId:S}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:m.toSVGPath()}},!0,!0);w(C=c,X,vh).call(C,{highlightOutlines:m.getOutlines(),highlightId:x,clipPathId:S}),w(T=c,X,hn).call(T),c.rotate(c.parentRotation)}return c}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=pt._colorManager.convert(this.color),n={annotationType:j.HIGHLIGHT,color:s,opacity:r(this,ss),thickness:r(this,Ue),quadPoints:w(this,X,kp).call(this),outlines:w(this,X,Ip).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:w(this,X,oo).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!w(this,X,Lp).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ka=new WeakMap,Dl=new WeakMap,is=new WeakMap,ir=new WeakMap,Ia=new WeakMap,pe=new WeakMap,Ll=new WeakMap,Ol=new WeakMap,sr=new WeakMap,Be=new WeakMap,Ce=new WeakMap,zt=new WeakMap,Ra=new WeakMap,ss=new WeakMap,te=new WeakMap,Da=new WeakMap,Ue=new WeakMap,Fl=new WeakMap,X=new WeakSet,Sd=function(){const e=new yd(r(this,is),.001);g(this,Be,e.getOutlines()),[this.x,this.y,this.width,this.height]=r(this,Be).box;const i=new yd(r(this,is),.0025,.001,this._uiManager.direction==="ltr");g(this,pe,i.getOutlines());const{lastPoint:s}=r(this,pe);g(this,Ra,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},vh=function({highlightOutlines:e,highlightId:i,clipPathId:s}){var f,p;if(g(this,Be,e),g(this,pe,e.getNewOutline(r(this,Ue)/2+1.5,.0025)),i>=0)g(this,Ce,i),g(this,ir,s),this.parent.drawLayer.finalizeDraw(i,{bbox:e.box,path:{d:e.toSVGPath()}}),g(this,te,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:r(this,pe).box,path:{d:r(this,pe).toSVGPath()}},!0));else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(r(this,Ce),{bbox:w(f=et,Ve,Ir).call(f,r(this,Be).box,(y-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(r(this,te),{bbox:w(p=et,Ve,Ir).call(p,r(this,pe).box,y),path:{d:r(this,pe).toSVGPath()}})}const[a,o,l,h]=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=h;break;case 90:{const[y,v]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*v/y,this.height=h*y/v;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=h;break;case 270:{const[y,v]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*v/y,this.height=h*y/v;break}}const{lastPoint:c}=r(this,pe);g(this,Ra,[(c[0]-a)/l,(c[1]-o)/h])},Cp=function(e){const i=(a,o)=>{var l,h;this.color=a,g(this,ss,o),(l=this.parent)==null||l.drawLayer.updateProperties(r(this,Ce),{root:{fill:a,"fill-opacity":o}}),(h=r(this,Ia))==null||h.updateColor(a)},s=this.color,n=r(this,ss);this.addCommands({cmd:i.bind(this,e,et._defaultOpacity),undo:i.bind(this,s,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Q.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},Pp=function(e){const i=r(this,Ue),s=n=>{g(this,Ue,n),w(this,X,Tp).call(this,n)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Q.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},Tp=function(e){if(!r(this,zt))return;w(this,X,vh).call(this,{highlightOutlines:r(this,Be).getNewOutline(e/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},_d=function(){r(this,Ce)===null||!this.parent||(this.parent.drawLayer.remove(r(this,Ce)),g(this,Ce,null),this.parent.drawLayer.remove(r(this,te)),g(this,te,null))},hn=function(e=this.parent){r(this,Ce)===null&&({id:ie(this,Ce)._,clipPathId:ie(this,ir)._}=e.drawLayer.draw({bbox:r(this,Be).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":r(this,ss)},rootClass:{highlight:!0,free:r(this,zt)},path:{d:r(this,Be).toSVGPath()}},!1,!0),g(this,te,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:r(this,zt)},bbox:r(this,pe).box,path:{d:r(this,pe).toSVGPath()}},r(this,zt))),r(this,sr)&&(r(this,sr).style.clipPath=r(this,ir)))},Ve=new WeakSet,Ir=function([e,i,s,n],a){switch(a){case 90:return[1-i-n,e,n,s];case 180:return[1-e-s,1-i-n,s,n];case 270:return[i,1-e-s,n,s]}return[e,i,s,n]},Mp=function(e){et._keyboardManager.exec(this,e)},Sh=function(e){if(!r(this,ka))return;const i=window.getSelection();e?i.setPosition(r(this,ka),r(this,Dl)):i.setPosition(r(this,Ll),r(this,Ol))},oo=function(){return r(this,zt)?this.rotation:0},kp=function(){if(r(this,zt))return null;const[e,i]=this.pageDimensions,[s,n]=this.pageTranslation,a=r(this,is),o=new Float32Array(a.length*8);let l=0;for(const{x:h,y:c,width:f,height:p}of a){const y=h*e+s,v=(1-c)*i+n;o[l]=o[l+4]=y,o[l+1]=o[l+3]=v,o[l+2]=o[l+6]=y+f*e,o[l+5]=o[l+7]=v-p*i,l+=8}return o},Ip=function(e){return r(this,Be).serialize(e,w(this,X,oo).call(this))},Rp=function(e,i){this._freeHighlight.add(i)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},Dp=function(e,i){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Lp=function(e){const{color:i}=this._initialData;return e.color.some((s,n)=>s!==i[n])},b(et,Ve),N(et,"_defaultColor",null),N(et,"_defaultOpacity",1),N(et,"_defaultThickness",12),N(et,"_type","highlight"),N(et,"_editorType",j.HIGHLIGHT),N(et,"_freeHighlightId",-1),N(et,"_freeHighlight",null),N(et,"_freeHighlightClipId","");let Bh=et;var nr;class Op{constructor(){b(this,nr,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){r(this,nr)[t]=e}toSVGProperties(){const t=r(this,nr);return g(this,nr,Object.create(null)),{root:t}}reset(){g(this,nr,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){at("Not implemented")}}nr=new WeakMap;var Pe,La,Ft,rr,ar,$s,Ws,js,or,J,Ed,Cd,Pd,lo,Fp,_h,ho,Rr;const F=class F extends pt{constructor(e){super(e);b(this,J);b(this,Pe,null);b(this,La);N(this,"_drawId",null);g(this,La,e.mustBeCommitted||!1),this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(w(this,J,Ed).call(this,e),w(this,J,lo).call(this))}static _mergeSVGProperties(e,i){const s=new Set(Object.keys(e));for(const[n,a]of Object.entries(i))s.has(n)?Object.assign(e[n],a):e[n]=a;return e}static getDefaultDrawingOptions(e){at("Not implemented")}static get typesMap(){at("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,i){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(r(F,Ft).updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,i){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,i)}static get defaultPropertiesToUpdate(){const e=[],i=this._defaultDrawingOptions;for(const[s,n]of this.typesMap)e.push([s,i[n]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:i}=this;for(const[s,n]of this.constructor.typesMap)e.push([s,i[n]]);return e}_updateProperty(e,i,s){const n=this._drawingOptions,a=n[i],o=l=>{var c;n.updateProperty(i,l);const h=r(this,Pe).updateProperty(i,l);h&&w(this,J,ho).call(this,h),(c=this.parent)==null||c.drawLayer.updateProperties(this._drawId,n.toSVGProperties())};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,F._mergeSVGProperties(r(this,Pe).getPathResizingSVGProperties(w(this,J,_h).call(this)),{bbox:w(this,J,Rr).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,F._mergeSVGProperties(r(this,Pe).getPathResizedSVGProperties(w(this,J,_h).call(this)),{bbox:w(this,J,Rr).call(this)}))}_onTranslating(e,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:w(this,J,Rr).call(this)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,F._mergeSVGProperties(r(this,Pe).getPathTranslatedSVGProperties(w(this,J,_h).call(this),this.parentDimensions),{bbox:w(this,J,Rr).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,r(this,La)&&(g(this,La,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){w(this,J,Pd).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,J,lo).call(this),w(this,J,ho).call(this,r(this,Pe).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var s;let i=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),w(this,J,Pd).call(this)):e&&(this._uiManager.addShouldRescale(this),w(this,J,lo).call(this,e),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(e),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,F._mergeSVGProperties({bbox:w(this,J,Rr).call(this)},r(this,Pe).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&w(this,J,ho).call(this,r(this,Pe).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,i;this._isCopy&&(e=this.x,i=this.y);const s=super.render();s.classList.add("draw");const n=document.createElement("div");s.append(n),n.setAttribute("aria-hidden","true"),n.className="internal";const[a,o]=this.parentDimensions;return this.setDims(this.width*a,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,i),s}static createDrawerInstance(e,i,s,n,a){at("Not implemented")}static startDrawing(e,i,s,n){var _;const{target:a,offsetX:o,offsetY:l,pointerId:h,pointerType:c}=n;if(r(F,Ws)&&r(F,Ws)!==c)return;const{viewport:{rotation:f}}=e,{width:p,height:y}=a.getBoundingClientRect(),v=g(F,rr,new AbortController),A=e.combinedSignal(v);if(r(F,$s)||g(F,$s,h),r(F,Ws)??g(F,Ws,c),window.addEventListener("pointerup",C=>{var T;r(F,$s)===C.pointerId?this._endDraw(C):(T=r(F,js))==null||T.delete(C.pointerId)},{signal:A}),window.addEventListener("pointercancel",C=>{var T;r(F,$s)===C.pointerId?this._currentParent.endDrawingSession():(T=r(F,js))==null||T.delete(C.pointerId)},{signal:A}),window.addEventListener("pointerdown",C=>{r(F,Ws)===C.pointerType&&((r(F,js)||g(F,js,new Set)).add(C.pointerId),r(F,Ft).isCancellable()&&(r(F,Ft).removeLastElement(),r(F,Ft).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",ri,{signal:A}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),a.addEventListener("touchmove",C=>{C.timeStamp===r(F,or)&&Et(C)},{signal:A}),e.toggleDrawing(),(_=i._editorUndoBar)==null||_.hide(),r(F,Ft)){e.drawLayer.updateProperties(this._currentDrawId,r(F,Ft).startNew(o,l,p,y,f));return}i.updateUIForDefaultProperties(this),g(F,Ft,this.createDrawerInstance(o,l,p,y,f)),g(F,ar,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(r(F,ar).toSVGProperties(),r(F,Ft).defaultSVGProperties),!0,!1)}static _drawMove(e){var a;if(g(F,or,-1),!r(F,Ft))return;const{offsetX:i,offsetY:s,pointerId:n}=e;if(r(F,$s)===n){if(((a=r(F,js))==null?void 0:a.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,r(F,Ft).add(i,s)),g(F,or,e.timeStamp),Et(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,g(F,Ft,null),g(F,ar,null),g(F,Ws,null),g(F,or,NaN)),r(F,rr)&&(r(F,rr).abort(),g(F,rr,null),g(F,$s,NaN),g(F,js,null))}static _endDraw(e){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(e==null?void 0:e.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,r(F,Ft).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const s=r(F,Ft),n=this._currentDrawId,a=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(n,s.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(n,s.removeLastElement())},mustExec:!1,type:Q.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Q.DRAW_STEP),!r(F,Ft).isEmpty()){const{pageDimensions:[s,n],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:r(F,Ft).getOutlines(s*a,n*a,a,this._INNER_MARGIN),drawingOptions:r(F,ar),mustBeCommitted:!e});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,i,s,n,a,o){at("Not implemented")}static async deserialize(e,i,s){var f,p;const{rawDims:{pageWidth:n,pageHeight:a,pageX:o,pageY:l}}=i.viewport,h=this.deserializeDraw(o,l,n,a,this._INNER_MARGIN,e),c=await super.deserialize(e,i,s);return c.createDrawingOptions(e),w(f=c,J,Ed).call(f,{drawOutlines:h}),w(p=c,J,lo).call(p),c.onScaleChanging(),c.rotate(),c}serializeDraw(e){const[i,s]=this.pageTranslation,[n,a]=this.pageDimensions;return r(this,Pe).serialize([i,s,n,a],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Pe=new WeakMap,La=new WeakMap,Ft=new WeakMap,rr=new WeakMap,ar=new WeakMap,$s=new WeakMap,Ws=new WeakMap,js=new WeakMap,or=new WeakMap,J=new WeakSet,Ed=function({drawOutlines:e,drawId:i,drawingOptions:s}){g(this,Pe,e),this._drawingOptions||(this._drawingOptions=s),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,e.defaultProperties)):this._drawId=w(this,J,Cd).call(this,e,this.parent),w(this,J,ho).call(this,e.box)},Cd=function(e,i){const{id:s}=i.drawLayer.draw(F._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s},Pd=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},lo=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=w(this,J,Cd).call(this,r(this,Pe),e)}},Fp=function([e,i,s,n]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[i,1-e,s*(o/a),n*(a/o)];case 180:return[1-e,1-i,s,n];case 270:return[1-i,e,s*(o/a),n*(a/o)];default:return[e,i,s,n]}},_h=function(){const{x:e,y:i,width:s,height:n,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-i,e,s*(a/o),n*(o/a)];case 180:return[1-e,1-i,s,n];case 270:return[i,1-e,s*(a/o),n*(o/a)];default:return[e,i,s,n]}},ho=function(e){if([this.x,this.y,this.width,this.height]=w(this,J,Fp).call(this,e),this.div){this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)}this._onResized()},Rr=function(){const{x:e,y:i,width:s,height:n,rotation:a,parentRotation:o,parentDimensions:[l,h]}=this;switch((a*4+o)/90){case 1:return[1-i-n,e,n,s];case 2:return[1-e-s,1-i-n,s,n];case 3:return[i,1-e-s,n,s];case 4:return[e,i-s*(l/h),n*(h/l),s*(l/h)];case 5:return[1-i,e,s*(l/h),n*(h/l)];case 6:return[1-e-n*(h/l),1-i,n*(h/l),s*(l/h)];case 7:return[i-s*(l/h),1-e-n*(h/l),s*(l/h),n*(h/l)];case 8:return[e-s,i-n,s,n];case 9:return[1-i,e-s,n,s];case 10:return[1-e,1-i,s,n];case 11:return[i-n,1-e,n,s];case 12:return[e-n*(h/l),i,n*(h/l),s*(l/h)];case 13:return[1-i-s*(l/h),e-n*(h/l),s*(l/h),n*(h/l)];case 14:return[1-e,1-i-s*(l/h),n*(h/l),s*(l/h)];case 15:return[i,1-e,s*(l/h),n*(h/l)];default:return[e,i,s,n]}},N(F,"_currentDrawId",-1),N(F,"_currentParent",null),b(F,Ft,null),b(F,rr,null),b(F,ar,null),b(F,$s,NaN),b(F,Ws,null),b(F,js,null),b(F,or,NaN),N(F,"_INNER_MARGIN",3);let Uh=F;var vi,Nt,Gt,lr,Oa,re,Vt,He,hr,cr,dr,Fa,Eh;class Km{constructor(t,e,i,s,n,a){b(this,Fa);b(this,vi,new Float64Array(6));b(this,Nt);b(this,Gt);b(this,lr);b(this,Oa);b(this,re);b(this,Vt,"");b(this,He,0);b(this,hr,new jl);b(this,cr);b(this,dr);g(this,cr,i),g(this,dr,s),g(this,lr,n),g(this,Oa,a),[t,e]=w(this,Fa,Eh).call(this,t,e);const o=g(this,Nt,[NaN,NaN,NaN,NaN,t,e]);g(this,re,[t,e]),g(this,Gt,[{line:o,points:r(this,re)}]),r(this,vi).set(o,0)}updateProperty(t,e){t==="stroke-width"&&g(this,Oa,e)}isEmpty(){return!r(this,Gt)||r(this,Gt).length===0}isCancellable(){return r(this,re).length<=10}add(t,e){[t,e]=w(this,Fa,Eh).call(this,t,e);const[i,s,n,a]=r(this,vi).subarray(2,6),o=t-n,l=e-a;return Math.hypot(r(this,cr)*o,r(this,dr)*l)<=2?null:(r(this,re).push(t,e),isNaN(i)?(r(this,vi).set([n,a,t,e],2),r(this,Nt).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(r(this,vi)[0])&&r(this,Nt).splice(6,6),r(this,vi).set([i,s,n,a,t,e],0),r(this,Nt).push(...L.createBezierPoints(i,s,n,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(r(this,re).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,s,n){g(this,cr,i),g(this,dr,s),g(this,lr,n),[t,e]=w(this,Fa,Eh).call(this,t,e);const a=g(this,Nt,[NaN,NaN,NaN,NaN,t,e]);g(this,re,[t,e]);const o=r(this,Gt).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),r(this,Gt).push({line:a,points:r(this,re)}),r(this,vi).set(a,0),g(this,He,0),this.toSVGPath(),null}getLastElement(){return r(this,Gt).at(-1)}setLastElement(t){return r(this,Gt)?(r(this,Gt).push(t),g(this,Nt,t.line),g(this,re,t.points),g(this,He,0),{path:{d:this.toSVGPath()}}):r(this,hr).setLastElement(t)}removeLastElement(){if(!r(this,Gt))return r(this,hr).removeLastElement();r(this,Gt).pop(),g(this,Vt,"");for(let t=0,e=r(this,Gt).length;t<e;t++){const{line:i,points:s}=r(this,Gt)[t];g(this,Nt,i),g(this,re,s),g(this,He,0),this.toSVGPath()}return{path:{d:r(this,Vt)}}}toSVGPath(){const t=L.svgRound(r(this,Nt)[4]),e=L.svgRound(r(this,Nt)[5]);if(r(this,re).length===2)return g(this,Vt,`${r(this,Vt)} M ${t} ${e} Z`),r(this,Vt);if(r(this,re).length<=6){const s=r(this,Vt).lastIndexOf("M");g(this,Vt,`${r(this,Vt).slice(0,s)} M ${t} ${e}`),g(this,He,6)}if(r(this,re).length===4){const s=L.svgRound(r(this,Nt)[10]),n=L.svgRound(r(this,Nt)[11]);return g(this,Vt,`${r(this,Vt)} L ${s} ${n}`),g(this,He,12),r(this,Vt)}const i=[];r(this,He)===0&&(i.push(`M ${t} ${e}`),g(this,He,6));for(let s=r(this,He),n=r(this,Nt).length;s<n;s+=6){const[a,o,l,h,c,f]=r(this,Nt).slice(s,s+6).map(L.svgRound);i.push(`C${a} ${o} ${l} ${h} ${c} ${f}`)}return g(this,Vt,r(this,Vt)+i.join(" ")),g(this,He,r(this,Nt).length),r(this,Vt)}getOutlines(t,e,i,s){const n=r(this,Gt).at(-1);return n.line=new Float32Array(n.line),n.points=new Float32Array(n.points),r(this,hr).build(r(this,Gt),t,e,i,r(this,lr),r(this,Oa),s),g(this,vi,null),g(this,Nt,null),g(this,Gt,null),g(this,Vt,null),r(this,hr)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}vi=new WeakMap,Nt=new WeakMap,Gt=new WeakMap,lr=new WeakMap,Oa=new WeakMap,re=new WeakMap,Vt=new WeakMap,He=new WeakMap,hr=new WeakMap,cr=new WeakMap,dr=new WeakMap,Fa=new WeakSet,Eh=function(t,e){return L._normalizePoint(t,e,r(this,cr),r(this,dr),r(this,lr))};var ae,Nl,Gl,Te,Si,_i,Na,Ga,ur,jt,Di,Np,Gp,Bp;class jl extends L{constructor(){super(...arguments);b(this,jt);b(this,ae);b(this,Nl,0);b(this,Gl);b(this,Te);b(this,Si);b(this,_i);b(this,Na);b(this,Ga);b(this,ur)}build(e,i,s,n,a,o,l){g(this,Si,i),g(this,_i,s),g(this,Na,n),g(this,Ga,a),g(this,ur,o),g(this,Gl,l??0),g(this,Te,e),w(this,jt,Gp).call(this)}get thickness(){return r(this,ur)}setLastElement(e){return r(this,Te).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return r(this,Te).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:i}of r(this,Te)){if(e.push(`M${L.svgRound(i[4])} ${L.svgRound(i[5])}`),i.length===6){e.push("Z");continue}if(i.length===12&&isNaN(i[6])){e.push(`L${L.svgRound(i[10])} ${L.svgRound(i[11])}`);continue}for(let s=6,n=i.length;s<n;s+=6){const[a,o,l,h,c,f]=i.subarray(s,s+6).map(L.svgRound);e.push(`C${a} ${o} ${l} ${h} ${c} ${f}`)}}return e.join("")}serialize([e,i,s,n],a){const o=[],l=[],[h,c,f,p]=w(this,jt,Np).call(this);let y,v,A,_,C,T,E,u,m;switch(r(this,Ga)){case 0:m=L._rescale,y=e,v=i+n,A=s,_=-n,C=e+h*s,T=i+(1-c-p)*n,E=e+(h+f)*s,u=i+(1-c)*n;break;case 90:m=L._rescaleAndSwap,y=e,v=i,A=s,_=n,C=e+c*s,T=i+h*n,E=e+(c+p)*s,u=i+(h+f)*n;break;case 180:m=L._rescale,y=e+s,v=i,A=-s,_=n,C=e+(1-h-f)*s,T=i+c*n,E=e+(1-h)*s,u=i+(c+p)*n;break;case 270:m=L._rescaleAndSwap,y=e+s,v=i+n,A=-s,_=-n,C=e+(1-c-p)*s,T=i+(1-h-f)*n,E=e+(1-c)*s,u=i+(1-h)*n;break}for(const{line:x,points:S}of r(this,Te))o.push(m(x,y,v,A,_,a?new Array(x.length):null)),l.push(m(S,y,v,A,_,a?new Array(S.length):null));return{lines:o,points:l,rect:[C,T,E,u]}}static deserialize(e,i,s,n,a,{paths:{lines:o,points:l},rotation:h,thickness:c}){const f=[];let p,y,v,A,_;switch(h){case 0:_=L._rescale,p=-e/s,y=i/n+1,v=1/s,A=-1/n;break;case 90:_=L._rescaleAndSwap,p=-i/n,y=-e/s,v=1/n,A=1/s;break;case 180:_=L._rescale,p=e/s+1,y=-i/n,v=-1/s,A=1/n;break;case 270:_=L._rescaleAndSwap,p=i/n+1,y=e/s+1,v=-1/n,A=-1/s;break}if(!o){o=[];for(const T of l){const E=T.length;if(E===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,T[0],T[1]]));continue}if(E===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,T[0],T[1],NaN,NaN,NaN,NaN,T[2],T[3]]));continue}const u=new Float32Array(3*(E-2));o.push(u);let[m,x,S,P]=T.subarray(0,4);u.set([NaN,NaN,NaN,NaN,m,x],0);for(let M=4;M<E;M+=2){const I=T[M],k=T[M+1];u.set(L.createBezierPoints(m,x,S,P,I,k),(M-2)*3),[m,x,S,P]=[S,P,I,k]}}}for(let T=0,E=o.length;T<E;T++)f.push({line:_(o[T].map(u=>u??NaN),p,y,v,A),points:_(l[T].map(u=>u??NaN),p,y,v,A)});const C=new this.prototype.constructor;return C.build(f,s,n,1,h,c,a),C}get box(){return r(this,ae)}updateProperty(e,i){return e==="stroke-width"?w(this,jt,Bp).call(this,i):null}updateParentDimensions([e,i],s){const[n,a]=w(this,jt,Di).call(this);g(this,Si,e),g(this,_i,i),g(this,Na,s);const[o,l]=w(this,jt,Di).call(this),h=o-n,c=l-a,f=r(this,ae);return f[0]-=h,f[1]-=c,f[2]+=2*h,f[3]+=2*c,f}updateRotation(e){return g(this,Nl,e),{path:{transform:this.rotationTransform}}}get viewBox(){return r(this,ae).map(L.svgRound).join(" ")}get defaultProperties(){const[e,i]=r(this,ae);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${L.svgRound(e)} ${L.svgRound(i)}`}}}get rotationTransform(){const[,,e,i]=r(this,ae);let s=0,n=0,a=0,o=0,l=0,h=0;switch(r(this,Nl)){case 90:n=i/e,a=-e/i,l=e;break;case 180:s=-1,o=-1,l=e,h=i;break;case 270:n=-i/e,a=e/i,h=i;break;default:return""}return`matrix(${s} ${n} ${a} ${o} ${L.svgRound(l)} ${L.svgRound(h)})`}getPathResizingSVGProperties([e,i,s,n]){const[a,o]=w(this,jt,Di).call(this),[l,h,c,f]=r(this,ae);if(Math.abs(c-a)<=L.PRECISION||Math.abs(f-o)<=L.PRECISION){const _=e+s/2-(l+c/2),C=i+n/2-(h+f/2);return{path:{"transform-origin":`${L.svgRound(e)} ${L.svgRound(i)}`,transform:`${this.rotationTransform} translate(${_} ${C})`}}}const p=(s-2*a)/(c-2*a),y=(n-2*o)/(f-2*o),v=c/s,A=f/n;return{path:{"transform-origin":`${L.svgRound(l)} ${L.svgRound(h)}`,transform:`${this.rotationTransform} scale(${v} ${A}) translate(${L.svgRound(a)} ${L.svgRound(o)}) scale(${p} ${y}) translate(${L.svgRound(-a)} ${L.svgRound(-o)})`}}}getPathResizedSVGProperties([e,i,s,n]){const[a,o]=w(this,jt,Di).call(this),l=r(this,ae),[h,c,f,p]=l;if(l[0]=e,l[1]=i,l[2]=s,l[3]=n,Math.abs(f-a)<=L.PRECISION||Math.abs(p-o)<=L.PRECISION){const C=e+s/2-(h+f/2),T=i+n/2-(c+p/2);for(const{line:E,points:u}of r(this,Te))L._translate(E,C,T,E),L._translate(u,C,T,u);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${L.svgRound(e)} ${L.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(s-2*a)/(f-2*a),v=(n-2*o)/(p-2*o),A=-y*(h+a)+e+a,_=-v*(c+o)+i+o;if(y!==1||v!==1||A!==0||_!==0)for(const{line:C,points:T}of r(this,Te))L._rescale(C,A,_,y,v,C),L._rescale(T,A,_,y,v,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${L.svgRound(e)} ${L.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,i],s){const[n,a]=s,o=r(this,ae),l=e-o[0],h=i-o[1];if(r(this,Si)===n&&r(this,_i)===a)for(const{line:c,points:f}of r(this,Te))L._translate(c,l,h,c),L._translate(f,l,h,f);else{const c=r(this,Si)/n,f=r(this,_i)/a;g(this,Si,n),g(this,_i,a);for(const{line:p,points:y}of r(this,Te))L._rescale(p,l,h,c,f,p),L._rescale(y,l,h,c,f,y);o[2]*=c,o[3]*=f}return o[0]=e,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${L.svgRound(e)} ${L.svgRound(i)}`}}}get defaultSVGProperties(){const e=r(this,ae);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${L.svgRound(e[0])} ${L.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}ae=new WeakMap,Nl=new WeakMap,Gl=new WeakMap,Te=new WeakMap,Si=new WeakMap,_i=new WeakMap,Na=new WeakMap,Ga=new WeakMap,ur=new WeakMap,jt=new WeakSet,Di=function(e=r(this,ur)){const i=r(this,Gl)+e/2*r(this,Na);return r(this,Ga)%180===0?[i/r(this,Si),i/r(this,_i)]:[i/r(this,_i),i/r(this,Si)]},Np=function(){const[e,i,s,n]=r(this,ae),[a,o]=w(this,jt,Di).call(this,0);return[e+a,i+o,s-2*a,n-2*o]},Gp=function(){const e=g(this,ae,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:n}of r(this,Te)){if(n.length<=12){for(let l=4,h=n.length;l<h;l+=6)G.pointBoundingBox(n[l],n[l+1],e);continue}let a=n[4],o=n[5];for(let l=6,h=n.length;l<h;l+=6){const[c,f,p,y,v,A]=n.subarray(l,l+6);G.bezierBoundingBox(a,o,c,f,p,y,v,A,e),a=v,o=A}}const[i,s]=w(this,jt,Di).call(this);e[0]=le(e[0]-i,0,1),e[1]=le(e[1]-s,0,1),e[2]=le(e[2]+i,0,1),e[3]=le(e[3]+s,0,1),e[2]-=e[0],e[3]-=e[1]},Bp=function(e){const[i,s]=w(this,jt,Di).call(this);g(this,ur,e);const[n,a]=w(this,jt,Di).call(this),[o,l]=[n-i,a-s],h=r(this,ae);return h[0]-=o,h[1]-=l,h[2]+=2*o,h[3]+=2*l,h};class fc extends Op{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:pt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new fc(this._viewParameters);return t.updateAll(this),t}}var ac,Up;const Lr=class Lr extends Uh{constructor(e){super({...e,name:"inkEditor"});b(this,ac);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,i){pt.initialize(e,i),this._defaultDrawingOptions=new fc(i.viewParameters)}static getDefaultDrawingOptions(e){const i=this._defaultDrawingOptions.clone();return i.updateProperties(e),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return K(this,"typesMap",new Map([[Q.INK_THICKNESS,"stroke-width"],[Q.INK_COLOR,"stroke"],[Q.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,i,s,n,a){return new Km(e,i,s,n,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,i,s,n,a,o){return jl.deserialize(e,i,s,n,a,o)}static async deserialize(e,i,s){let n=null;if(e instanceof iu){const{data:{inkLists:o,rect:l,rotation:h,id:c,color:f,opacity:p,borderStyle:{rawWidth:y},popupRef:v},parent:{page:{pageNumber:A}}}=e;n=e={annotationType:j.INK,color:Array.from(f),thickness:y,opacity:p,paths:{points:o},boxes:null,pageIndex:A-1,rect:l.slice(0),rotation:h,id:c,deleted:!1,popupRef:v}}const a=await super.deserialize(e,i,s);return a.annotationElementId=e.id||null,a._initialData=n,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:i,opacity:s}){this._drawingOptions=Lr.getDefaultDrawingOptions({stroke:G.makeHexColor(...e),"stroke-width":i,"stroke-opacity":s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s,rect:n}=this.serializeDraw(e),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,h={annotationType:j.INK,color:pt._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:s},pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(h.isCopy=!0,h):this.annotationElementId&&!w(this,ac,Up).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(e){const{points:i,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i}),null}};ac=new WeakSet,Up=function(e){const{color:i,thickness:s,opacity:n,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((o,l)=>o!==i[l])||e.thickness!==s||e.opacity!==n||e.pageIndex!==a},N(Lr,"_type","ink"),N(Lr,"_editorType",j.INK),N(Lr,"_defaultDrawingOptions",null);let Td=Lr;class Md extends jl{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Jl=8,qa=3;var fr,it,kd,ei,Hp,zp,Id,Ch,Vp,$p,Wp,Rd,Dd,jp;class cs{static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:s},n,a,o,l){let h=new OffscreenCanvas(1,1),c=h.getContext("2d",{alpha:!1});const f=200,p=c.font=`${i} ${s} ${f}px ${e}`,{actualBoundingBoxLeft:y,actualBoundingBoxRight:v,actualBoundingBoxAscent:A,actualBoundingBoxDescent:_,fontBoundingBoxAscent:C,fontBoundingBoxDescent:T,width:E}=c.measureText(t),u=1.5,m=Math.ceil(Math.max(Math.abs(y)+Math.abs(v)||0,E)*u),x=Math.ceil(Math.max(Math.abs(A)+Math.abs(_)||f,Math.abs(C)+Math.abs(T)||f)*u);h=new OffscreenCanvas(m,x),c=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),c.font=p,c.filter="grayscale(1)",c.fillStyle="white",c.fillRect(0,0,m,x),c.fillStyle="black",c.fillText(t,m*(u-1)/2,x*(3-u)/2);const S=w(this,it,Rd).call(this,c.getImageData(0,0,m,x).data),P=w(this,it,Wp).call(this,S),M=w(this,it,Dd).call(this,P),I=w(this,it,Id).call(this,S,m,x,M);return this.processDrawnLines({lines:{curves:I,width:m,height:x},pageWidth:n,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(t,e,i,s,n){const[a,o,l]=w(this,it,jp).call(this,t),[h,c]=w(this,it,$p).call(this,a,o,l,Math.hypot(o,l)*r(this,fr).sigmaSFactor,r(this,fr).sigmaR,r(this,fr).kernelSize),f=w(this,it,Dd).call(this,c),p=w(this,it,Id).call(this,h,o,l,f);return this.processDrawnLines({lines:{curves:p,width:o,height:l},pageWidth:e,pageHeight:i,rotation:s,innerMargin:n,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:s,innerMargin:n,mustSmooth:a,areContours:o}){s%180!==0&&([e,i]=[i,e]);const{curves:l,width:h,height:c}=t,f=t.thickness??0,p=[],y=Math.min(e/h,i/c),v=y/e,A=y/i,_=[];for(const{points:T}of l){const E=a?w(this,it,Vp).call(this,T):T;if(!E)continue;_.push(E);const u=E.length,m=new Float32Array(u),x=new Float32Array(3*(u===2?2:u-2));if(p.push({line:x,points:m}),u===2){m[0]=E[0]*v,m[1]=E[1]*A,x.set([NaN,NaN,NaN,NaN,m[0],m[1]],0);continue}let[S,P,M,I]=E;S*=v,P*=A,M*=v,I*=A,m.set([S,P,M,I],0),x.set([NaN,NaN,NaN,NaN,S,P],0);for(let k=4;k<u;k+=2){const U=m[k]=E[k]*v,$=m[k+1]=E[k+1]*A;x.set(L.createBezierPoints(S,P,M,I,U,$),(k-2)*3),[S,P,M,I]=[M,I,U,$]}}if(p.length===0)return null;const C=o?new Md:new jl;return C.build(p,e,i,1,s,o?0:f,n),{outline:C,newCurves:_,areContours:o,thickness:f,width:h,height:c}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:s,height:n}){let a=1/0,o=-1/0,l=0;for(const E of t){l+=E.length;for(let u=2,m=E.length;u<m;u++){const x=E[u]-E[u-2];a=Math.min(a,x),o=Math.max(o,x)}}let h;a>=-128&&o<=127?h=Int8Array:a>=-32768&&o<=32767?h=Int16Array:h=Int32Array;const c=t.length,f=Jl+qa*c,p=new Uint32Array(f);let y=0;p[y++]=f*Uint32Array.BYTES_PER_ELEMENT+(l-2*c)*h.BYTES_PER_ELEMENT,p[y++]=0,p[y++]=s,p[y++]=n,p[y++]=e?0:1,p[y++]=Math.max(0,Math.floor(i??0)),p[y++]=c,p[y++]=h.BYTES_PER_ELEMENT;for(const E of t)p[y++]=E.length-2,p[y++]=E[0],p[y++]=E[1];const v=new CompressionStream("deflate-raw"),A=v.writable.getWriter();await A.ready,A.write(p);const _=h.prototype.constructor;for(const E of t){const u=new _(E.length-2);for(let m=2,x=E.length;m<x;m++)u[m-2]=E[m]-E[m-2];A.write(u)}A.close();const C=await new Response(v.readable).arrayBuffer(),T=new Uint8Array(C);return Xu(T)}static async decompressSignature(t){try{const e=Ag(t),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),n=s.getWriter();await n.ready,n.write(e).then(async()=>{await n.ready,await n.close()}).catch(()=>{});let a=null,o=0;for await(const E of i)a||(a=new Uint8Array(new Uint32Array(E.buffer,0,4)[0])),a.set(E,o),o+=E.length;const l=new Uint32Array(a.buffer,0,a.length>>2),h=l[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const c=l[2],f=l[3],p=l[4]===0,y=l[5],v=l[6],A=l[7],_=[],C=(Jl+qa*v)*Uint32Array.BYTES_PER_ELEMENT;let T;switch(A){case Int8Array.BYTES_PER_ELEMENT:T=new Int8Array(a.buffer,C);break;case Int16Array.BYTES_PER_ELEMENT:T=new Int16Array(a.buffer,C);break;case Int32Array.BYTES_PER_ELEMENT:T=new Int32Array(a.buffer,C);break}o=0;for(let E=0;E<v;E++){const u=l[qa*E+Jl],m=new Float32Array(u+2);_.push(m);for(let x=0;x<qa-1;x++)m[x]=l[qa*E+Jl+x+1];for(let x=0;x<u;x++)m[x+2]=m[x]+T[o++]}return{areContours:p,thickness:y,outlines:_,width:c,height:f}}catch(e){return q(`decompressSignature: ${e}`),null}}}fr=new WeakMap,it=new WeakSet,kd=function(t,e,i,s){return i-=t,s-=e,i===0?s>0?0:4:i===1?s+6:2-s},ei=new WeakMap,Hp=function(t,e,i,s,n,a,o){const l=w(this,it,kd).call(this,i,s,n,a);for(let h=0;h<8;h++){const c=(-h+l-o+16)%8,f=r(this,ei)[2*c],p=r(this,ei)[2*c+1];if(t[(i+f)*e+(s+p)]!==0)return c}return-1},zp=function(t,e,i,s,n,a,o){const l=w(this,it,kd).call(this,i,s,n,a);for(let h=0;h<8;h++){const c=(h+l+o+16)%8,f=r(this,ei)[2*c],p=r(this,ei)[2*c+1];if(t[(i+f)*e+(s+p)]!==0)return c}return-1},Id=function(t,e,i,s){const n=t.length,a=new Int32Array(n);for(let c=0;c<n;c++)a[c]=t[c]<=s?1:0;for(let c=1;c<i-1;c++)a[c*e]=a[c*e+e-1]=0;for(let c=0;c<e;c++)a[c]=a[e*i-1-c]=0;let o=1,l;const h=[];for(let c=1;c<i-1;c++){l=1;for(let f=1;f<e-1;f++){const p=c*e+f,y=a[p];if(y===0)continue;let v=c,A=f;if(y===1&&a[p-1]===0)o+=1,A-=1;else if(y>=1&&a[p+1]===0)o+=1,A+=1,y>1&&(l=y);else{y!==1&&(l=Math.abs(y));continue}const _=[f,c],C=A===f+1,T={isHole:C,points:_,id:o,parent:0};h.push(T);let E;for(const k of h)if(k.id===l){E=k;break}E?E.isHole?T.parent=C?E.parent:l:T.parent=C?l:E.parent:T.parent=C?l:0;const u=w(this,it,Hp).call(this,a,e,c,f,v,A,0);if(u===-1){a[p]=-o,a[p]!==1&&(l=Math.abs(a[p]));continue}let m=r(this,ei)[2*u],x=r(this,ei)[2*u+1];const S=c+m,P=f+x;v=S,A=P;let M=c,I=f;for(;;){const k=w(this,it,zp).call(this,a,e,M,I,v,A,1);m=r(this,ei)[2*k],x=r(this,ei)[2*k+1];const U=M+m,$=I+x;_.push($,U);const W=M*e+I;if(a[W+1]===0?a[W]=-o:a[W]===1&&(a[W]=o),U===c&&$===f&&M===S&&I===P){a[p]!==1&&(l=Math.abs(a[p]));break}else v=M,A=I,M=U,I=$}}}return h},Ch=function(t,e,i,s){if(i-e<=4){for(let S=e;S<i-2;S+=2)s.push(t[S],t[S+1]);return}const n=t[e],a=t[e+1],o=t[i-4]-n,l=t[i-3]-a,h=Math.hypot(o,l),c=o/h,f=l/h,p=c*a-f*n,y=l/o,v=1/h,A=Math.atan(y),_=Math.cos(A),C=Math.sin(A),T=v*(Math.abs(_)+Math.abs(C)),E=v*(1-T+T**2),u=Math.max(Math.atan(Math.abs(C+_)*E),Math.atan(Math.abs(C-_)*E));let m=0,x=e;for(let S=e+2;S<i-2;S+=2){const P=Math.abs(p-c*t[S+1]+f*t[S]);P>m&&(x=S,m=P)}m>(h*u)**2?(w(this,it,Ch).call(this,t,e,x+2,s),w(this,it,Ch).call(this,t,x,i,s)):s.push(n,a)},Vp=function(t){const e=[],i=t.length;return w(this,it,Ch).call(this,t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e},$p=function(t,e,i,s,n,a){const o=new Float32Array(a**2),l=-2*s**2,h=a>>1;for(let A=0;A<a;A++){const _=(A-h)**2;for(let C=0;C<a;C++)o[A*a+C]=Math.exp((_+(C-h)**2)/l)}const c=new Float32Array(256),f=-2*n**2;for(let A=0;A<256;A++)c[A]=Math.exp(A**2/f);const p=t.length,y=new Uint8Array(p),v=new Uint32Array(256);for(let A=0;A<i;A++)for(let _=0;_<e;_++){const C=A*e+_,T=t[C];let E=0,u=0;for(let x=0;x<a;x++){const S=A+x-h;if(!(S<0||S>=i))for(let P=0;P<a;P++){const M=_+P-h;if(M<0||M>=e)continue;const I=t[S*e+M],k=o[x*a+P]*c[Math.abs(I-T)];E+=I*k,u+=k}}const m=y[C]=Math.round(E/u);v[m]++}return[y,v]},Wp=function(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e},Rd=function(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let s=-1/0,n=1/0;for(let o=0,l=i.length;o<l;o++){if(t[(o<<2)+3]===0){s=i[o]=255;continue}const c=i[o]=t[o<<2];c>s&&(s=c),c<n&&(n=c)}const a=255/(s-n);for(let o=0;o<e;o++)i[o]=(i[o]-n)*a;return i},Dd=function(t){let e,i=-1/0,s=-1/0;const n=t.findIndex(l=>l!==0);let a=n,o=n;for(e=n;e<256;e++){const l=t[e];l>i&&(e-a>s&&(s=e-a,o=e-1),i=l,a=e)}for(e=o-1;e>=0&&!(t[e]>t[e+1]);e--);return e},jp=function(t){const e=t,{width:i,height:s}=t,{maxDim:n}=r(this,fr);let a=i,o=s;if(i>n||s>n){let p=i,y=s,v=Math.log2(Math.max(i,s)/n);const A=Math.floor(v);v=v===A?A-1:A;for(let C=0;C<v;C++){a=p,o=y,a>n&&(a=Math.ceil(a/2)),o>n&&(o=Math.ceil(o/2));const T=new OffscreenCanvas(a,o);T.getContext("2d").drawImage(t,0,0,p,y,0,0,a,o),p=a,y=o,t!==e&&t.close(),t=T.transferToImageBitmap()}const _=Math.min(n/a,n/o);a=Math.round(a*_),o=Math.round(o*_)}const h=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});h.filter="grayscale(1)",h.drawImage(t,0,0,t.width,t.height,0,0,a,o);const c=h.getImageData(0,0,a,o).data;return[w(this,it,Rd).call(this,c),a,o]},b(cs,it),b(cs,fr,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),b(cs,ei,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class su extends Op{constructor(){super(),super.updateProperties({fill:"CanvasText","stroke-width":0})}clone(){const t=new su;return t.updateAll(this),t}}class nu extends fc{constructor(t){super(t),super.updateProperties({stroke:"CanvasText","stroke-width":1})}clone(){const t=new nu(this._viewParameters);return t.updateAll(this),t}}var qs,Me,Xs,Ys;const ye=class ye extends Uh{constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"});b(this,qs,!1);b(this,Me,null);b(this,Xs,null);b(this,Ys,null);this._willKeepAspectRatio=!0,g(this,Xs,e.signatureData||null),g(this,Me,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,i){pt.initialize(e,i),this._defaultDrawingOptions=new su,this._defaultDrawnSignatureOptions=new nu(i.viewParameters)}static getDefaultDrawingOptions(e){const i=this._defaultDrawingOptions.clone();return i.updateProperties(e),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return K(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!r(this,Me)}}static computeTelemetryFinalData(e){const i=e.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,e=this.x,i=this.y),super.render(),this._drawId===null)if(r(this,Xs)){const{lines:n,mustSmooth:a,areContours:o,description:l,uuid:h,heightInPage:c}=r(this,Xs),{rawDims:{pageWidth:f,pageHeight:p},rotation:y}=this.parent.viewport,v=cs.processDrawnLines({lines:n,pageWidth:f,pageHeight:p,rotation:y,innerMargin:ye._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(v,c,l,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return s&&(this._isCopy=!0,this._moveAfterPaste(e,i)),this.div}setUuid(e){g(this,Ys,e),this.addEditToolbar()}getUuid(){return r(this,Ys)}get description(){return r(this,Me)}set description(e){g(this,Me,e),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(e)})}getSignaturePreview(){const{newCurves:e,areContours:i,thickness:s,width:n,height:a}=r(this,Xs),o=Math.max(n,a),l=cs.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:s,width:n,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:l.outline}}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.signatureManager&&r(this,Me)!==null&&(await e.addEditSignatureButton(this._uiManager.signatureManager,r(this,Ys),r(this,Me)),e.show()),e):null}addSignature(e,i,s,n){const{x:a,y:o}=this,{outline:l}=g(this,Xs,e);g(this,qs,l instanceof Md),g(this,Me,s),this.div.setAttribute("data-l10n-args",JSON.stringify({description:s}));let h;r(this,qs)?h=ye.getDefaultDrawingOptions():(h=ye._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:h});const[c,f]=this.parentDimensions,[,p]=this.pageDimensions;let y=i/p;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(c*this.width,f*this.height),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(n),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!n,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:i,pageHeight:s},rotation:n}=this.parent.viewport;return cs.process(e,i,s,n,ye._INNER_MARGIN)}getFromText(e,i){const{rawDims:{pageWidth:s,pageHeight:n},rotation:a}=this.parent.viewport;return cs.extractContoursFromText(e,i,s,n,a,ye._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:i,pageHeight:s},rotation:n}=this.parent.viewport;return cs.processDrawnLines({lines:e,pageWidth:i,pageHeight:s,rotation:n,innerMargin:ye._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:i}){e?this._drawingOptions=ye.getDefaultDrawingOptions():(this._drawingOptions=ye._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:i,points:s,rect:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":a}}=this,o={annotationType:j.SIGNATURE,isSignature:!0,areContours:r(this,qs),color:[0,0,0],thickness:r(this,qs)?0:a,pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(o.paths={lines:i,points:s},o.uuid=r(this,Ys),o.isCopy=!0):o.lines=i,r(this,Me)&&(o.accessibilityData={type:"Figure",alt:r(this,Me)}),o}static deserializeDraw(e,i,s,n,a,o){return o.areContours?Md.deserialize(e,i,s,n,a,o):jl.deserialize(e,i,s,n,a,o)}static async deserialize(e,i,s){var a;const n=await super.deserialize(e,i,s);return g(n,qs,e.areContours),g(n,Me,((a=e.accessibilityData)==null?void 0:a.alt)||""),g(n,Ys,e.uuid),n}};qs=new WeakMap,Me=new WeakMap,Xs=new WeakMap,Ys=new WeakMap,N(ye,"_type","signature"),N(ye,"_editorType",j.SIGNATURE),N(ye,"_defaultDrawingOptions",null);let Ld=ye;var dt,Bt,Zs,ns,Ks,Ba,rs,pr,Ei,ke,Ua,tt,co,uo,Ph,Th,Mh,Fd,kh,qp;class Od extends pt{constructor(e){super({...e,name:"stampEditor"});b(this,tt);b(this,dt,null);b(this,Bt,null);b(this,Zs,null);b(this,ns,null);b(this,Ks,null);b(this,Ba,"");b(this,rs,null);b(this,pr,!1);b(this,Ei,null);b(this,ke,!1);b(this,Ua,!1);g(this,ns,e.bitmapUrl),g(this,Ks,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,i){pt.initialize(e,i)}static isHandlingMimeForPasting(e){return Tc.includes(e)}static paste(e,i){i.pasteEditor(j.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const i=e.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(e=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:a,height:o}=e||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:n,width:a,height:o,channels:n.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const h=l.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var e;r(this,Bt)&&(g(this,dt,null),this._uiManager.imageManager.deleteId(r(this,Bt)),(e=r(this,rs))==null||e.remove(),g(this,rs,null),r(this,Ei)&&(clearTimeout(r(this,Ei)),g(this,Ei,null))),super.remove()}rebuild(){if(!this.parent){r(this,Bt)&&w(this,tt,Ph).call(this);return}super.rebuild(),this.div!==null&&(r(this,Bt)&&r(this,rs)===null&&w(this,tt,Ph).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(r(this,Zs)||r(this,dt)||r(this,ns)||r(this,Ks)||r(this,Bt)||r(this,pr))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,i;return this._isCopy&&(e=this.x,i=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),r(this,pr)||(r(this,dt)?w(this,tt,Th).call(this):w(this,tt,Ph).call(this)),this._isCopy&&this._moveAfterPaste(e,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,i){const{id:s,bitmap:n}=this._uiManager.imageManager.getFromCanvas(e,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(g(this,Bt,s),n&&g(this,dt,n),g(this,pr,!1),w(this,tt,Th).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;r(this,Ei)!==null&&clearTimeout(r(this,Ei)),g(this,Ei,setTimeout(()=>{g(this,Ei,null),w(this,tt,Fd).call(this)},200))}copyCanvas(e,i,s=!1){var y;e||(e=224);const{width:n,height:a}=r(this,dt),o=new ps;let l=r(this,dt),h=n,c=a,f=null;if(i){if(n>i||a>i){const P=Math.min(i/n,i/a);h=Math.floor(n*P),c=Math.floor(a*P)}f=document.createElement("canvas");const v=f.width=Math.ceil(h*o.sx),A=f.height=Math.ceil(c*o.sy);r(this,ke)||(l=w(this,tt,Mh).call(this,v,A));const _=f.getContext("2d");_.filter=this._uiManager.hcmFilter;let C="white",T="#cfcfd8";this._uiManager.hcmFilter!=="none"?T="black":(y=window.matchMedia)!=null&&y.call(window,"(prefers-color-scheme: dark)").matches&&(C="#8f8f9d",T="#42414d");const E=15,u=E*o.sx,m=E*o.sy,x=new OffscreenCanvas(u*2,m*2),S=x.getContext("2d");S.fillStyle=C,S.fillRect(0,0,u*2,m*2),S.fillStyle=T,S.fillRect(0,0,u,m),S.fillRect(u,m,u,m),_.fillStyle=_.createPattern(x,"repeat"),_.fillRect(0,0,v,A),_.drawImage(l,0,0,l.width,l.height,0,0,v,A)}let p=null;if(s){let v,A;if(o.symmetric&&l.width<e&&l.height<e)v=l.width,A=l.height;else if(l=r(this,dt),n>e||a>e){const T=Math.min(e/n,e/a);v=Math.floor(n*T),A=Math.floor(a*T),r(this,ke)||(l=w(this,tt,Mh).call(this,v,A))}const C=new OffscreenCanvas(v,A).getContext("2d",{willReadFrequently:!0});C.drawImage(l,0,0,l.width,l.height,0,0,v,A),p={width:v,height:A,data:C.getImageData(0,0,v,A).data}}return{canvas:f,width:h,height:c,imageData:p}}static async deserialize(e,i,s){var _;let n=null,a=!1;if(e instanceof lp){const{data:{rect:C,rotation:T,id:E,structParent:u,popupRef:m},container:x,parent:{page:{pageNumber:S}},canvas:P}=e;let M,I;P?(delete e.canvas,{id:M,bitmap:I}=s.imageManager.getFromCanvas(x.id,P),P.remove()):(a=!0,e._hasNoCanvas=!0);const k=((_=await i._structTree.getAriaAttributes(`${qd}${E}`))==null?void 0:_.get("aria-label"))||"";n=e={annotationType:j.STAMP,bitmapId:M,bitmap:I,pageIndex:S-1,rect:C.slice(0),rotation:T,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:k},isSvg:!1,structParent:u,popupRef:m}}const o=await super.deserialize(e,i,s),{rect:l,bitmap:h,bitmapUrl:c,bitmapId:f,isSvg:p,accessibilityData:y}=e;a?(s.addMissingCanvas(e.id,o),g(o,pr,!0)):f&&s.imageManager.isValidId(f)?(g(o,Bt,f),h&&g(o,dt,h)):g(o,ns,c),g(o,ke,p);const[v,A]=o.pageDimensions;return o.width=(l[2]-l[0])/v,o.height=(l[3]-l[1])/A,o.annotationElementId=e.id||null,y&&(o.altTextData=y),o._initialData=n,g(o,Ua,!!n),o}serialize(e=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:j.STAMP,bitmapId:r(this,Bt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:r(this,ke),structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=w(this,tt,kh).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:n,altText:a}=this.serializeAltText(!1);if(!n&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=w(this,tt,qp).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const o=r(this,ke)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(r(this,Bt)))i.stamps.set(r(this,Bt),{area:o,serialized:s}),s.bitmap=w(this,tt,kh).call(this,!1);else if(r(this,ke)){const l=i.stamps.get(r(this,Bt));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=w(this,tt,kh).call(this,!1))}return s}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}dt=new WeakMap,Bt=new WeakMap,Zs=new WeakMap,ns=new WeakMap,Ks=new WeakMap,Ba=new WeakMap,rs=new WeakMap,pr=new WeakMap,Ei=new WeakMap,ke=new WeakMap,Ua=new WeakMap,tt=new WeakSet,co=function(e,i=!1){if(!e){this.remove();return}g(this,dt,e.bitmap),i||(g(this,Bt,e.id),g(this,ke,e.isSvg)),e.file&&g(this,Ba,e.file.name),w(this,tt,Th).call(this)},uo=function(){if(g(this,Zs,null),this._uiManager.enableWaiting(!1),!!r(this,rs)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,dt)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,dt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Ph=function(){if(r(this,Bt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(r(this,Bt)).then(s=>w(this,tt,co).call(this,s,!0)).finally(()=>w(this,tt,uo).call(this));return}if(r(this,ns)){const s=r(this,ns);g(this,ns,null),this._uiManager.enableWaiting(!0),g(this,Zs,this._uiManager.imageManager.getFromUrl(s).then(n=>w(this,tt,co).call(this,n)).finally(()=>w(this,tt,uo).call(this)));return}if(r(this,Ks)){const s=r(this,Ks);g(this,Ks,null),this._uiManager.enableWaiting(!0),g(this,Zs,this._uiManager.imageManager.getFromFile(s).then(n=>w(this,tt,co).call(this,n)).finally(()=>w(this,tt,uo).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Tc.join(",");const i=this._uiManager._signal;g(this,Zs,new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),w(this,tt,co).call(this,n)}s()},{signal:i}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>w(this,tt,uo).call(this))),e.click()},Th=function(){var f;const{div:e}=this;let{width:i,height:s}=r(this,dt);const[n,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*n,s=this.height*a;else if(i>o*n||s>o*a){const p=Math.min(o*n/i,o*a/s);i*=p,s*=p}const[l,h]=this.parentDimensions;this.setDims(i*l/n,s*h/a),this._uiManager.enableWaiting(!1);const c=g(this,rs,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this.width=i/n,this.height=s/a,(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),w(this,tt,Fd).call(this),r(this,Ua)||(this.parent.addUndoableEditor(this),g(this,Ua,!0)),this._reportTelemetry({action:"inserted_image"}),r(this,Ba)&&this.div.setAttribute("aria-description",r(this,Ba))},Mh=function(e,i){const{width:s,height:n}=r(this,dt);let a=s,o=n,l=r(this,dt);for(;a>2*e||o>2*i;){const h=a,c=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,h,c,0,0,a,o),l=f.transferToImageBitmap()}return l},Fd=function(){const[e,i]=this.parentDimensions,{width:s,height:n}=this,a=new ps,o=Math.ceil(s*e*a.sx),l=Math.ceil(n*i*a.sy),h=r(this,rs);if(!h||h.width===o&&h.height===l)return;h.width=o,h.height=l;const c=r(this,ke)?r(this,dt):w(this,tt,Mh).call(this,o,l),f=h.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(c,0,0,c.width,c.height,0,0,o,l)},kh=function(e){if(e){if(r(this,ke)){const n=this._uiManager.imageManager.getSvgUrl(r(this,Bt));if(n)return n}const i=document.createElement("canvas");return{width:i.width,height:i.height}=r(this,dt),i.getContext("2d").drawImage(r(this,dt),0,0),i.toDataURL()}if(r(this,ke)){const[i,s]=this.pageDimensions,n=Math.round(this.width*i*sn.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*sn.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(n,a);return o.getContext("2d").drawImage(r(this,dt),0,0,r(this,dt).width,r(this,dt).height,0,0,n,a),o.transferToImageBitmap()}return structuredClone(r(this,dt))},qp=function(e){var o;const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,n=e.pageIndex===i,a=(((o=e.accessibilityData)==null?void 0:o.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&n&&a,isSameAltText:a}},N(Od,"_type","stamp"),N(Od,"_editorType",j.STAMP);var gr,Ha,Ci,Qs,as,ze,Js,za,mr,ii,os,ee,ls,B,tn,ft,Xp,ci,Gd,Bd,Ih;const We=class We{constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:s,accessibilityManager:n,annotationLayer:a,drawLayer:o,textLayer:l,viewport:h,l10n:c}){b(this,ft);b(this,gr);b(this,Ha,!1);b(this,Ci,null);b(this,Qs,null);b(this,as,null);b(this,ze,new Map);b(this,Js,!1);b(this,za,!1);b(this,mr,!1);b(this,ii,null);b(this,os,null);b(this,ee,null);b(this,ls,null);b(this,B);const f=[...r(We,tn).values()];if(!We._initialized){We._initialized=!0;for(const p of f)p.initialize(c,t)}t.registerEditorTypes(f),g(this,B,t),this.pageIndex=e,this.div=i,g(this,gr,n),g(this,Ci,a),this.viewport=h,g(this,ee,l),this.drawLayer=o,this._structTree=s,r(this,B).addLayer(this)}get isEmpty(){return r(this,ze).size===0}get isInvisible(){return this.isEmpty&&r(this,B).getMode()===j.NONE}updateToolbar(t){r(this,B).updateToolbar(t)}updateMode(t=r(this,B).getMode()){switch(w(this,ft,Ih).call(this),t){case j.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case j.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case j.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of r(We,tn).values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=r(this,ee))==null?void 0:e.div)}setEditingState(t){r(this,B).setEditingState(t)}addCommands(t){r(this,B).addCommands(t)}cleanUndoStack(t){r(this,B).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=r(this,Ci))==null||e.div.classList.toggle("disabled",!t)}async enable(){g(this,mr,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of r(this,ze).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(r(this,B).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!r(this,Ci)){g(this,mr,!1);return}const e=r(this,Ci).getEditableAnnotations();for(const i of e){if(i.hide(),r(this,B).isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}g(this,mr,!1)}disable(){var s;g(this,za,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const n of r(this,ze).values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){t.set(n.annotationElementId,n);continue}else e.set(n.annotationElementId,n);(s=this.getEditableAnnotation(n.annotationElementId))==null||s.show(),n.remove()}if(r(this,Ci)){const n=r(this,Ci).getEditableAnnotations();for(const a of n){const{id:o}=a.data;if(r(this,B).isDeletedAnnotationElement(o))continue;let l=e.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=t.get(o),l&&(r(this,B).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}w(this,ft,Ih).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const n of r(We,tn).values())i.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),g(this,za,!1)}getEditableAnnotation(t){var e;return((e=r(this,Ci))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){r(this,B).getActive()!==t&&r(this,B).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=r(this,ee))!=null&&t.div&&!r(this,ls)){g(this,ls,new AbortController);const e=r(this,B).combinedSignal(r(this,ls));r(this,ee).div.addEventListener("pointerdown",w(this,ft,Xp).bind(this),{signal:e}),r(this,ee).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=r(this,ee))!=null&&t.div&&r(this,ls)&&(r(this,ls).abort(),g(this,ls,null),r(this,ee).div.classList.remove("highlighting"))}enableClick(){if(r(this,Qs))return;g(this,Qs,new AbortController);const t=r(this,B).combinedSignal(r(this,Qs));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=r(this,Qs))==null||t.abort(),g(this,Qs,null)}attach(t){r(this,ze).set(t.id,t);const{annotationElementId:e}=t;e&&r(this,B).isDeletedAnnotationElement(e)&&r(this,B).removeDeletedAnnotationElement(t)}detach(t){var e;r(this,ze).delete(t.id),(e=r(this,gr))==null||e.removePointerInTextLayer(t.contentDiv),!r(this,za)&&t.annotationElementId&&r(this,B).addDeletedAnnotationElement(t)}remove(t){this.detach(t),r(this,B).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(r(this,B).addDeletedAnnotationElement(t.annotationElementId),pt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),r(this,B).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!r(this,mr)),r(this,B).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var i;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!r(this,as)&&(t._focusEventsAllowed=!1,g(this,as,setTimeout(()=>{g(this,as,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:r(this,B)._signal}),e.focus())},0))),t._structTreeParentId=(i=r(this,gr))==null?void 0:i.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return r(this,B).getId()}combinedSignal(t){return r(this,B).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=r(this,ft,ci))==null?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,e){r(this,B).updateToolbar(t),await r(this,B).updateMode(t);const{offsetX:i,offsetY:s}=w(this,ft,Bd).call(this),n=this.getNextId(),a=w(this,ft,Gd).call(this,{parent:this,id:n,x:i,y:s,uiManager:r(this,B),isCentered:!0,...e});a&&this.add(a)}async deserialize(t){var e;return await((e=r(We,tn).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,r(this,B)))||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),n=w(this,ft,Gd).call(this,{parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:r(this,B),isCentered:e,...i});return n&&this.add(n),n}addNewEditor(t={}){this.createAndAddNewEditor(w(this,ft,Bd).call(this),!0,t)}setSelected(t){r(this,B).setSelected(t)}toggleSelected(t){r(this,B).toggleSelected(t)}unselect(t){r(this,B).unselect(t)}pointerup(t){var s;const{isMac:e}=Xt.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!r(this,Js)||(g(this,Js,!1),(s=r(this,ft,ci))!=null&&s.isDrawer&&r(this,ft,ci).supportMultipleDrawings))return;if(!r(this,Ha)){g(this,Ha,!0);return}const i=r(this,B).getMode();if(i===j.STAMP||i===j.SIGNATURE){r(this,B).unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){var s;if(r(this,B).getMode()===j.HIGHLIGHT&&this.enableTextSelection(),r(this,Js)){g(this,Js,!1);return}const{isMac:e}=Xt.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(g(this,Js,!0),(s=r(this,ft,ci))!=null&&s.isDrawer){this.startDrawingSession(t);return}const i=r(this,B).getActive();g(this,Ha,!i||i.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),r(this,ii)){r(this,ft,ci).startDrawing(this,r(this,B),!1,t);return}r(this,B).setCurrentDrawingSession(this),g(this,ii,new AbortController);const e=r(this,B).combinedSignal(r(this,ii));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(g(this,os,null),this.commitOrRemove())},{signal:e}),r(this,ft,ci).startDrawing(this,r(this,B),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&g(this,os,e);return}r(this,os)&&setTimeout(()=>{var e;(e=r(this,os))==null||e.focus(),g(this,os,null)},0)}endDrawingSession(t=!1){return r(this,ii)?(r(this,B).setCurrentDrawingSession(null),r(this,ii).abort(),g(this,ii,null),g(this,os,null),r(this,ft,ci).endDrawing(t)):null}findNewParent(t,e,i){const s=r(this,B).findParent(e,i);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return r(this,ii)?(this.endDrawingSession(),!0):!1}onScaleChanging(){r(this,ii)&&r(this,ft,ci).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=r(this,B).getActive())==null?void 0:t.parent)===this&&(r(this,B).commitOrRemove(),r(this,B).setActiveEditor(null)),r(this,as)&&(clearTimeout(r(this,as)),g(this,as,null));for(const i of r(this,ze).values())(e=r(this,gr))==null||e.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,r(this,ze).clear(),r(this,B).removeLayer(this)}render({viewport:t}){this.viewport=t,br(this.div,t);for(const e of r(this,B).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){r(this,B).commitOrRemove(),w(this,ft,Ih).call(this);const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,br(this.div,{rotation:i}),e!==i)for(const s of r(this,ze).values())s.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return r(this,B).viewParameters.realScale}};gr=new WeakMap,Ha=new WeakMap,Ci=new WeakMap,Qs=new WeakMap,as=new WeakMap,ze=new WeakMap,Js=new WeakMap,za=new WeakMap,mr=new WeakMap,ii=new WeakMap,os=new WeakMap,ee=new WeakMap,ls=new WeakMap,B=new WeakMap,tn=new WeakMap,ft=new WeakSet,Xp=function(t){r(this,B).unselectAll();const{target:e}=t;if(e===r(this,ee).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&r(this,ee).div.contains(e)){const{isMac:i}=Xt.platform;if(t.button!==0||t.ctrlKey&&i)return;r(this,B).showAllEditors("highlight",!0,!0),r(this,ee).div.classList.add("free"),this.toggleDrawing(),Bh.startHighlighting(this,r(this,B).direction==="ltr",{target:r(this,ee).div,x:t.x,y:t.y}),r(this,ee).div.addEventListener("pointerup",()=>{r(this,ee).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:r(this,B)._signal}),t.preventDefault()}},ci=function(){return r(We,tn).get(r(this,B).getMode())},Gd=function(t){const e=r(this,ft,ci);return e?new e.prototype.constructor(t):null},Bd=function(){const{x:t,y:e,width:i,height:s}=this.div.getBoundingClientRect(),n=Math.max(0,t),a=Math.max(0,e),o=Math.min(window.innerWidth,t+i),l=Math.min(window.innerHeight,e+s),h=(n+o)/2-t,c=(a+l)/2-e,[f,p]=this.viewport.rotation%180===0?[h,c]:[c,h];return{offsetX:f,offsetY:p}},Ih=function(){for(const t of r(this,ze).values())t.isEmpty()&&t.remove()},N(We,"_initialized",!1),b(We,tn,new Map([gd,Td,Od,Bh,Ld].map(t=>[t._editorType,t])));let Nd=We;var si,oe,yr,Bl,oc,Yp,Pi,Hd,Zp,zd;const Mt=class Mt{constructor({pageIndex:t}){b(this,Pi);b(this,si,null);b(this,oe,new Map);b(this,yr,new Map);this.pageIndex=t}setParent(t){if(!r(this,si)){g(this,si,t);return}if(r(this,si)!==t){if(r(this,oe).size>0)for(const e of r(this,oe).values())e.remove(),t.append(e);g(this,si,t)}}static get _svgFactory(){return K(this,"_svgFactory",new Fh)}draw(t,e=!1,i=!1){const s=ie(Mt,Bl)._++,n=w(this,Pi,Hd).call(this),a=Mt._svgFactory.createElement("defs");n.append(a);const o=Mt._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),e&&r(this,yr).set(s,o);const h=i?w(this,Pi,Zp).call(this,a,l):null,c=Mt._svgFactory.createElement("use");return n.append(c),c.setAttribute("href",`#${l}`),this.updateProperties(n,t),r(this,oe).set(s,n),{id:s,clipPathId:`url(#${h})`}}drawOutline(t,e){const i=ie(Mt,Bl)._++,s=w(this,Pi,Hd).call(this),n=Mt._svgFactory.createElement("defs");s.append(n);const a=Mt._svgFactory.createElement("path");n.append(a);const o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(e){const f=Mt._svgFactory.createElement("mask");n.append(f),l=`mask_p${this.pageIndex}_${i}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const p=Mt._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const y=Mt._svgFactory.createElement("use");f.append(y),y.setAttribute("href",`#${o}`),y.setAttribute("stroke","none"),y.setAttribute("fill","black"),y.setAttribute("fill-rule","nonzero"),y.classList.add("mask")}const h=Mt._svgFactory.createElement("use");s.append(h),h.setAttribute("href",`#${o}`),l&&h.setAttribute("mask",`url(#${l})`);const c=h.cloneNode();return s.append(c),h.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(s,t),r(this,oe).set(i,s),i}finalizeDraw(t,e){r(this,yr).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var l;if(!e)return;const{root:i,bbox:s,rootClass:n,path:a}=e,o=typeof t=="number"?r(this,oe).get(t):t;if(o){if(i&&w(this,Pi,zd).call(this,o,i),s&&w(l=Mt,oc,Yp).call(l,o,s),n){const{classList:h}=o;for(const[c,f]of Object.entries(n))h.toggle(c,f)}if(a){const c=o.firstChild.firstChild;w(this,Pi,zd).call(this,c,a)}}}updateParent(t,e){if(e===this)return;const i=r(this,oe).get(t);i&&(r(e,si).append(i),r(this,oe).delete(t),r(e,oe).set(t,i))}remove(t){r(this,yr).delete(t),r(this,si)!==null&&(r(this,oe).get(t).remove(),r(this,oe).delete(t))}destroy(){g(this,si,null);for(const t of r(this,oe).values())t.remove();r(this,oe).clear(),r(this,yr).clear()}};si=new WeakMap,oe=new WeakMap,yr=new WeakMap,Bl=new WeakMap,oc=new WeakSet,Yp=function(t,[e,i,s,n]){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*s}%`,a.height=`${100*n}%`},Pi=new WeakSet,Hd=function(){const t=Mt._svgFactory.create(1,1,!0);return r(this,si).append(t),t.setAttribute("aria-hidden",!0),t},Zp=function(t,e){const i=Mt._svgFactory.createElement("clipPath");t.append(i);const s=`clip_${e}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const n=Mt._svgFactory.createElement("use");return i.append(n),n.setAttribute("href",`#${e}`),n.classList.add("clip"),s},zd=function(t,e){for(const[i,s]of Object.entries(e))s===null?t.removeAttribute(i):t.setAttribute(i,s)},b(Mt,oc),b(Mt,Bl,0);let Ud=Mt;globalThis.pdfjsTestingUtils={HighlightOutliner:yd};V.AbortException;V.AnnotationEditorLayer;V.AnnotationEditorParamsType;V.AnnotationEditorType;V.AnnotationEditorUIManager;V.AnnotationLayer;V.AnnotationMode;V.AnnotationType;V.ColorPicker;V.DOMSVGFactory;V.DrawLayer;V.FeatureTest;var Qm=V.GlobalWorkerOptions;V.ImageKind;V.InvalidPDFException;V.MathClamp;V.OPS;V.OutputScale;V.PDFDataRangeTransport;V.PDFDateString;V.PDFWorker;V.PasswordResponses;V.PermissionFlag;V.PixelsPerInch;V.RenderingCancelledException;V.ResponseException;V.SignatureExtractor;V.SupportedImageMimeTypes;V.TextLayer;V.TouchManager;V.Util;V.VerbosityLevel;V.XfaLayer;V.build;V.createValidAbsoluteUrl;V.fetchData;var Jm=V.getDocument;V.getFilenameFromUrl;V.getPdfFilenameFromUrl;V.getUuid;V.getXfaPageViewport;V.isDataScheme;V.isPdfFile;V.isValidExplicitDest;V.noContextMenu;V.normalizeUnicode;V.setLayerDimensions;V.shadow;V.stopEvent;V.version;var fo={exports:{}},t1=fo.exports,Gu;function e1(){return Gu||(Gu=1,function(d,t){(function(e,i){i(t)})(t1,function(e){class i{constructor(u,m){this.state={angle:0,area:[],position:{x:0,y:0},hardAngle:0,hardDrawingAngle:0},this.createdDensity=m,this.nowDrawingDensity=this.createdDensity,this.render=u}setDensity(u){this.createdDensity=u,this.nowDrawingDensity=u}setDrawingDensity(u){this.nowDrawingDensity=u}setPosition(u){this.state.position=u}setAngle(u){this.state.angle=u}setArea(u){this.state.area=u}setHardDrawingAngle(u){this.state.hardDrawingAngle=u}setHardAngle(u){this.state.hardAngle=u,this.state.hardDrawingAngle=u}setOrientation(u){this.orientation=u}getDrawingDensity(){return this.nowDrawingDensity}getDensity(){return this.createdDensity}getHardAngle(){return this.state.hardAngle}}class s extends i{constructor(u,m,x){super(u,x),this.image=null,this.isLoad=!1,this.loadingAngle=0,this.image=new Image,this.image.src=m}draw(u){const m=this.render.getContext(),x=this.render.convertToGlobal(this.state.position),S=this.render.getRect().pageWidth,P=this.render.getRect().height;m.save(),m.translate(x.x,x.y),m.beginPath();for(let M of this.state.area)M!==null&&(M=this.render.convertToGlobal(M),m.lineTo(M.x-x.x,M.y-x.y));m.rotate(this.state.angle),m.clip(),this.isLoad?m.drawImage(this.image,0,0,S,P):this.drawLoader(m,{x:0,y:0},S,P),m.restore()}simpleDraw(u){const m=this.render.getRect(),x=this.render.getContext(),S=m.pageWidth,P=m.height,M=u===1?m.left+m.pageWidth:m.left,I=m.top;this.isLoad?x.drawImage(this.image,M,I,S,P):this.drawLoader(x,{x:M,y:I},S,P)}drawLoader(u,m,x,S){u.beginPath(),u.strokeStyle="rgb(200, 200, 200)",u.fillStyle="rgb(255, 255, 255)",u.lineWidth=1,u.rect(m.x+1,m.y+1,x-1,S-1),u.stroke(),u.fill();const P={x:m.x+x/2,y:m.y+S/2};u.beginPath(),u.lineWidth=10,u.arc(P.x,P.y,20,this.loadingAngle,3*Math.PI/2+this.loadingAngle),u.stroke(),u.closePath(),this.loadingAngle+=.07,this.loadingAngle>=2*Math.PI&&(this.loadingAngle=0)}load(){this.isLoad||(this.image.onload=()=>{this.isLoad=!0})}newTemporaryCopy(){return this}getTemporaryCopy(){return this}hideTemporaryCopy(){}}class n{constructor(u,m){this.pages=[],this.currentPageIndex=0,this.currentSpreadIndex=0,this.landscapeSpread=[],this.portraitSpread=[],this.render=m,this.app=u,this.currentPageIndex=0,this.isShowCover=this.app.getSettings().showCover}destroy(){this.pages=[]}createSpread(){this.landscapeSpread=[],this.portraitSpread=[];for(let m=0;m<this.pages.length;m++)this.portraitSpread.push([m]);let u=0;this.isShowCover&&(this.pages[0].setDensity("hard"),this.landscapeSpread.push([u]),u++);for(let m=u;m<this.pages.length;m+=2)m<this.pages.length-1?this.landscapeSpread.push([m,m+1]):(this.landscapeSpread.push([m]),this.pages[m].setDensity("hard"))}getSpread(){return this.render.getOrientation()==="landscape"?this.landscapeSpread:this.portraitSpread}getSpreadIndexByPage(u){const m=this.getSpread();for(let x=0;x<m.length;x++)if(u===m[x][0]||u===m[x][1])return x;return null}getPageCount(){return this.pages.length}getPages(){return this.pages}getPage(u){if(u>=0&&u<this.pages.length)return this.pages[u];throw new Error("Invalid page number")}nextBy(u){const m=this.pages.indexOf(u);return m<this.pages.length-1?this.pages[m+1]:null}prevBy(u){const m=this.pages.indexOf(u);return m>0?this.pages[m-1]:null}getFlippingPage(u){const m=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return u===0?this.pages[m].newTemporaryCopy():this.pages[m-1];{const x=u===0?this.getSpread()[m+1]:this.getSpread()[m-1];return x.length===1||u===0?this.pages[x[0]]:this.pages[x[1]]}}getBottomPage(u){const m=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return u===0?this.pages[m+1]:this.pages[m-1];{const x=u===0?this.getSpread()[m+1]:this.getSpread()[m-1];return x.length===1?this.pages[x[0]]:u===0?this.pages[x[1]]:this.pages[x[0]]}}showNext(){this.currentSpreadIndex<this.getSpread().length&&(this.currentSpreadIndex++,this.showSpread())}showPrev(){this.currentSpreadIndex>0&&(this.currentSpreadIndex--,this.showSpread())}getCurrentPageIndex(){return this.currentPageIndex}show(u=null){if(u===null&&(u=this.currentPageIndex),u<0||u>=this.pages.length)return;const m=this.getSpreadIndexByPage(u);m!==null&&(this.currentSpreadIndex=m,this.showSpread())}getCurrentSpreadIndex(){return this.currentSpreadIndex}setCurrentSpreadIndex(u){if(!(u>=0&&u<this.getSpread().length))throw new Error("Invalid page");this.currentSpreadIndex=u}showSpread(){const u=this.getSpread()[this.currentSpreadIndex];u.length===2?(this.render.setLeftPage(this.pages[u[0]]),this.render.setRightPage(this.pages[u[1]])):this.render.getOrientation()==="landscape"&&u[0]===this.pages.length-1?(this.render.setLeftPage(this.pages[u[0]]),this.render.setRightPage(null)):(this.render.setLeftPage(null),this.render.setRightPage(this.pages[u[0]])),this.currentPageIndex=u[0],this.app.updatePageIndex(this.currentPageIndex)}}class a extends n{constructor(u,m,x){super(u,m),this.imagesHref=x}load(){for(const u of this.imagesHref){const m=new s(this.render,u,"soft");m.load(),this.pages.push(m)}this.createSpread()}}class o{static GetDistanceBetweenTwoPoint(u,m){return u===null||m===null?1/0:Math.sqrt(Math.pow(m.x-u.x,2)+Math.pow(m.y-u.y,2))}static GetSegmentLength(u){return o.GetDistanceBetweenTwoPoint(u[0],u[1])}static GetAngleBetweenTwoLine(u,m){const x=u[0].y-u[1].y,S=m[0].y-m[1].y,P=u[1].x-u[0].x,M=m[1].x-m[0].x;return Math.acos((x*S+P*M)/(Math.sqrt(x*x+P*P)*Math.sqrt(S*S+M*M)))}static PointInRect(u,m){return m===null?null:m.x>=u.left&&m.x<=u.width+u.left&&m.y>=u.top&&m.y<=u.top+u.height?m:null}static GetRotatedPoint(u,m,x){return{x:u.x*Math.cos(x)+u.y*Math.sin(x)+m.x,y:u.y*Math.cos(x)-u.x*Math.sin(x)+m.y}}static LimitPointToCircle(u,m,x){if(o.GetDistanceBetweenTwoPoint(u,x)<=m)return x;const S=u.x,P=u.y,M=x.x,I=x.y;let k=Math.sqrt(Math.pow(m,2)*Math.pow(S-M,2)/(Math.pow(S-M,2)+Math.pow(P-I,2)))+S;x.x<0&&(k*=-1);let U=(k-S)*(P-I)/(S-M)+P;return S-M+P===0&&(U=m),{x:k,y:U}}static GetIntersectBetweenTwoSegment(u,m,x){return o.PointInRect(u,o.GetIntersectBeetwenTwoLine(m,x))}static GetIntersectBeetwenTwoLine(u,m){const x=u[0].y-u[1].y,S=m[0].y-m[1].y,P=u[1].x-u[0].x,M=m[1].x-m[0].x,I=u[0].x*u[1].y-u[1].x*u[0].y,k=m[0].x*m[1].y-m[1].x*m[0].y,U=x*k-S*I,$=P*k-M*I,W=-(I*M-k*P)/(x*M-S*P),mt=-(x*k-S*I)/(x*M-S*P);if(isFinite(W)&&isFinite(mt))return{x:W,y:mt};if(Math.abs(U-$)<.1)throw new Error("Segment included");return null}static GetCordsFromTwoPoint(u,m){const x=Math.abs(u.x-m.x),S=Math.abs(u.y-m.y),P=Math.max(x,S),M=[u];function I(k,U,$,W,mt){return U>k?k+mt*($/W):U<k?k-mt*($/W):k}for(let k=1;k<=P;k+=1)M.push({x:I(u.x,m.x,x,P,k),y:I(u.y,m.y,S,P,k)});return M}}class l extends i{constructor(u,m,x){super(u,x),this.copiedElement=null,this.temporaryCopy=null,this.isLoad=!1,this.element=m,this.element.classList.add("stf__item"),this.element.classList.add("--"+x)}newTemporaryCopy(){return this.nowDrawingDensity==="hard"?this:(this.temporaryCopy===null&&(this.copiedElement=this.element.cloneNode(!0),this.element.parentElement.appendChild(this.copiedElement),this.temporaryCopy=new l(this.render,this.copiedElement,this.nowDrawingDensity)),this.getTemporaryCopy())}getTemporaryCopy(){return this.temporaryCopy}hideTemporaryCopy(){this.temporaryCopy!==null&&(this.copiedElement.remove(),this.copiedElement=null,this.temporaryCopy=null)}draw(u){const m=u||this.nowDrawingDensity,x=this.render.convertToGlobal(this.state.position),S=this.render.getRect().pageWidth,P=this.render.getRect().height;this.element.classList.remove("--simple");const M=`
            display: block;
            z-index: ${this.element.style.zIndex};
            left: 0;
            top: 0;
            width: ${S}px;
            height: ${P}px;
        `;m==="hard"?this.drawHard(M):this.drawSoft(x,M)}drawHard(u=""){const m=this.render.getRect().left+this.render.getRect().width/2,x=this.state.hardDrawingAngle,S=u+`
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
                clip-path: none;
                -webkit-clip-path: none;
            `+(this.orientation===0?`transform-origin: ${this.render.getRect().pageWidth}px 0; 
                   transform: translate3d(0, 0, 0) rotateY(${x}deg);`:`transform-origin: 0 0; 
                   transform: translate3d(${m}px, 0, 0) rotateY(${x}deg);`);this.element.style.cssText=S}drawSoft(u,m=""){let x="polygon( ";for(const P of this.state.area)if(P!==null){let M=this.render.getDirection()===1?{x:-P.x+this.state.position.x,y:P.y-this.state.position.y}:{x:P.x-this.state.position.x,y:P.y-this.state.position.y};M=o.GetRotatedPoint(M,{x:0,y:0},this.state.angle),x+=M.x+"px "+M.y+"px, "}x=x.slice(0,-2),x+=")";const S=m+`transform-origin: 0 0; clip-path: ${x}; -webkit-clip-path: ${x};`+(this.render.isSafari()&&this.state.angle===0?`transform: translate(${u.x}px, ${u.y}px);`:`transform: translate3d(${u.x}px, ${u.y}px, 0) rotate(${this.state.angle}rad);`);this.element.style.cssText=S}simpleDraw(u){const m=this.render.getRect(),x=m.pageWidth,S=m.height,P=u===1?m.left+m.pageWidth:m.left,M=m.top;this.element.classList.add("--simple"),this.element.style.cssText=`
            position: absolute; 
            display: block; 
            height: ${S}px; 
            left: ${P}px; 
            top: ${M}px; 
            width: ${x}px; 
            z-index: ${this.render.getSettings().startZIndex+1};`}getElement(){return this.element}load(){this.isLoad=!0}setOrientation(u){super.setOrientation(u),this.element.classList.remove("--left","--right"),this.element.classList.add(u===1?"--right":"--left")}setDrawingDensity(u){this.element.classList.remove("--soft","--hard"),this.element.classList.add("--"+u),super.setDrawingDensity(u)}}class h extends n{constructor(u,m,x,S){super(u,m),this.element=x,this.pagesElement=S}load(){for(const u of this.pagesElement){const m=new l(this.render,u,u.dataset.density==="hard"?"hard":"soft");m.load(),this.pages.push(m)}this.createSpread()}}class c{constructor(u,m,x,S){this.direction=u,this.corner=m,this.topIntersectPoint=null,this.sideIntersectPoint=null,this.bottomIntersectPoint=null,this.pageWidth=parseInt(x,10),this.pageHeight=parseInt(S,10)}calc(u){try{return this.position=this.calcAngleAndPosition(u),this.calculateIntersectPoint(this.position),!0}catch{return!1}}getFlippingClipArea(){const u=[];let m=!1;return u.push(this.rect.topLeft),u.push(this.topIntersectPoint),this.sideIntersectPoint===null?m=!0:(u.push(this.sideIntersectPoint),this.bottomIntersectPoint===null&&(m=!1)),u.push(this.bottomIntersectPoint),(m||this.corner==="bottom")&&u.push(this.rect.bottomLeft),u}getBottomClipArea(){const u=[];return u.push(this.topIntersectPoint),this.corner==="top"?u.push({x:this.pageWidth,y:0}):(this.topIntersectPoint!==null&&u.push({x:this.pageWidth,y:0}),u.push({x:this.pageWidth,y:this.pageHeight})),this.sideIntersectPoint!==null?o.GetDistanceBetweenTwoPoint(this.sideIntersectPoint,this.topIntersectPoint)>=10&&u.push(this.sideIntersectPoint):this.corner==="top"&&u.push({x:this.pageWidth,y:this.pageHeight}),u.push(this.bottomIntersectPoint),u.push(this.topIntersectPoint),u}getAngle(){return this.direction===0?-this.angle:this.angle}getRect(){return this.rect}getPosition(){return this.position}getActiveCorner(){return this.direction===0?this.rect.topLeft:this.rect.topRight}getDirection(){return this.direction}getFlippingProgress(){return Math.abs((this.position.x-this.pageWidth)/(2*this.pageWidth)*100)}getCorner(){return this.corner}getBottomPagePosition(){return this.direction===1?{x:this.pageWidth,y:0}:{x:0,y:0}}getShadowStartPoint(){return this.corner==="top"?this.topIntersectPoint:this.sideIntersectPoint!==null?this.sideIntersectPoint:this.topIntersectPoint}getShadowAngle(){const u=o.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(),[{x:0,y:0},{x:this.pageWidth,y:0}]);return this.direction===0?u:Math.PI-u}calcAngleAndPosition(u){let m=u;if(this.updateAngleAndGeometry(m),m=this.corner==="top"?this.checkPositionAtCenterLine(m,{x:0,y:0},{x:0,y:this.pageHeight}):this.checkPositionAtCenterLine(m,{x:0,y:this.pageHeight},{x:0,y:0}),Math.abs(m.x-this.pageWidth)<1&&Math.abs(m.y)<1)throw new Error("Point is too small");return m}updateAngleAndGeometry(u){this.angle=this.calculateAngle(u),this.rect=this.getPageRect(u)}calculateAngle(u){const m=this.pageWidth-u.x+1,x=this.corner==="bottom"?this.pageHeight-u.y:u.y;let S=2*Math.acos(m/Math.sqrt(x*x+m*m));x<0&&(S=-S);const P=Math.PI-S;if(!isFinite(S)||P>=0&&P<.003)throw new Error("The G point is too small");return this.corner==="bottom"&&(S=-S),S}getPageRect(u){return this.corner==="top"?this.getRectFromBasePoint([{x:0,y:0},{x:this.pageWidth,y:0},{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}],u):this.getRectFromBasePoint([{x:0,y:-this.pageHeight},{x:this.pageWidth,y:-this.pageHeight},{x:0,y:0},{x:this.pageWidth,y:0}],u)}getRectFromBasePoint(u,m){return{topLeft:this.getRotatedPoint(u[0],m),topRight:this.getRotatedPoint(u[1],m),bottomLeft:this.getRotatedPoint(u[2],m),bottomRight:this.getRotatedPoint(u[3],m)}}getRotatedPoint(u,m){return{x:u.x*Math.cos(this.angle)+u.y*Math.sin(this.angle)+m.x,y:u.y*Math.cos(this.angle)-u.x*Math.sin(this.angle)+m.y}}calculateIntersectPoint(u){const m={left:-1,top:-1,width:this.pageWidth+2,height:this.pageHeight+2};this.corner==="top"?(this.topIntersectPoint=o.GetIntersectBetweenTwoSegment(m,[u,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=o.GetIntersectBetweenTwoSegment(m,[u,this.rect.bottomLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=o.GetIntersectBetweenTwoSegment(m,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}])):(this.topIntersectPoint=o.GetIntersectBetweenTwoSegment(m,[this.rect.topLeft,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=o.GetIntersectBetweenTwoSegment(m,[u,this.rect.topLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=o.GetIntersectBetweenTwoSegment(m,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}]))}checkPositionAtCenterLine(u,m,x){let S=u;const P=o.LimitPointToCircle(m,this.pageWidth,S);S!==P&&(S=P,this.updateAngleAndGeometry(S));const M=Math.sqrt(Math.pow(this.pageWidth,2)+Math.pow(this.pageHeight,2));let I=this.rect.bottomRight,k=this.rect.topLeft;if(this.corner==="bottom"&&(I=this.rect.topRight,k=this.rect.bottomLeft),I.x<=0){const U=o.LimitPointToCircle(x,M,k);U!==S&&(S=U,this.updateAngleAndGeometry(S))}return S}getSegmentToShadowLine(){const u=this.getShadowStartPoint();return[u,u!==this.sideIntersectPoint&&this.sideIntersectPoint!==null?this.sideIntersectPoint:this.bottomIntersectPoint]}}class f{constructor(u,m){this.flippingPage=null,this.bottomPage=null,this.calc=null,this.state="read",this.render=u,this.app=m}fold(u){this.setState("user_fold"),this.calc===null&&this.start(u),this.do(this.render.convertToPage(u))}flip(u){if(this.app.getSettings().disableFlipByClick&&!this.isPointOnCorners(u)||(this.calc!==null&&this.render.finishAnimation(),!this.start(u)))return;const m=this.getBoundsRect();this.setState("flipping");const x=m.height/10,S=this.calc.getCorner()==="bottom"?m.height-x:x,P=this.calc.getCorner()==="bottom"?m.height:0;this.calc.calc({x:m.pageWidth-x,y:S}),this.animateFlippingTo({x:m.pageWidth-x,y:S},{x:-m.pageWidth,y:P},!0)}start(u){this.reset();const m=this.render.convertToBook(u),x=this.getBoundsRect(),S=this.getDirectionByPoint(m),P=m.y>=x.height/2?"bottom":"top";if(!this.checkDirection(S))return!1;try{if(this.flippingPage=this.app.getPageCollection().getFlippingPage(S),this.bottomPage=this.app.getPageCollection().getBottomPage(S),this.render.getOrientation()==="landscape")if(S===1){const M=this.app.getPageCollection().nextBy(this.flippingPage);M!==null&&this.flippingPage.getDensity()!==M.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),M.setDrawingDensity("hard"))}else{const M=this.app.getPageCollection().prevBy(this.flippingPage);M!==null&&this.flippingPage.getDensity()!==M.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),M.setDrawingDensity("hard"))}return this.render.setDirection(S),this.calc=new c(S,P,x.pageWidth.toString(10),x.height.toString(10)),!0}catch{return!1}}do(u){if(this.calc!==null&&this.calc.calc(u)){const m=this.calc.getFlippingProgress();this.bottomPage.setArea(this.calc.getBottomClipArea()),this.bottomPage.setPosition(this.calc.getBottomPagePosition()),this.bottomPage.setAngle(0),this.bottomPage.setHardAngle(0),this.flippingPage.setArea(this.calc.getFlippingClipArea()),this.flippingPage.setPosition(this.calc.getActiveCorner()),this.flippingPage.setAngle(this.calc.getAngle()),this.calc.getDirection()===0?this.flippingPage.setHardAngle(90*(200-2*m)/100):this.flippingPage.setHardAngle(-90*(200-2*m)/100),this.render.setPageRect(this.calc.getRect()),this.render.setBottomPage(this.bottomPage),this.render.setFlippingPage(this.flippingPage),this.render.setShadowData(this.calc.getShadowStartPoint(),this.calc.getShadowAngle(),m,this.calc.getDirection())}}flipToPage(u,m){const x=this.app.getPageCollection().getCurrentSpreadIndex(),S=this.app.getPageCollection().getSpreadIndexByPage(u);try{S>x&&(this.app.getPageCollection().setCurrentSpreadIndex(S-1),this.flipNext(m)),S<x&&(this.app.getPageCollection().setCurrentSpreadIndex(S+1),this.flipPrev(m))}catch{}}flipNext(u){this.flip({x:this.render.getRect().left+2*this.render.getRect().pageWidth-10,y:u==="top"?1:this.render.getRect().height-2})}flipPrev(u){this.flip({x:10,y:u==="top"?1:this.render.getRect().height-2})}stopMove(){if(this.calc===null)return;const u=this.calc.getPosition(),m=this.getBoundsRect(),x=this.calc.getCorner()==="bottom"?m.height:0;u.x<=0?this.animateFlippingTo(u,{x:-m.pageWidth,y:x},!0):this.animateFlippingTo(u,{x:m.pageWidth,y:x},!1)}showCorner(u){if(!this.checkState("read","fold_corner"))return;const m=this.getBoundsRect(),x=m.pageWidth;if(this.isPointOnCorners(u))if(this.calc===null){if(!this.start(u))return;this.setState("fold_corner"),this.calc.calc({x:x-1,y:1});const S=50,P=this.calc.getCorner()==="bottom"?m.height-1:1,M=this.calc.getCorner()==="bottom"?m.height-S:S;this.animateFlippingTo({x:x-1,y:P},{x:x-S,y:M},!1,!1)}else this.do(this.render.convertToPage(u));else this.setState("read"),this.render.finishAnimation(),this.stopMove()}animateFlippingTo(u,m,x,S=!0){const P=o.GetCordsFromTwoPoint(u,m),M=[];for(const k of P)M.push(()=>this.do(k));const I=this.getAnimationDuration(P.length);this.render.startAnimation(M,I,()=>{this.calc&&(x&&(this.calc.getDirection()===1?this.app.turnToPrevPage():this.app.turnToNextPage()),S&&(this.render.setBottomPage(null),this.render.setFlippingPage(null),this.render.clearShadow(),this.setState("read"),this.reset()))})}getCalculation(){return this.calc}getState(){return this.state}setState(u){this.state!==u&&(this.app.updateState(u),this.state=u)}getDirectionByPoint(u){const m=this.getBoundsRect();if(this.render.getOrientation()==="portrait"){if(u.x-m.pageWidth<=m.width/5)return 1}else if(u.x<m.width/2)return 1;return 0}getAnimationDuration(u){const m=this.app.getSettings().flippingTime;return u>=1e3?m:u/1e3*m}checkDirection(u){return u===0?this.app.getCurrentPageIndex()<this.app.getPageCount()-1:this.app.getCurrentPageIndex()>=1}reset(){this.calc=null,this.flippingPage=null,this.bottomPage=null}getBoundsRect(){return this.render.getRect()}checkState(...u){for(const m of u)if(this.state===m)return!0;return!1}isPointOnCorners(u){const m=this.getBoundsRect(),x=m.pageWidth,S=Math.sqrt(Math.pow(x,2)+Math.pow(m.height,2))/5,P=this.render.convertToBook(u);return P.x>0&&P.y>0&&P.x<m.width&&P.y<m.height&&(P.x<S||P.x>m.width-S)&&(P.y<S||P.y>m.height-S)}}class p{constructor(u,m){this.leftPage=null,this.rightPage=null,this.flippingPage=null,this.bottomPage=null,this.direction=null,this.orientation=null,this.shadow=null,this.animation=null,this.pageRect=null,this.boundsRect=null,this.timer=0,this.safari=!1,this.setting=m,this.app=u;const x=new RegExp("Version\\/[\\d\\.]+.*Safari/");this.safari=x.exec(window.navigator.userAgent)!==null}render(u){if(this.animation!==null){const m=Math.round((u-this.animation.startedAt)/this.animation.durationFrame);m<this.animation.frames.length?this.animation.frames[m]():(this.animation.onAnimateEnd(),this.animation=null)}this.timer=u,this.drawFrame()}start(){this.update();const u=m=>{this.render(m),requestAnimationFrame(u)};requestAnimationFrame(u)}startAnimation(u,m,x){this.finishAnimation(),this.animation={frames:u,duration:m,durationFrame:m/u.length,onAnimateEnd:x,startedAt:this.timer}}finishAnimation(){this.animation!==null&&(this.animation.frames[this.animation.frames.length-1](),this.animation.onAnimateEnd!==null&&this.animation.onAnimateEnd()),this.animation=null}update(){this.boundsRect=null;const u=this.calculateBoundsRect();this.orientation!==u&&(this.orientation=u,this.app.updateOrientation(u))}calculateBoundsRect(){let u="landscape";const m=this.getBlockWidth(),x=m/2,S=this.getBlockHeight()/2,P=this.setting.width/this.setting.height;let M=this.setting.width,I=this.setting.height,k=x-M;return this.setting.size==="stretch"?(m<2*this.setting.minWidth&&this.app.getSettings().usePortrait&&(u="portrait"),M=u==="portrait"?this.getBlockWidth():this.getBlockWidth()/2,M>this.setting.maxWidth&&(M=this.setting.maxWidth),I=M/P,I>this.getBlockHeight()&&(I=this.getBlockHeight(),M=I*P),k=u==="portrait"?x-M/2-M:x-M):m<2*M&&this.app.getSettings().usePortrait&&(u="portrait",k=x-M/2-M),this.boundsRect={left:k,top:S-I/2,width:2*M,height:I,pageWidth:M},u}setShadowData(u,m,x,S){if(!this.app.getSettings().drawShadow)return;const P=100*this.getSettings().maxShadowOpacity;this.shadow={pos:u,angle:m,width:3*this.getRect().pageWidth/4*x/100,opacity:(100-x)*P/100/100,direction:S,progress:2*x}}clearShadow(){this.shadow=null}getBlockWidth(){return this.app.getUI().getDistElement().offsetWidth}getBlockHeight(){return this.app.getUI().getDistElement().offsetHeight}getDirection(){return this.direction}getRect(){return this.boundsRect===null&&this.calculateBoundsRect(),this.boundsRect}getSettings(){return this.app.getSettings()}getOrientation(){return this.orientation}setPageRect(u){this.pageRect=u}setDirection(u){this.direction=u}setRightPage(u){u!==null&&u.setOrientation(1),this.rightPage=u}setLeftPage(u){u!==null&&u.setOrientation(0),this.leftPage=u}setBottomPage(u){u!==null&&u.setOrientation(this.direction===1?0:1),this.bottomPage=u}setFlippingPage(u){u!==null&&u.setOrientation(this.direction===0&&this.orientation!=="portrait"?0:1),this.flippingPage=u}convertToBook(u){const m=this.getRect();return{x:u.x-m.left,y:u.y-m.top}}isSafari(){return this.safari}convertToPage(u,m){m||(m=this.direction);const x=this.getRect();return{x:m===0?u.x-x.left-x.width/2:x.width/2-u.x+x.left,y:u.y-x.top}}convertToGlobal(u,m){if(m||(m=this.direction),u==null)return null;const x=this.getRect();return{x:m===0?u.x+x.left+x.width/2:x.width/2-u.x+x.left,y:u.y+x.top}}convertRectToGlobal(u,m){return m||(m=this.direction),{topLeft:this.convertToGlobal(u.topLeft,m),topRight:this.convertToGlobal(u.topRight,m),bottomLeft:this.convertToGlobal(u.bottomLeft,m),bottomRight:this.convertToGlobal(u.bottomRight,m)}}}class y extends p{constructor(u,m,x){super(u,m),this.canvas=x,this.ctx=x.getContext("2d")}getContext(){return this.ctx}reload(){}drawFrame(){this.clear(),this.orientation!=="portrait"&&this.leftPage!=null&&this.leftPage.simpleDraw(0),this.rightPage!=null&&this.rightPage.simpleDraw(1),this.bottomPage!=null&&this.bottomPage.draw(),this.drawBookShadow(),this.flippingPage!=null&&this.flippingPage.draw(),this.shadow!=null&&(this.drawOuterShadow(),this.drawInnerShadow());const u=this.getRect();this.orientation==="portrait"&&(this.ctx.beginPath(),this.ctx.rect(u.left+u.pageWidth,u.top,u.width,u.height),this.ctx.clip())}drawBookShadow(){const u=this.getRect();this.ctx.save(),this.ctx.beginPath();const m=u.width/20;this.ctx.rect(u.left,u.top,u.width,u.height);const x={x:u.left+u.width/2-m/2,y:0};this.ctx.translate(x.x,x.y);const S=this.ctx.createLinearGradient(0,0,m,0);S.addColorStop(0,"rgba(0, 0, 0, 0)"),S.addColorStop(.4,"rgba(0, 0, 0, 0.2)"),S.addColorStop(.49,"rgba(0, 0, 0, 0.1)"),S.addColorStop(.5,"rgba(0, 0, 0, 0.5)"),S.addColorStop(.51,"rgba(0, 0, 0, 0.4)"),S.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.clip(),this.ctx.fillStyle=S,this.ctx.fillRect(0,0,m,2*u.height),this.ctx.restore()}drawOuterShadow(){const u=this.getRect();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(u.left,u.top,u.width,u.height);const m=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y});this.ctx.translate(m.x,m.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const x=this.ctx.createLinearGradient(0,0,this.shadow.width,0);this.shadow.direction===0?(this.ctx.translate(0,-100),x.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),x.addColorStop(1,"rgba(0, 0, 0, 0)")):(this.ctx.translate(-this.shadow.width,-100),x.addColorStop(0,"rgba(0, 0, 0, 0)"),x.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")")),this.ctx.clip(),this.ctx.fillStyle=x,this.ctx.fillRect(0,0,this.shadow.width,2*u.height),this.ctx.restore()}drawInnerShadow(){const u=this.getRect();this.ctx.save(),this.ctx.beginPath();const m=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),x=this.convertRectToGlobal(this.pageRect);this.ctx.moveTo(x.topLeft.x,x.topLeft.y),this.ctx.lineTo(x.topRight.x,x.topRight.y),this.ctx.lineTo(x.bottomRight.x,x.bottomRight.y),this.ctx.lineTo(x.bottomLeft.x,x.bottomLeft.y),this.ctx.translate(m.x,m.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const S=3*this.shadow.width/4,P=this.ctx.createLinearGradient(0,0,S,0);this.shadow.direction===0?(this.ctx.translate(-S,-100),P.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")"),P.addColorStop(.9,"rgba(0, 0, 0, 0.05)"),P.addColorStop(.7,"rgba(0, 0, 0, "+this.shadow.opacity+")"),P.addColorStop(0,"rgba(0, 0, 0, 0)")):(this.ctx.translate(0,-100),P.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),P.addColorStop(.1,"rgba(0, 0, 0, 0.05)"),P.addColorStop(.3,"rgba(0, 0, 0, "+this.shadow.opacity+")"),P.addColorStop(1,"rgba(0, 0, 0, 0)")),this.ctx.clip(),this.ctx.fillStyle=P,this.ctx.fillRect(0,0,S,2*u.height),this.ctx.restore()}clear(){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}}class v{constructor(u,m,x){this.touchPoint=null,this.swipeTimeout=250,this.onResize=()=>{this.update()},this.onMouseDown=P=>{if(this.checkTarget(P.target)){const M=this.getMousePos(P.clientX,P.clientY);this.app.startUserTouch(M),P.preventDefault()}},this.onTouchStart=P=>{if(this.checkTarget(P.target)&&P.changedTouches.length>0){const M=P.changedTouches[0],I=this.getMousePos(M.clientX,M.clientY);this.touchPoint={point:I,time:Date.now()},setTimeout(()=>{this.touchPoint!==null&&this.app.startUserTouch(I)},this.swipeTimeout),this.app.getSettings().mobileScrollSupport||P.preventDefault()}},this.onMouseUp=P=>{const M=this.getMousePos(P.clientX,P.clientY);this.app.userStop(M)},this.onMouseMove=P=>{const M=this.getMousePos(P.clientX,P.clientY);this.app.userMove(M,!1)},this.onTouchMove=P=>{if(P.changedTouches.length>0){const M=P.changedTouches[0],I=this.getMousePos(M.clientX,M.clientY);this.app.getSettings().mobileScrollSupport?(this.touchPoint!==null&&(Math.abs(this.touchPoint.point.x-I.x)>10||this.app.getState()!=="read")&&P.cancelable&&this.app.userMove(I,!0),this.app.getState()!=="read"&&P.preventDefault()):this.app.userMove(I,!0)}},this.onTouchEnd=P=>{if(P.changedTouches.length>0){const M=P.changedTouches[0],I=this.getMousePos(M.clientX,M.clientY);let k=!1;if(this.touchPoint!==null){const U=I.x-this.touchPoint.point.x,$=Math.abs(I.y-this.touchPoint.point.y);Math.abs(U)>this.swipeDistance&&$<2*this.swipeDistance&&Date.now()-this.touchPoint.time<this.swipeTimeout&&(U>0?this.app.flipPrev(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"):this.app.flipNext(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"),k=!0),this.touchPoint=null}this.app.userStop(I,k)}},this.parentElement=u,u.classList.add("stf__parent"),u.insertAdjacentHTML("afterbegin",'<div class="stf__wrapper"></div>'),this.wrapper=u.querySelector(".stf__wrapper"),this.app=m;const S=this.app.getSettings().usePortrait?1:2;u.style.minWidth=x.minWidth*S+"px",u.style.minHeight=x.minHeight+"px",x.size==="fixed"&&(u.style.minWidth=x.width*S+"px",u.style.minHeight=x.height+"px"),x.autoSize&&(u.style.width="100%",u.style.maxWidth=2*x.maxWidth+"px"),u.style.display="block",window.addEventListener("resize",this.onResize,!1),this.swipeDistance=x.swipeDistance}destroy(){this.app.getSettings().useMouseEvents&&this.removeHandlers(),this.distElement.remove(),this.wrapper.remove()}getDistElement(){return this.distElement}getWrapper(){return this.wrapper}setOrientationStyle(u){this.wrapper.classList.remove("--portrait","--landscape"),u==="portrait"?(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/this.app.getSettings().width*100+"%"),this.wrapper.classList.add("--portrait")):(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/(2*this.app.getSettings().width)*100+"%"),this.wrapper.classList.add("--landscape")),this.update()}removeHandlers(){window.removeEventListener("resize",this.onResize),this.distElement.removeEventListener("mousedown",this.onMouseDown),this.distElement.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onTouchEnd)}setHandlers(){window.addEventListener("resize",this.onResize,!1),this.app.getSettings().useMouseEvents&&(this.distElement.addEventListener("mousedown",this.onMouseDown),this.distElement.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!this.app.getSettings().mobileScrollSupport}),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onTouchEnd))}getMousePos(u,m){const x=this.distElement.getBoundingClientRect();return{x:u-x.left,y:m-x.top}}checkTarget(u){return!this.app.getSettings().clickEventForward||!["a","button"].includes(u.tagName.toLowerCase())}}class A extends v{constructor(u,m,x,S){super(u,m,x),this.wrapper.insertAdjacentHTML("afterbegin",'<div class="stf__block"></div>'),this.distElement=u.querySelector(".stf__block"),this.items=S;for(const P of S)this.distElement.appendChild(P);this.setHandlers()}clear(){for(const u of this.items)this.parentElement.appendChild(u)}updateItems(u){this.removeHandlers(),this.distElement.innerHTML="";for(const m of u)this.distElement.appendChild(m);this.items=u,this.setHandlers()}update(){this.app.getRender().update()}}class _ extends v{constructor(u,m,x){super(u,m,x),this.wrapper.innerHTML='<canvas class="stf__canvas"></canvas>',this.canvas=u.querySelectorAll("canvas")[0],this.distElement=this.canvas,this.resizeCanvas(),this.setHandlers()}resizeCanvas(){const u=getComputedStyle(this.canvas),m=parseInt(u.getPropertyValue("width"),10),x=parseInt(u.getPropertyValue("height"),10);this.canvas.width=m,this.canvas.height=x}getCanvas(){return this.canvas}update(){this.resizeCanvas(),this.app.getRender().update()}}class C extends p{constructor(u,m,x){super(u,m),this.outerShadow=null,this.innerShadow=null,this.hardShadow=null,this.hardInnerShadow=null,this.element=x,this.createShadows()}createShadows(){this.element.insertAdjacentHTML("beforeend",`<div class="stf__outerShadow"></div>
             <div class="stf__innerShadow"></div>
             <div class="stf__hardShadow"></div>
             <div class="stf__hardInnerShadow"></div>`),this.outerShadow=this.element.querySelector(".stf__outerShadow"),this.innerShadow=this.element.querySelector(".stf__innerShadow"),this.hardShadow=this.element.querySelector(".stf__hardShadow"),this.hardInnerShadow=this.element.querySelector(".stf__hardInnerShadow")}clearShadow(){super.clearShadow(),this.outerShadow.style.cssText="display: none",this.innerShadow.style.cssText="display: none",this.hardShadow.style.cssText="display: none",this.hardInnerShadow.style.cssText="display: none"}reload(){this.element.querySelector(".stf__outerShadow")||this.createShadows()}drawHardInnerShadow(){const u=this.getRect(),m=this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress;let x=(100-m)*(2.5*u.pageWidth)/100+20;x>u.pageWidth&&(x=u.pageWidth);let S=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+5).toString(10)};
            width: ${x}px;
            height: ${u.height}px;
            background: linear-gradient(to right,
                rgba(0, 0, 0, ${this.shadow.opacity*m/100}) 5%,
                rgba(0, 0, 0, 0) 100%);
            left: ${u.left+u.width/2}px;
            transform-origin: 0 0;
        `;S+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0);":"transform: translate3d(0, 0, 0) rotateY(180deg);",this.hardInnerShadow.style.cssText=S}drawHardOuterShadow(){const u=this.getRect();let m=(100-(this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress))*(2.5*u.pageWidth)/100+20;m>u.pageWidth&&(m=u.pageWidth);let x=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+4).toString(10)};
            width: ${m}px;
            height: ${u.height}px;
            background: linear-gradient(to left, rgba(0, 0, 0, ${this.shadow.opacity}) 5%, rgba(0, 0, 0, 0) 100%);
            left: ${u.left+u.width/2}px;
            transform-origin: 0 0;
        `;x+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0) rotateY(180deg);":"transform: translate3d(0, 0, 0);",this.hardShadow.style.cssText=x}drawInnerShadow(){const u=this.getRect(),m=3*this.shadow.width/4,x=this.getDirection()===0?m:0,S=this.getDirection()===0?"to left":"to right",P=this.convertToGlobal(this.shadow.pos),M=this.shadow.angle+3*Math.PI/2,I=[this.pageRect.topLeft,this.pageRect.topRight,this.pageRect.bottomRight,this.pageRect.bottomLeft];let k="polygon( ";for(const $ of I){let W=this.getDirection()===1?{x:-$.x+this.shadow.pos.x,y:$.y-this.shadow.pos.y}:{x:$.x-this.shadow.pos.x,y:$.y-this.shadow.pos.y};W=o.GetRotatedPoint(W,{x,y:100},M),k+=W.x+"px "+W.y+"px, "}k=k.slice(0,-2),k+=")";const U=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${m}px;
            height: ${2*u.height}px;
            background: linear-gradient(${S},
                rgba(0, 0, 0, ${this.shadow.opacity}) 5%,
                rgba(0, 0, 0, 0.05) 15%,
                rgba(0, 0, 0, ${this.shadow.opacity}) 35%,
                rgba(0, 0, 0, 0) 100%);
            transform-origin: ${x}px 100px;
            transform: translate3d(${P.x-x}px, ${P.y-100}px, 0) rotate(${M}rad);
            clip-path: ${k};
            -webkit-clip-path: ${k};
        `;this.innerShadow.style.cssText=U}drawOuterShadow(){const u=this.getRect(),m=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),x=this.shadow.angle+3*Math.PI/2,S=this.getDirection()===1?this.shadow.width:0,P=this.getDirection()===0?"to right":"to left",M=[{x:0,y:0},{x:u.pageWidth,y:0},{x:u.pageWidth,y:u.height},{x:0,y:u.height}];let I="polygon( ";for(const U of M)if(U!==null){let $=this.getDirection()===1?{x:-U.x+this.shadow.pos.x,y:U.y-this.shadow.pos.y}:{x:U.x-this.shadow.pos.x,y:U.y-this.shadow.pos.y};$=o.GetRotatedPoint($,{x:S,y:100},x),I+=$.x+"px "+$.y+"px, "}I=I.slice(0,-2),I+=")";const k=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${this.shadow.width}px;
            height: ${2*u.height}px;
            background: linear-gradient(${P}, rgba(0, 0, 0, ${this.shadow.opacity}), rgba(0, 0, 0, 0));
            transform-origin: ${S}px 100px;
            transform: translate3d(${m.x-S}px, ${m.y-100}px, 0) rotate(${x}rad);
            clip-path: ${I};
            -webkit-clip-path: ${I};
        `;this.outerShadow.style.cssText=k}drawLeftPage(){this.orientation!=="portrait"&&this.leftPage!==null&&(this.direction===1&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.leftPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.leftPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.leftPage.draw(this.flippingPage.getDrawingDensity())):this.leftPage.simpleDraw(0))}drawRightPage(){this.rightPage!==null&&(this.direction===0&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.rightPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.rightPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.rightPage.draw(this.flippingPage.getDrawingDensity())):this.rightPage.simpleDraw(1))}drawBottomPage(){if(this.bottomPage===null)return;const u=this.flippingPage!=null?this.flippingPage.getDrawingDensity():null;this.orientation==="portrait"&&this.direction===1||(this.bottomPage.getElement().style.zIndex=(this.getSettings().startZIndex+3).toString(10),this.bottomPage.draw(u))}drawFrame(){this.clear(),this.drawLeftPage(),this.drawRightPage(),this.drawBottomPage(),this.flippingPage!=null&&(this.flippingPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.flippingPage.draw()),this.shadow!=null&&this.flippingPage!==null&&(this.flippingPage.getDrawingDensity()==="soft"?(this.drawOuterShadow(),this.drawInnerShadow()):(this.drawHardOuterShadow(),this.drawHardInnerShadow()))}clear(){for(const u of this.app.getPageCollection().getPages())u!==this.leftPage&&u!==this.rightPage&&u!==this.flippingPage&&u!==this.bottomPage&&(u.getElement().style.cssText="display: none"),u.getTemporaryCopy()!==this.flippingPage&&u.hideTemporaryCopy()}update(){super.update(),this.rightPage!==null&&this.rightPage.setOrientation(1),this.leftPage!==null&&this.leftPage.setOrientation(0)}}class T{constructor(){this._default={startPage:0,size:"fixed",width:0,height:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,drawShadow:!0,flippingTime:1e3,usePortrait:!0,startZIndex:0,autoSize:!0,maxShadowOpacity:1,showCover:!1,mobileScrollSupport:!0,swipeDistance:30,clickEventForward:!0,useMouseEvents:!0,showPageCorners:!0,disableFlipByClick:!1}}getSettings(u){const m=this._default;if(Object.assign(m,u),m.size!=="stretch"&&m.size!=="fixed")throw new Error('Invalid size type. Available only "fixed" and "stretch" value');if(m.width<=0||m.height<=0)throw new Error("Invalid width or height");if(m.flippingTime<=0)throw new Error("Invalid flipping time");return m.size==="stretch"?(m.minWidth<=0&&(m.minWidth=100),m.maxWidth<m.minWidth&&(m.maxWidth=2e3),m.minHeight<=0&&(m.minHeight=100),m.maxHeight<m.minHeight&&(m.maxHeight=2e3)):(m.minWidth=m.width,m.maxWidth=m.width,m.minHeight=m.height,m.maxHeight=m.height),m}}(function(E,u){u===void 0&&(u={});var m=u.insertAt;if(typeof document<"u"){var x=document.head||document.getElementsByTagName("head")[0],S=document.createElement("style");S.type="text/css",m==="top"&&x.firstChild?x.insertBefore(S,x.firstChild):x.appendChild(S),S.styleSheet?S.styleSheet.cssText=E:S.appendChild(document.createTextNode(E))}})(`.stf__parent {
  position: relative;
  display: block;
  box-sizing: border-box;
  transform: translateZ(0);

  -ms-touch-action: pan-y;
  touch-action: pan-y;
}

.sft__wrapper {
  position: relative;
  width: 100%;
  box-sizing: border-box;
}

.stf__parent canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}

.stf__block {
  position: absolute;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  perspective: 2000px;
}

.stf__item {
  display: none;
  position: absolute;
  transform-style: preserve-3d;
}

.stf__outerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__innerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardInnerShadow {
  position: absolute;
  left: 0;
  top: 0;
}`),e.PageFlip=class extends class{constructor(){this.events=new Map}on(E,u){return this.events.has(E)?this.events.get(E).push(u):this.events.set(E,[u]),this}off(E){this.events.delete(E)}trigger(E,u,m=null){if(this.events.has(E))for(const x of this.events.get(E))x({data:m,object:u})}}{constructor(E,u){super(),this.isUserTouch=!1,this.isUserMove=!1,this.setting=null,this.pages=null,this.setting=new T().getSettings(u),this.block=E}destroy(){this.ui.destroy(),this.block.remove()}update(){this.render.update(),this.pages.show()}loadFromImages(E){this.ui=new _(this.block,this,this.setting);const u=this.ui.getCanvas();this.render=new y(this,this.setting,u),this.flipController=new f(this.render,this),this.pages=new a(this,this.render,E),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}loadFromHTML(E){this.ui=new A(this.block,this,this.setting,E),this.render=new C(this,this.setting,this.ui.getDistElement()),this.flipController=new f(this.render,this),this.pages=new h(this,this.render,this.ui.getDistElement(),E),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}updateFromImages(E){const u=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new a(this,this.render,E),this.pages.load(),this.pages.show(u),this.trigger("update",this,{page:u,mode:this.render.getOrientation()})}updateFromHtml(E){const u=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new h(this,this.render,this.ui.getDistElement(),E),this.pages.load(),this.ui.updateItems(E),this.render.reload(),this.pages.show(u),this.trigger("update",this,{page:u,mode:this.render.getOrientation()})}clear(){this.pages.destroy(),this.ui.clear()}turnToPrevPage(){this.pages.showPrev()}turnToNextPage(){this.pages.showNext()}turnToPage(E){this.pages.show(E)}flipNext(E="top"){this.flipController.flipNext(E)}flipPrev(E="top"){this.flipController.flipPrev(E)}flip(E,u="top"){this.flipController.flipToPage(E,u)}updateState(E){this.trigger("changeState",this,E)}updatePageIndex(E){this.trigger("flip",this,E)}updateOrientation(E){this.ui.setOrientationStyle(E),this.update(),this.trigger("changeOrientation",this,E)}getPageCount(){return this.pages.getPageCount()}getCurrentPageIndex(){return this.pages.getCurrentPageIndex()}getPage(E){return this.pages.getPage(E)}getRender(){return this.render}getFlipController(){return this.flipController}getOrientation(){return this.render.getOrientation()}getBoundsRect(){return this.render.getRect()}getSettings(){return this.setting}getUI(){return this.ui}getState(){return this.flipController.getState()}getPageCollection(){return this.pages}startUserTouch(E){this.mousePosition=E,this.isUserTouch=!0,this.isUserMove=!1}userMove(E,u){this.isUserTouch||u||!this.setting.showPageCorners?this.isUserTouch&&o.GetDistanceBetweenTwoPoint(this.mousePosition,E)>5&&(this.isUserMove=!0,this.flipController.fold(E)):this.flipController.showCorner(E)}userStop(E,u=!1){this.isUserTouch&&(this.isUserTouch=!1,u||(this.isUserMove?this.flipController.stopMove():this.flipController.flip(E)))}},Object.defineProperty(e,"__esModule",{value:!0})})}(fo,fo.exports)),fo.exports}var i1=e1();const Bu=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 490 285.96">
  <g id="ochi">
    <g id="ochi6">
      <path d="M245,286c-79,0-304.17-70-230.35-138.22C72.65,94.17,166,0,245,0S417.35,94.17,475.35,147.74C549.17,215.93,324,286,245,286Z" style="fill: #3a3a3a"/>
    </g>
    <circle id="ochi5" cx="245" cy="142.98" r="135" style="fill: #ab2726"/>
    <circle id="ochi4" cx="244.99" cy="142.98" r="90" style="fill: #ffca31"/>
    <path id="ochi3" d="M288.69,200.21a72,72,0,0,1-92.41-4.2" style="fill: none;stroke: #fff;stroke-linecap: round;stroke-linejoin: round;stroke-width: 25.511811023622px;opacity: 0.45"/>
    <circle id="ochi2" cx="244.99" cy="142.98" r="22.5" style="fill: #231f20"/>
    <circle id="ochi1" cx="270.83" cy="124.07" r="22.5" style="fill: #fff;opacity: 0.7000000000000001"/>
  </g>
  <g id="loading">
    <path id="loading12" d="M307.73,34.32,302.2,43.9a4.47,4.47,0,0,1-6,1.71,109.29,109.29,0,0,0-43.9-12.38,4.47,4.47,0,0,1-4.19-4.58l.3-11.06a4.49,4.49,0,0,1,4.74-4.36A129.27,129.27,0,0,1,306,28.14,4.47,4.47,0,0,1,307.73,34.32Z" style="fill: #fff"/>
    <path id="loading11" d="M353.64,80.25l-9.57,5.53a4.46,4.46,0,0,1-6-1.49,110.47,110.47,0,0,0-31.82-32.7,4.47,4.47,0,0,1-1.33-6.06l5.79-9.43A4.47,4.47,0,0,1,317,34.71,130.66,130.66,0,0,1,355.21,74,4.47,4.47,0,0,1,353.64,80.25Z" style="fill: #fff"/>
    <path id="loading10" d="M370.44,143H359.38a4.48,4.48,0,0,1-4.47-4.31,109.08,109.08,0,0,0-11.18-44.22,4.48,4.48,0,0,1,1.88-5.93l9.73-5.26a4.47,4.47,0,0,1,6.13,1.92,129.43,129.43,0,0,1,13.45,53.18A4.48,4.48,0,0,1,370.44,143Z" style="fill: #fff"/>
    <path id="loading9" d="M374.74,151.16A129,129,0,0,1,359.83,204a4.47,4.47,0,0,1-6.18,1.75l-9.58-5.53a4.48,4.48,0,0,1-1.71-6,109.1,109.1,0,0,0,12.39-43.9,4.47,4.47,0,0,1,4.58-4.19l11.06.3A4.47,4.47,0,0,1,374.74,151.16Z" style="fill: #fff"/>
    <path id="loading8" d="M353.28,215A130.75,130.75,0,0,1,314,253.2a4.46,4.46,0,0,1-6.23-1.57l-5.53-9.58a4.47,4.47,0,0,1,1.49-6,110.35,110.35,0,0,0,32.7-31.82,4.47,4.47,0,0,1,6.06-1.34l9.43,5.8A4.48,4.48,0,0,1,353.28,215Z" style="fill: #fff"/>
    <path id="loading7" d="M302.8,259.45a129.27,129.27,0,0,1-53.18,13.45,4.47,4.47,0,0,1-4.62-4.48V257.36a4.46,4.46,0,0,1,4.31-4.46,109.24,109.24,0,0,0,44.22-11.18,4.47,4.47,0,0,1,5.92,1.88l5.27,9.72A4.47,4.47,0,0,1,302.8,259.45Z" style="fill: #fff"/>
    <path id="loading6" d="M241.86,257.31l-.31,11.06a4.48,4.48,0,0,1-4.73,4.36A129.23,129.23,0,0,1,184,257.82a4.46,4.46,0,0,1-1.75-6.18l5.53-9.58a4.46,4.46,0,0,1,6-1.71,109.2,109.2,0,0,0,43.9,12.38A4.48,4.48,0,0,1,241.86,257.31Z" style="fill: #fff"/>
    <path id="loading5" d="M185.1,240.44l-5.79,9.42a4.47,4.47,0,0,1-6.28,1.4A130.72,130.72,0,0,1,134.78,212a4.48,4.48,0,0,1,1.57-6.24l9.58-5.53a4.47,4.47,0,0,1,6,1.49,110.5,110.5,0,0,0,31.82,32.71A4.47,4.47,0,0,1,185.1,240.44Z" style="fill: #fff"/>
    <path id="loading4" d="M144.39,197.45l-9.74,5.26a4.47,4.47,0,0,1-6.13-1.92,129.31,129.31,0,0,1-13.44-53.19,4.47,4.47,0,0,1,4.48-4.62h11.06a4.47,4.47,0,0,1,4.46,4.31,109.49,109.49,0,0,0,11.18,44.23A4.48,4.48,0,0,1,144.39,197.45Z" style="fill: #fff"/>
    <path id="loading3" d="M147.63,91.75a109.25,109.25,0,0,0-12.38,43.9,4.48,4.48,0,0,1-4.58,4.19l-11.07-.3a4.49,4.49,0,0,1-4.35-4.74A129.27,129.27,0,0,1,130.16,82a4.47,4.47,0,0,1,6.18-1.75l9.58,5.53A4.47,4.47,0,0,1,147.63,91.75Z" style="fill: #fff"/>
    <path id="loading2" d="M186.31,49.93A110.54,110.54,0,0,0,153.6,81.76a4.47,4.47,0,0,1-6.06,1.34l-9.43-5.8A4.47,4.47,0,0,1,136.72,71,130.76,130.76,0,0,1,176,32.76a4.48,4.48,0,0,1,6.24,1.57l5.53,9.58A4.48,4.48,0,0,1,186.31,49.93Z" style="fill: #fff"/>
    <path id="loading1" d="M245,17.54V28.6a4.47,4.47,0,0,1-4.31,4.46,109.33,109.33,0,0,0-44.23,11.18,4.48,4.48,0,0,1-5.92-1.87l-5.27-9.73a4.47,4.47,0,0,1,1.92-6.13,129.32,129.32,0,0,1,53.19-13.45A4.47,4.47,0,0,1,245,17.54Z" style="fill: #fff"/>
  </g>
</svg>
`,Uu=`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1050 2000">
  <defs>
    <filter id="filter">
      <feOffset dy="2" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feFlood flood-color="#756060"/>
      <feComposite operator="in" in2="blur"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient" x1="517.61" y1="1850.56" x2="517.61" y2="1767.54" gradientUnits="userSpaceOnUse">
      <stop offset="0" stop-color="#fff"/>
      <stop offset="0.77" stop-color="#efcdcd"/>
      <stop offset="1" stop-color="#eabebe"/>
    </linearGradient>
    <linearGradient id="linear-gradient-2" x1="435.03" y1="1797.15" x2="640.33" y2="1797.15" gradientUnits="userSpaceOnUse">
      <stop offset="0" stop-color="#fff" stop-opacity="0.2"/>
      <stop offset="0.01" stop-color="#fff" stop-opacity="0.22"/>
      <stop offset="0.05" stop-color="#fff" stop-opacity="0.39"/>
      <stop offset="0.1" stop-color="#fff" stop-opacity="0.53"/>
      <stop offset="0.16" stop-color="#fff" stop-opacity="0.66"/>
      <stop offset="0.22" stop-color="#fff" stop-opacity="0.77"/>
      <stop offset="0.29" stop-color="#fff" stop-opacity="0.85"/>
      <stop offset="0.37" stop-color="#fff" stop-opacity="0.92"/>
      <stop offset="0.47" stop-color="#fff" stop-opacity="0.97"/>
      <stop offset="0.61" stop-color="#fff" stop-opacity="0.99"/>
      <stop offset="1" stop-color="#fff"/>
    </linearGradient>
    <linearGradient id="linear-gradient-3" x1="556.88" y1="1834.4" x2="562.82" y2="1834.4" xlink:href="#linear-gradient-2"/>
    <linearGradient id="linear-gradient-4" x1="553.08" y1="1834.94" x2="556.4" y2="1834.94" xlink:href="#linear-gradient-2"/>
    <linearGradient id="linear-gradient-5" x1="543.78" y1="1836.79" x2="551.77" y2="1836.79" xlink:href="#linear-gradient-2"/>
    <linearGradient id="linear-gradient-6" x1="491.34" y1="1838.85" x2="509.16" y2="1838.85" xlink:href="#linear-gradient-2"/>
    <linearGradient id="linear-gradient-7" x1="482.67" y1="1838.14" x2="505.35" y2="1838.14" xlink:href="#linear-gradient-2"/>
    <linearGradient id="linear-gradient-8" x1="454.45" y1="1831.65" x2="489.37" y2="1831.65" xlink:href="#linear-gradient-2"/>
    <linearGradient id="linear-gradient-9" x1="514.84" y1="1822.04" x2="521.88" y2="1822.04" xlink:href="#linear-gradient-2"/>
    <linearGradient id="linear-gradient-10" x1="509.28" y1="1820.83" x2="518.26" y2="1821.83" xlink:href="#linear-gradient-2"/>
    <linearGradient id="linear-gradient-11" x1="484.11" y1="1815.69" x2="494.57" y2="1815.69" xlink:href="#linear-gradient-2"/>
    <linearGradient id="linear-gradient-12" x1="564.51" y1="1818.73" x2="573.39" y2="1818.73" xlink:href="#linear-gradient-2"/>
    <filter id="filter-2">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-2"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-2"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-13" x1="630.23" y1="1555.9" x2="630.23" y2="948.38" gradientUnits="userSpaceOnUse">
      <stop offset="0" stop-color="#606060"/>
      <stop offset="0.29" stop-color="#484848"/>
      <stop offset="0.89" stop-color="#0c0c0c"/>
      <stop offset="1"/>
    </linearGradient>
    <linearGradient id="linear-gradient-14" x1="628.23" y1="1234.61" x2="632.23" y2="1234.61" gradientUnits="userSpaceOnUse">
      <stop offset="0" stop-color="#fff" stop-opacity="0"/>
      <stop offset="0.24" stop-color="#fff" stop-opacity="0.5"/>
      <stop offset="0.42" stop-color="#fff" stop-opacity="0.86"/>
      <stop offset="0.5" stop-color="#fff"/>
      <stop offset="1" stop-color="#f6e4e4" stop-opacity="0"/>
    </linearGradient>
    <filter id="filter-3" x="598" y="928.16" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-3"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-3"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-4">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-4"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-4"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-15" x1="560.23" y1="1668.19" x2="560.23" y2="1060.67" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-16" x1="558.23" y1="1346.9" x2="562.23" y2="1346.9" xlink:href="#linear-gradient-14"/>
    <filter id="filter-5" x="528" y="1040.45" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-5"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-5"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-6">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-6"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-6"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-17" x1="490.23" y1="1668.19" x2="490.23" y2="1060.67" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-18" x1="488.23" y1="1346.9" x2="492.23" y2="1346.9" xlink:href="#linear-gradient-14"/>
    <filter id="filter-7" x="458" y="1040.45" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-7"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-7"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-8">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-8"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-8"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-19" x1="420.23" y1="1555.36" x2="420.23" y2="947.84" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-20" x1="418.23" y1="1234.07" x2="422.23" y2="1234.07" xlink:href="#linear-gradient-14"/>
    <filter id="filter-9" x="388" y="927.62" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-9"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-9"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-10">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-10"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-10"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-21" x1="734.32" y1="1366.03" x2="734.32" y2="759.29" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-22" x1="732.33" y1="1045.15" x2="736.32" y2="1045.15" xlink:href="#linear-gradient-14"/>
    <filter id="filter-11" x="702" y="738.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-11"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-11"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-12">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-12"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-12"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-23" x1="664.32" y1="1450.68" x2="664.32" y2="843.93" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-24" x1="662.33" y1="1129.8" x2="666.32" y2="1129.8" xlink:href="#linear-gradient-14"/>
    <filter id="filter-13" x="632" y="823.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-13"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-13"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-14">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-14"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-14"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-25" x1="594.32" y1="1509.22" x2="594.32" y2="902.48" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-26" x1="592.33" y1="1188.34" x2="596.32" y2="1188.34" xlink:href="#linear-gradient-14"/>
    <filter id="filter-15" x="562" y="881.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-15"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-15"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-16">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-16"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-16"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-27" x1="524.32" y1="1554.23" x2="524.32" y2="947.49" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-28" x1="522.33" y1="1233.35" x2="526.32" y2="1233.35" xlink:href="#linear-gradient-14"/>
    <filter id="filter-17" x="492" y="926.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-17"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-17"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-18">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-18"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-18"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-29" x1="454.32" y1="1509.22" x2="454.32" y2="902.48" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-30" x1="452.33" y1="1188.34" x2="456.32" y2="1188.34" xlink:href="#linear-gradient-14"/>
    <filter id="filter-19" x="422" y="881.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-19"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-19"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-20">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-20"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-20"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-31" x1="384.32" y1="1450.85" x2="384.32" y2="844.11" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-32" x1="382.33" y1="1129.97" x2="386.32" y2="1129.97" xlink:href="#linear-gradient-14"/>
    <filter id="filter-21" x="352" y="823.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-21"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-21"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-22">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-22"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-22"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-33" x1="314.32" y1="1366.19" x2="314.32" y2="759.45" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-34" x1="312.33" y1="1045.32" x2="316.32" y2="1045.32" xlink:href="#linear-gradient-14"/>
    <filter id="filter-23" x="282" y="738.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-23"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-23"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-24">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-24"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-24"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-35" x1="840.23" y1="1005" x2="840.23" y2="397.48" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-36" x1="838.23" y1="683.71" x2="842.23" y2="683.71" xlink:href="#linear-gradient-14"/>
    <filter id="filter-25" x="808" y="377.26" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-25"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-25"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-26">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-26"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-26"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-37" x1="700.23" y1="1295.44" x2="700.23" y2="687.92" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-38" x1="698.23" y1="974.15" x2="702.23" y2="974.15" xlink:href="#linear-gradient-14"/>
    <filter id="filter-27" x="668" y="667.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-27"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-27"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-28">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-28"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-28"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-39" x1="525.23" y1="1295.44" x2="525.23" y2="687.92" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-40" x1="523.23" y1="974.15" x2="527.23" y2="974.15" xlink:href="#linear-gradient-14"/>
    <filter id="filter-29" x="493" y="667.69" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-29"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-29"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-30">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-30"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-30"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-41" x1="350.23" y1="1295.44" x2="350.23" y2="687.92" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-42" x1="348.23" y1="974.15" x2="352.23" y2="974.15" xlink:href="#linear-gradient-14"/>
    <filter id="filter-31" x="318" y="667.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-31"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-31"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-32">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-32"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-32"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-43" x1="210.23" y1="1004.9" x2="210.23" y2="397.38" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-44" x1="208.23" y1="683.61" x2="212.23" y2="683.61" xlink:href="#linear-gradient-14"/>
    <filter id="filter-33" x="178" y="377.16" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-33"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-33"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-34">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-34"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-34"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-45" x1="804.32" y1="1139.01" x2="804.32" y2="532.27" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-46" x1="802.33" y1="818.13" x2="806.32" y2="818.13" xlink:href="#linear-gradient-14"/>
    <filter id="filter-35" x="772" y="511.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-35"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-35"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-36">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-36"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-36"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-47" x1="734.32" y1="1023.61" x2="734.32" y2="416.87" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-48" x1="732.33" y1="702.73" x2="736.32" y2="702.73" xlink:href="#linear-gradient-14"/>
    <filter id="filter-37" x="702" y="396.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-37"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-37"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-38">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-38"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-38"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-49" x1="664.32" y1="1139.61" x2="664.32" y2="532.87" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-50" x1="662.33" y1="818.73" x2="666.32" y2="818.73" xlink:href="#linear-gradient-14"/>
    <filter id="filter-39" x="632" y="512.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-39"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-39"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-40">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-40"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-40"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-51" x1="594.32" y1="1086.18" x2="594.32" y2="479.44" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-52" x1="592.33" y1="765.3" x2="596.32" y2="765.3" xlink:href="#linear-gradient-14"/>
    <filter id="filter-41" x="562" y="458.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-41"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-41"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-42">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-42"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-42"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-53" x1="524.32" y1="1023.18" x2="524.32" y2="416.44" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-54" x1="522.33" y1="702.3" x2="526.32" y2="702.3" xlink:href="#linear-gradient-14"/>
    <filter id="filter-43" x="492" y="395.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-43"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-43"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-44">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-44"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-44"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-55" x1="454.32" y1="1139.18" x2="454.32" y2="532.44" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-56" x1="452.33" y1="818.3" x2="456.32" y2="818.3" xlink:href="#linear-gradient-14"/>
    <filter id="filter-45" x="422" y="511.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-45"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-45"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-46">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-46"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-46"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-57" x1="384.32" y1="1023.81" x2="384.32" y2="417.07" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-58" x1="382.33" y1="702.93" x2="386.32" y2="702.93" xlink:href="#linear-gradient-14"/>
    <filter id="filter-47" x="352" y="396.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-47"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-47"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-48">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-48"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-48"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-59" x1="314.32" y1="1139.15" x2="314.32" y2="532.41" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-60" x1="312.33" y1="818.28" x2="316.32" y2="818.28" xlink:href="#linear-gradient-14"/>
    <filter id="filter-49" x="282" y="511.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-49"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-49"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="filter-50">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="6" result="blur-50"/>
      <feFlood/>
      <feComposite operator="in" in2="blur-50"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-61" x1="244.32" y1="1139.01" x2="244.32" y2="532.27" xlink:href="#linear-gradient-13"/>
    <linearGradient id="linear-gradient-62" x1="242.33" y1="818.13" x2="246.32" y2="818.13" xlink:href="#linear-gradient-14"/>
    <filter id="filter-51" x="212" y="511.52" width="65" height="633" filterUnits="userSpaceOnUse">
      <feOffset dy="10" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="10" result="blur-51"/>
      <feFlood flood-color="#fff"/>
      <feComposite operator="in" in2="blur-51"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-63" x1="700.5" y1="1140.97" x2="700.5" y2="630.9" gradientUnits="userSpaceOnUse">
      <stop offset="0" stop-color="#f1d5d5"/>
      <stop offset="1" stop-color="#d8a7a7"/>
    </linearGradient>
    <filter id="filter-52" x="660" y="620.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-52"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-52"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-64" x1="630.5" y1="1259.99" x2="630.5" y2="749.92" xlink:href="#linear-gradient-63"/>
    <filter id="filter-53" x="590" y="738.99" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-53"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-53"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-65" x1="560.5" y1="1362.35" x2="560.5" y2="852.27" xlink:href="#linear-gradient-63"/>
    <filter id="filter-54" x="520" y="841.35" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-54"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-54"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-66" x1="490.5" y1="1362.35" x2="490.5" y2="852.27" xlink:href="#linear-gradient-63"/>
    <filter id="filter-55" x="450" y="841.35" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-55"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-55"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-67" x1="420.5" y1="1259.99" x2="420.5" y2="749.91" xlink:href="#linear-gradient-63"/>
    <filter id="filter-56" x="380" y="738.99" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-56"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-56"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-68" x1="350.5" y1="1140.97" x2="350.5" y2="630.9" xlink:href="#linear-gradient-63"/>
    <filter id="filter-57" x="310" y="620.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-57"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-57"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-69" x1="770.5" y1="1086.31" x2="770.5" y2="576.24" xlink:href="#linear-gradient-63"/>
    <filter id="filter-58" x="730" y="565.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-58"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-58"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-70" y1="978.05" y2="467.97" xlink:href="#linear-gradient-63"/>
    <filter id="filter-59" x="660" y="457.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-59"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-59"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-71" x1="630.5" y1="1086.32" x2="630.5" y2="576.25" xlink:href="#linear-gradient-63"/>
    <filter id="filter-60" x="590" y="565.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-60"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-60"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-72" x1="560.5" y1="977.52" x2="560.5" y2="467.45" xlink:href="#linear-gradient-63"/>
    <filter id="filter-61" x="520" y="456.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-61"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-61"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-73" x1="490.5" y1="1086.32" x2="490.5" y2="576.25" xlink:href="#linear-gradient-63"/>
    <filter id="filter-62" x="450" y="565.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-62"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-62"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-74" x1="420.5" y1="977.52" x2="420.5" y2="467.45" xlink:href="#linear-gradient-63"/>
    <filter id="filter-63" x="380" y="456.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-63"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-63"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-75" x1="350.5" y1="917.68" x2="350.5" y2="407.61" xlink:href="#linear-gradient-63"/>
    <filter id="filter-64" x="310" y="397.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-64"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-64"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-76" x1="280.5" y1="1086.82" x2="280.5" y2="576.75" xlink:href="#linear-gradient-63"/>
    <filter id="filter-65" x="240" y="566.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-65"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-65"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-77" x1="805.27" y1="972.07" x2="805.27" y2="462.65" xlink:href="#linear-gradient-63"/>
    <filter id="filter-66" x="765" y="452.52" width="81" height="540" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-66"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-66"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-78" x1="735.27" y1="856.67" x2="735.27" y2="347.25" xlink:href="#linear-gradient-63"/>
    <filter id="filter-67" x="695" y="336.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-67"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-67"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-79" x1="665.27" y1="972.67" x2="665.27" y2="463.25" xlink:href="#linear-gradient-63"/>
    <filter id="filter-68" x="625" y="452.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-68"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-68"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-80" x1="595.27" y1="919.24" x2="595.27" y2="409.82" xlink:href="#linear-gradient-63"/>
    <filter id="filter-69" x="555" y="399.52" width="81" height="540" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-69"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-69"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-81" x1="525.27" y1="856.24" x2="525.27" y2="346.82" xlink:href="#linear-gradient-63"/>
    <filter id="filter-70" x="485" y="336.52" width="81" height="540" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-70"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-70"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-82" x1="455.27" y1="972.24" x2="455.27" y2="462.82" xlink:href="#linear-gradient-63"/>
    <filter id="filter-71" x="415" y="452.52" width="81" height="540" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-71"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-71"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-83" x1="385.27" y1="856.87" x2="385.27" y2="347.45" xlink:href="#linear-gradient-63"/>
    <filter id="filter-72" x="345" y="336.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-72"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-72"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-84" x1="315.27" y1="972.21" x2="315.27" y2="462.79" xlink:href="#linear-gradient-63"/>
    <filter id="filter-73" x="275" y="452.52" width="81" height="540" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-73"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-73"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-85" x1="245.27" y1="972.07" x2="245.27" y2="462.65" xlink:href="#linear-gradient-63"/>
    <filter id="filter-74" x="205" y="452.52" width="81" height="540" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-74"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-74"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-86" x1="840.5" y1="863.48" x2="840.5" y2="353.41" xlink:href="#linear-gradient-63"/>
    <filter id="filter-75" x="800" y="342.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-75"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-75"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-87" x1="770.5" y1="913.48" x2="770.5" y2="403.41" xlink:href="#linear-gradient-63"/>
    <filter id="filter-76" x="730" y="392.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-76"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-76"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-88" y1="808.49" y2="298.42" xlink:href="#linear-gradient-63"/>
    <filter id="filter-77" x="660" y="287.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-77"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-77"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-89" x1="630.5" y1="808.49" x2="630.5" y2="298.42" xlink:href="#linear-gradient-63"/>
    <filter id="filter-78" x="590" y="287.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-78"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-78"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-90" x1="560.5" y1="808.49" x2="560.5" y2="298.42" xlink:href="#linear-gradient-63"/>
    <filter id="filter-79" x="520" y="287.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-79"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-79"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-91" x1="490.5" y1="808.49" x2="490.5" y2="298.42" xlink:href="#linear-gradient-63"/>
    <filter id="filter-80" x="450" y="287.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-80"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-80"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-92" x1="420.5" y1="808.49" x2="420.5" y2="298.42" xlink:href="#linear-gradient-63"/>
    <filter id="filter-81" x="380" y="287.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-81"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-81"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-93" x1="350.5" y1="808.49" x2="350.5" y2="298.42" xlink:href="#linear-gradient-63"/>
    <filter id="filter-82" x="310" y="287.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-82"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-82"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-94" x1="280.5" y1="913.48" x2="280.5" y2="403.41" xlink:href="#linear-gradient-63"/>
    <filter id="filter-83" x="240" y="392.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-83"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-83"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-95" x1="210.5" y1="863.48" x2="210.5" y2="353.41" xlink:href="#linear-gradient-63"/>
    <filter id="filter-84" x="170" y="342.52" width="81" height="541" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-84"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-84"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-96" x1="875.05" y1="807.12" x2="875.05" y2="162.07" gradientUnits="userSpaceOnUse">
      <stop offset="0" stop-color="#fff"/>
      <stop offset="0.02" stop-color="#fdf9f9"/>
      <stop offset="0.1" stop-color="#f6e3e3"/>
      <stop offset="0.21" stop-color="#f1d2d2"/>
      <stop offset="0.33" stop-color="#edc7c7"/>
      <stop offset="0.51" stop-color="#ebc0c0"/>
      <stop offset="1" stop-color="#eabebe"/>
    </linearGradient>
    <filter id="filter-85" x="835" y="151.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-85"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-85"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-97" x1="805.05" y1="807.12" x2="805.05" y2="162.07" xlink:href="#linear-gradient-96"/>
    <filter id="filter-86" x="765" y="151.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-86"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-86"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-98" x1="735.05" y1="857.63" x2="735.05" y2="212.59" xlink:href="#linear-gradient-96"/>
    <filter id="filter-87" x="695" y="202.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-87"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-87"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-99" x1="665.05" y1="753.71" x2="665.05" y2="108.66" xlink:href="#linear-gradient-96"/>
    <filter id="filter-88" x="625" y="98.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-88"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-88"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-100" x1="595.05" y1="858.21" x2="595.05" y2="213.16" xlink:href="#linear-gradient-96"/>
    <filter id="filter-89" x="555" y="202.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-89"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-89"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-101" x1="525.05" y1="754.28" x2="525.05" y2="109.24" xlink:href="#linear-gradient-96"/>
    <filter id="filter-90" x="485" y="98.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-90"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-90"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-102" x1="455.05" y1="858.21" x2="455.05" y2="213.16" xlink:href="#linear-gradient-96"/>
    <filter id="filter-91" x="415" y="202.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-91"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-91"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-103" x1="385.05" y1="806.71" x2="385.05" y2="161.66" xlink:href="#linear-gradient-96"/>
    <filter id="filter-92" x="345" y="151.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-92"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-92"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-104" x1="315.05" y1="858.18" x2="315.05" y2="213.13" xlink:href="#linear-gradient-96"/>
    <filter id="filter-93" x="275" y="202.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-93"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-93"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-105" x1="245.05" y1="807.12" x2="245.05" y2="162.07" xlink:href="#linear-gradient-96"/>
    <filter id="filter-94" x="205" y="151.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-94"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-94"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-106" x1="175.05" y1="807.12" x2="175.05" y2="162.07" xlink:href="#linear-gradient-96"/>
    <filter id="filter-95" x="135" y="151.52" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-95"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-95"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-107" x1="840.27" y1="714.27" x2="840.27" y2="68.39" xlink:href="#linear-gradient-96"/>
    <filter id="filter-96" x="799.85" y="58.29" width="81" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-96"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-96"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-108" x1="770.27" y1="764.27" x2="770.27" y2="118.39" xlink:href="#linear-gradient-96"/>
    <filter id="filter-97" x="729.85" y="108.29" width="81" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-97"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-97"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-109" x1="700.27" y1="659.28" x2="700.27" y2="13.4" xlink:href="#linear-gradient-96"/>
    <filter id="filter-98" x="659.85" y="3.31" width="81" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-98"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-98"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-110" x1="630.27" y1="659.28" x2="630.27" y2="13.4" xlink:href="#linear-gradient-96"/>
    <filter id="filter-99" x="589.85" y="3.31" width="81" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-99"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-99"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-111" x1="560.27" y1="714.27" x2="560.27" y2="68.39" xlink:href="#linear-gradient-96"/>
    <filter id="filter-100" x="519.85" y="58.29" width="81" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-100"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-100"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-112" x1="490.27" y1="714.27" x2="490.27" y2="68.39" xlink:href="#linear-gradient-96"/>
    <filter id="filter-101" x="450" y="57.52" width="81" height="677" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-101"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-101"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-113" x1="420.27" y1="659.28" x2="420.27" y2="13.4" xlink:href="#linear-gradient-96"/>
    <filter id="filter-102" x="379.85" y="3.31" width="81" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-102"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-102"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-114" x1="350.27" y1="659.28" x2="350.27" y2="13.4" xlink:href="#linear-gradient-96"/>
    <filter id="filter-103" x="309.85" y="3.31" width="81" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-103"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-103"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-115" x1="280.27" y1="764.27" x2="280.27" y2="118.39" xlink:href="#linear-gradient-96"/>
    <filter id="filter-104" x="239.85" y="108.29" width="81" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-104"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-104"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-116" x1="210.27" y1="714.27" x2="210.27" y2="68.39" xlink:href="#linear-gradient-96"/>
    <filter id="filter-105" x="169.85" y="58.29" width="81" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-105"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-105"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-117" x1="805.05" y1="617.26" x2="805.05" y2="-27.78" xlink:href="#linear-gradient-96"/>
    <filter id="filter-106" x="765" y="-38.48" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-106"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-106"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-118" x1="735.05" y1="558.78" x2="735.05" y2="-86.27" xlink:href="#linear-gradient-96"/>
    <filter id="filter-107" x="695" y="-96.48" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-107"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-107"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-119" x1="595.05" y1="616.8" x2="595.05" y2="-28.25" xlink:href="#linear-gradient-96"/>
    <filter id="filter-108" x="555" y="-38.48" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-108"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-108"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-120" x1="525.05" y1="616.8" x2="525.05" y2="-28.25" xlink:href="#linear-gradient-96"/>
    <filter id="filter-109" x="485" y="-38.48" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-109"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-109"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-121" x1="455.05" y1="616.8" x2="455.05" y2="-28.25" xlink:href="#linear-gradient-96"/>
    <filter id="filter-110" x="415" y="-38.48" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-110"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-110"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-122" x1="315.05" y1="558.78" x2="315.05" y2="-86.27" xlink:href="#linear-gradient-96"/>
    <filter id="filter-111" x="275" y="-96.48" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-111"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-111"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <linearGradient id="linear-gradient-123" x1="245.05" y1="616.63" x2="245.05" y2="-28.42" xlink:href="#linear-gradient-96"/>
    <filter id="filter-112" x="205" y="-38.48" width="80" height="676" filterUnits="userSpaceOnUse">
      <feOffset dy="5" input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="5" result="blur-112"/>
      <feFlood flood-color="#896666"/>
      <feComposite operator="in" in2="blur-112"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="Pana_roz_button5">
      <feOffset input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="7" result="blur-113"/>
      <feFlood flood-color="#422828"/>
      <feComposite operator="in" in2="blur-113"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="Pana_roz_button4">
      <feOffset input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="7" result="blur-114"/>
      <feFlood flood-color="#422828"/>
      <feComposite operator="in" in2="blur-114"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="Pana_roz_button3">
      <feOffset input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="7" result="blur-115"/>
      <feFlood flood-color="#422828"/>
      <feComposite operator="in" in2="blur-115"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="Pana_roz_button2">
      <feOffset input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="7" result="blur-116"/>
      <feFlood flood-color="#422828"/>
      <feComposite operator="in" in2="blur-116"/>
      <feComposite in="SourceGraphic"/>
    </filter>
    <filter id="Pana_roz_button1">
      <feOffset input="SourceAlpha"/>
      <feGaussianBlur stdDeviation="7" result="blur-117"/>
      <feFlood flood-color="#422828"/>
      <feComposite operator="in" in2="blur-117"/>
      <feComposite in="SourceGraphic"/>
    </filter>
  </defs>
  <g id="HOME-BUTTON">
    <g style="filter: url(#filter)">
      <g id="Pana_roz_button-home">
        <path d="M463.41,1844.46c1.2,0,2.83.87,4,1.2,1.4.39,2.8.75,4.21,1.09,2.75.67,5.53,1.23,8.33,1.71,2.17.37,4.34.74,6.52,1s4.37.26,6.47.66c3.59.69,7.13-1.8,10-3.68l7.84-5.07a10.37,10.37,0,0,0,2.87-2.39c-1.52,3.53-4.34,6.32-7.09,9a22.24,22.24,0,0,0-2.18,2.16c1.93.6,4.54.32,6.56.25,2.19-.08,4.37-.27,6.56-.43,4.5-.33,9-.84,13.47-1.5a190.34,190.34,0,0,0,34.24-8.37c13.13-4.53,26.66-10.57,37.65-19.17,7.28-5.69,15.81-13.22,15-23.34.29,3.79-34.52,12.55-38.49,13.48a166.94,166.94,0,0,1-33.59,4.35,164,164,0,0,1-53.35-7.23c-1.8-.57-3.6-1.17-5.38-1.8-1.4-.49-3.13-1.5-4.6-1.56.26,4.83,3,9.56,4.22,14.21q-3.54-6.64-6.5-13.56a4.61,4.61,0,0,0-2-2.67c-1.16-.51-2.44-.89-3.62-1.43q-4-1.8-7.88-3.84a153.44,153.44,0,0,1-15.06-9l-.43-.3c-4.52-3.09-29.6-25.94-33.35-19.66-1.05,1.77-.7,4-.27,6,3.21,15.24,3.41,29.18,11.9,43.09A61.43,61.43,0,0,0,463.41,1844.46Z" style="fill: url(#linear-gradient)"/>
      </g>
      <g id="linie11">
        <path d="M640.11,1765.84l-8,12.53c-2.68,4.17-5.32,8.39-8.22,12.48a76.8,76.8,0,0,1-9.78,11.49,74.27,74.27,0,0,1-12,9.14,121.38,121.38,0,0,1-27.41,12q-7.14,2.26-14.47,3.8c-2.43.55-4.89,1-7.35,1.4s-4.93.75-7.41,1a137.45,137.45,0,0,1-59-5.86,122,122,0,0,1-50-31.4,121.65,121.65,0,0,0,50.21,30.73,136.42,136.42,0,0,0,58.62,5.12c2.45-.27,4.88-.7,7.32-1.08s4.86-.9,7.26-1.47a146.94,146.94,0,0,0,14.27-3.93,119.75,119.75,0,0,0,26.82-12.15,71.5,71.5,0,0,0,11.53-9,73.3,73.3,0,0,0,9.35-11.25c2.79-4,5.37-8.26,8-12.47l7.88-12.63a1.42,1.42,0,0,1,2.41,1.5Z" style="fill: url(#linear-gradient-2)"/>
      </g>
      <g id="linie10">
        <path d="M562.78,1826.72a10.57,10.57,0,0,1-.72,4.25c-.45,1.32-1,2.58-1.54,3.87l-3.14,7.7,2.67-7.86c.43-1.32.93-2.61,1.29-3.94a9.45,9.45,0,0,0,.44-3.91.51.51,0,0,1,.42-.57.5.5,0,0,1,.57.42Z" style="fill: url(#linear-gradient-3)"/>
      </g>
      <g id="linie9">
        <path d="M556.4,1827.39a22.89,22.89,0,0,1-.44,4l-.76,3.88-.77,3.87-.85,3.86.6-3.9.52-3.91.52-3.91a22.83,22.83,0,0,0,.18-3.86.5.5,0,0,1,1-.06Z" style="fill: url(#linear-gradient-4)"/>
      </g>
      <g id="linie8">
        <path d="M551.75,1828.3a35.92,35.92,0,0,1-1.73,4.51l-1.91,4.37-3.83,8.73,3.37-8.92,1.68-4.46a36,36,0,0,0,1.46-4.48.5.5,0,1,1,1,.23Z" style="fill: url(#linear-gradient-5)"/>
      </g>
      <g id="linie7">
        <path d="M509.11,1829a58.25,58.25,0,0,1-7.86,10.92c-3,3.35-6.19,6.45-9.41,9.55,3.1-3.21,6.2-6.44,9-9.87a57.16,57.16,0,0,0,7.35-11.06.51.51,0,0,1,.67-.23.52.52,0,0,1,.23.67Z" style="fill: url(#linear-gradient-6)"/>
      </g>
      <g id="linie6">
        <path d="M505.27,1828.53a67.94,67.94,0,0,1-4.58,6c-1.61,1.94-3.28,3.83-5.06,5.61a44.15,44.15,0,0,1-5.78,4.88,28.63,28.63,0,0,1-6.68,3.46,28.59,28.59,0,0,0,6.54-3.67,44.07,44.07,0,0,0,5.56-5c1.71-1.82,3.3-3.75,4.83-5.73a68.89,68.89,0,0,0,4.33-6.1.48.48,0,0,1,.68-.17.49.49,0,0,1,.17.68Z" style="fill: url(#linear-gradient-7)"/>
      </g>
      <g id="linie5">
        <path d="M489.21,1824.75A56.78,56.78,0,0,1,455,1839.41,56.27,56.27,0,0,0,488.52,1824a.51.51,0,0,1,.71,0,.5.5,0,0,1,0,.71Z" style="fill: url(#linear-gradient-8)"/>
      </g>
      <g id="linie4">
        <path d="M520.59,1829.59a5.74,5.74,0,0,0,0-3.94,37.3,37.3,0,0,0-1.65-4l-3.59-7.9,4,7.68a35.87,35.87,0,0,1,1.91,3.94,6.6,6.6,0,0,1,.25,4.54h0a.51.51,0,0,1-.64.31.5.5,0,0,1-.3-.64Z" style="fill: url(#linear-gradient-9)"/>
      </g>
      <g id="linie3">
        <path d="M516.45,1829.27a67.48,67.48,0,0,0-5.79-16.27,68,68,0,0,1,6.76,16,.51.51,0,0,1-.35.62.49.49,0,0,1-.61-.35Z" style="fill: url(#linear-gradient-10)"/>
      </g>
      <g id="linie2">
        <path d="M493.61,1825.72l-2-5.22q-1-2.6-2.11-5.16c-.72-1.72-1.47-3.41-2.27-5.09a48.28,48.28,0,0,0-2.62-4.92,48.19,48.19,0,0,1,2.84,4.81c.88,1.64,1.71,3.31,2.51,5s1.58,3.38,2.34,5.08l2.23,5.11v0a.5.5,0,1,1-.92.4Z" style="fill: url(#linear-gradient-11)"/>
      </g>
      <g id="linie1">
        <path d="M572.4,1823.24a5.28,5.28,0,0,0-1.13-2.61,19.74,19.74,0,0,0-2.09-2.22,27,27,0,0,1-2.13-2.28l-2-2.36,2.21,2.19a25,25,0,0,0,2.29,2.08,22.07,22.07,0,0,1,2.34,2.12,6.19,6.19,0,0,1,1.54,2.93.5.5,0,0,1-.4.58.48.48,0,0,1-.58-.39A.06.06,0,0,1,572.4,1823.24Z" style="fill: url(#linear-gradient-12)"/>
      </g>
      <g id="text6">
        <text transform="translate(460.36 1788.74) rotate(32.86)" style="font-size: 22.677169799804688px;fill: #fff;font-family: YuGothicUI-Light, Yu Gothic UI;font-weight: 300">H</text>
        <text transform="translate(477.05 1799.11) rotate(21.65)" style="font-size: 22.677169799804688px;fill: #fff;font-family: YuGothicUI-Light, Yu Gothic UI;font-weight: 300">O</text>
        <text transform="translate(497.3 1806.74) rotate(9.94)" style="font-size: 22.677169799804688px;fill: #fff;font-family: YuGothicUI-Light, Yu Gothic UI;font-weight: 300">M</text>
        <text transform="translate(519.88 1810.04) rotate(0.66)" style="font-size: 22.677169799804688px;fill: #fff;font-family: YuGothicUI-Light, Yu Gothic UI;font-weight: 300">E</text>
      </g>
    </g>
  </g>
  <g id="PENAJ">
    <g id="blockcolor11">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row11">
      <g id="Pana_gri_opac4_11">
        <g style="filter: url(#filter-2)">
          <path d="M655.23,1503.2c0,13.81-11.19,52.7-25,52.7s-25-38.89-25-52.7l7.32-230.29V948.38h35.36v324.53Z" style="fill: url(#linear-gradient-13)"/>
          <g>
            <path d="M632.23,1518.2c0,.69-.89,2.64-2,2.64s-2-1.95-2-2.64l.59-11.51V948.38h2.83v558.31Z" style="fill: url(#linear-gradient-14);filter: url(#filter-3)"/>
            <path d="M626.67,1521c0-2,1.59-6,3.56-6s3.57,4.08,3.57,6a3.57,3.57,0,0,1-7.13,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac3_11">
        <g style="filter: url(#filter-4)">
          <path d="M585.23,1615.49c0,13.81-11.19,52.7-25,52.7s-25-38.89-25-52.7l7.32-230.29V1060.67h35.36V1385.2Z" style="fill: url(#linear-gradient-15)"/>
          <g>
            <path d="M562.23,1630.49c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.59-11.51V1060.67h2.83V1619Z" style="fill: url(#linear-gradient-16);filter: url(#filter-5)"/>
            <path d="M556.67,1633.33c0-2,1.59-6,3.56-6s3.57,4.08,3.57,6a3.57,3.57,0,0,1-7.13,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac2_11">
        <g style="filter: url(#filter-6)">
          <path d="M515.23,1615.49c0,13.81-11.19,52.7-25,52.7s-25-38.89-25-52.7l7.32-230.29V1060.67h35.36V1385.2Z" style="fill: url(#linear-gradient-17)"/>
          <g>
            <path d="M492.23,1630.49c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.59-11.51V1060.67h2.83V1619Z" style="fill: url(#linear-gradient-18);filter: url(#filter-7)"/>
            <path d="M486.67,1633.33c0-2,1.59-6,3.56-6s3.57,4.08,3.57,6a3.57,3.57,0,0,1-7.13,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac1_11">
        <g style="filter: url(#filter-8)">
          <path d="M445.23,1502.66c0,13.81-11.19,52.7-25,52.7s-25-38.89-25-52.7l7.32-230.29V947.84h35.36v324.53Z" style="fill: url(#linear-gradient-19)"/>
          <g>
            <path d="M422.23,1517.66c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.59-11.51V947.84h2.83v558.31Z" style="fill: url(#linear-gradient-20);filter: url(#filter-9)"/>
            <path d="M416.67,1520.5c0-2,1.59-6,3.56-6s3.57,4.08,3.57,6a3.57,3.57,0,0,1-7.13,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
    </g>
    <g id="blockcolor10">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row10">
      <g id="Pana_gri_opac7_10">
        <g style="filter: url(#filter-10)">
          <path d="M759.29,1313.4c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V759.29H752V1083.4Z" style="fill: url(#linear-gradient-21)"/>
          <g>
            <path d="M736.32,1328.38c0,.68-.89,2.63-2,2.63s-2-2-2-2.63l.58-11.5V759.29h2.83v557.59Z" style="fill: url(#linear-gradient-22);filter: url(#filter-11)"/>
            <path d="M730.76,1331.21c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac6_10">
        <g style="filter: url(#filter-12)">
          <path d="M689.29,1398c0,13.8-11.18,52.64-25,52.64s-25-38.84-25-52.64l7.31-230V843.93H682v324.12Z" style="fill: url(#linear-gradient-23)"/>
          <g>
            <path d="M666.32,1413c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.58-11.49V843.93h2.83v557.6Z" style="fill: url(#linear-gradient-24);filter: url(#filter-13)"/>
            <path d="M660.76,1415.85c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac5_10">
        <g style="filter: url(#filter-14)">
          <path d="M619.29,1456.59c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V902.48H612v324.11Z" style="fill: url(#linear-gradient-25)"/>
          <g>
            <path d="M596.32,1471.57c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.58-11.5V902.48h2.83v557.59Z" style="fill: url(#linear-gradient-26);filter: url(#filter-15)"/>
            <path d="M590.76,1474.4c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac4_10">
        <g style="filter: url(#filter-16)">
          <path d="M549.29,1501.6c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V947.49H542V1271.6Z" style="fill: url(#linear-gradient-27)"/>
          <g>
            <path d="M526.32,1516.58c0,.69-.89,2.63-2,2.63s-2-1.94-2-2.63l.58-11.5V947.49h2.83v557.59Z" style="fill: url(#linear-gradient-28);filter: url(#filter-17)"/>
            <path d="M520.76,1519.41c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac3_10">
        <g style="filter: url(#filter-18)">
          <path d="M479.29,1456.59c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V902.48H472v324.11Z" style="fill: url(#linear-gradient-29)"/>
          <g>
            <path d="M456.32,1471.57c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.58-11.5V902.48h2.83v557.59Z" style="fill: url(#linear-gradient-30);filter: url(#filter-19)"/>
            <path d="M450.76,1474.4c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,0,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac2_10">
        <g style="filter: url(#filter-20)">
          <path d="M409.29,1398.22c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V844.11H402v324.11Z" style="fill: url(#linear-gradient-31)"/>
          <g>
            <path d="M386.32,1413.2c0,.69-.89,2.63-2,2.63s-2-1.94-2-2.63l.58-11.5V844.11h2.83V1401.7Z" style="fill: url(#linear-gradient-32);filter: url(#filter-21)"/>
            <path d="M380.76,1416c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,0,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac1_10">
        <g style="filter: url(#filter-22)">
          <path d="M339.29,1313.56c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V759.45H332v324.12Z" style="fill: url(#linear-gradient-33)"/>
          <g>
            <path d="M316.32,1328.54c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.58-11.49V759.45h2.83v557.6Z" style="fill: url(#linear-gradient-34);filter: url(#filter-23)"/>
            <path d="M310.76,1331.37c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
    </g>
    <g id="blockcolor9">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row9">
      <g id="Pana_gri_opac5_9">
        <g style="filter: url(#filter-24)">
          <path d="M865.23,952.3c0,13.81-11.19,52.7-25,52.7s-25-38.89-25-52.7L822.55,722V397.48h35.36V722Z" style="fill: url(#linear-gradient-35)"/>
          <g>
            <path d="M842.23,967.3c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.59-11.51V397.48h2.83V955.79Z" style="fill: url(#linear-gradient-36);filter: url(#filter-25)"/>
            <path d="M836.67,970.13c0-2,1.59-6,3.56-6s3.57,4.07,3.57,6a3.57,3.57,0,1,1-7.13,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac4_9">
        <g style="filter: url(#filter-26)">
          <path d="M725.23,1242.74c0,13.81-11.19,52.7-25,52.7s-25-38.89-25-52.7l7.32-230.29V687.92h35.36v324.53Z" style="fill: url(#linear-gradient-37)"/>
          <g>
            <path d="M702.23,1257.74c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.59-11.51V687.92h2.83v558.31Z" style="fill: url(#linear-gradient-38);filter: url(#filter-27)"/>
            <path d="M696.67,1260.57c0-2,1.59-6,3.56-6s3.57,4.07,3.57,6a3.57,3.57,0,1,1-7.13,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac3_9">
        <g style="filter: url(#filter-28)">
          <path d="M550.23,1242.74c0,13.81-11.19,52.7-25,52.7s-25-38.89-25-52.7l7.32-230.29V687.92h35.36v324.53Z" style="fill: url(#linear-gradient-39)"/>
          <g>
            <path d="M527.23,1257.74c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.59-11.51V687.92h2.83v558.31Z" style="fill: url(#linear-gradient-40);filter: url(#filter-29)"/>
            <path d="M521.67,1260.57c0-2,1.59-6,3.56-6s3.57,4.07,3.57,6a3.57,3.57,0,1,1-7.13,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac2_9">
        <g style="filter: url(#filter-30)">
          <path d="M375.23,1242.74c0,13.81-11.19,52.7-25,52.7s-25-38.89-25-52.7l7.32-230.29V687.92h35.36v324.53Z" style="fill: url(#linear-gradient-41)"/>
          <g>
            <path d="M352.23,1257.74c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.59-11.51V687.92h2.83v558.31Z" style="fill: url(#linear-gradient-42);filter: url(#filter-31)"/>
            <path d="M346.67,1260.57c0-2,1.59-6,3.56-6s3.57,4.07,3.57,6a3.57,3.57,0,1,1-7.13,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac1_9">
        <g style="filter: url(#filter-32)">
          <path d="M235.23,952.2c0,13.81-11.19,52.7-25,52.7s-25-38.89-25-52.7l7.32-230.29V397.38h35.36V721.91Z" style="fill: url(#linear-gradient-43)"/>
          <g>
            <path d="M212.23,967.2c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.59-11.51V397.38h2.83V955.69Z" style="fill: url(#linear-gradient-44);filter: url(#filter-33)"/>
            <path d="M206.67,970c0-2,1.59-6,3.56-6s3.57,4.08,3.57,6a3.57,3.57,0,0,1-7.13,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
    </g>
    <g id="blockcolor8">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row8">
      <g id="Pana_gri_opac9_8">
        <g style="filter: url(#filter-34)">
          <path d="M829.29,1086.38c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V532.27H822V856.39Z" style="fill: url(#linear-gradient-45)"/>
          <g>
            <path d="M806.32,1101.36c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.58-11.49V532.27h2.83v557.6Z" style="fill: url(#linear-gradient-46);filter: url(#filter-35)"/>
            <path d="M800.76,1104.19c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac8_8">
        <g style="filter: url(#filter-36)">
          <path d="M759.29,971c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V416.87H752V741Z" style="fill: url(#linear-gradient-47)"/>
          <g>
            <path d="M736.32,986c0,.69-.89,2.63-2,2.63s-2-1.94-2-2.63l.58-11.5V416.87h2.83V974.46Z" style="fill: url(#linear-gradient-48);filter: url(#filter-37)"/>
            <path d="M730.76,988.79c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac7_8">
        <g style="filter: url(#filter-38)">
          <path d="M689.29,1087c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V532.87H682V857Z" style="fill: url(#linear-gradient-49)"/>
          <g>
            <path d="M666.32,1102c0,.69-.89,2.63-2,2.63s-2-1.94-2-2.63l.58-11.5V532.87h2.83v557.59Z" style="fill: url(#linear-gradient-50);filter: url(#filter-39)"/>
            <path d="M660.76,1104.79c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac6_8">
        <g style="filter: url(#filter-40)">
          <path d="M619.29,1033.55c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V479.44H612V803.55Z" style="fill: url(#linear-gradient-51)"/>
          <g>
            <path d="M596.32,1048.53c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.58-11.5V479.44h2.83V1037Z" style="fill: url(#linear-gradient-52);filter: url(#filter-41)"/>
            <path d="M590.76,1051.36c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,0,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac5_8">
        <g style="filter: url(#filter-42)">
          <path d="M549.29,970.55c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V416.44H542V740.55Z" style="fill: url(#linear-gradient-53)"/>
          <g>
            <path d="M526.32,985.53c0,.69-.89,2.64-2,2.64s-2-1.95-2-2.64l.58-11.5V416.44h2.83V974Z" style="fill: url(#linear-gradient-54);filter: url(#filter-43)"/>
            <path d="M520.76,988.36c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac4_8">
        <g style="filter: url(#filter-44)">
          <path d="M479.29,1086.55c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V532.44H472V856.55Z" style="fill: url(#linear-gradient-55)"/>
          <g>
            <path d="M456.32,1101.53c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.58-11.5V532.44h2.83V1090Z" style="fill: url(#linear-gradient-56);filter: url(#filter-45)"/>
            <path d="M450.76,1104.36c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,0,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac3_8">
        <g style="filter: url(#filter-46)">
          <path d="M409.29,971.18c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V417.07H402V741.18Z" style="fill: url(#linear-gradient-57)"/>
          <g>
            <path d="M386.32,986.16c0,.69-.89,2.63-2,2.63s-2-1.94-2-2.63l.58-11.5V417.07h2.83V974.66Z" style="fill: url(#linear-gradient-58);filter: url(#filter-47)"/>
            <path d="M380.76,989c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,0,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac2_8">
        <g style="filter: url(#filter-48)">
          <path d="M339.29,1086.52c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V532.41H332V856.53Z" style="fill: url(#linear-gradient-59)"/>
          <g>
            <path d="M316.32,1101.5c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.58-11.49V532.41h2.83V1090Z" style="fill: url(#linear-gradient-60);filter: url(#filter-49)"/>
            <path d="M310.76,1104.33c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,1,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
      <g id="Pana_gri_opac1_8">
        <g style="filter: url(#filter-50)">
          <path d="M269.29,1086.38c0,13.79-11.18,52.63-25,52.63s-25-38.84-25-52.63l7.31-230V532.27H262V856.39Z" style="fill: url(#linear-gradient-61)"/>
          <g>
            <path d="M246.32,1101.36c0,.69-.89,2.64-2,2.64s-2-2-2-2.64l.58-11.49V532.27h2.83v557.6Z" style="fill: url(#linear-gradient-62);filter: url(#filter-51)"/>
            <path d="M240.76,1104.19c0-2,1.6-6,3.56-6s3.56,4.07,3.56,6a3.56,3.56,0,0,1-7.12,0Z" style="fill: #eabebe"/>
          </g>
        </g>
      </g>
    </g>
    <g id="blockcolor7">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row7">
      <g id="Pana_roz_opac6_7">
        <path d="M725.5,1088.32c0,13.8-11.19,52.65-25,52.65s-25-38.85-25-52.65l7.32-230.09V630.9h35.36V858.23Z" style="fill: url(#linear-gradient-63);filter: url(#filter-52)"/>
      </g>
      <g id="Pana_roz_opac5_7">
        <path d="M655.5,1207.34c0,13.8-11.19,52.65-25,52.65s-25-38.85-25-52.65l7.32-230.1V749.92h35.36V977.24Z" style="fill: url(#linear-gradient-64);filter: url(#filter-53)"/>
      </g>
      <g id="Pana_roz_opac4_7">
        <path d="M585.5,1309.69c0,13.8-11.19,52.66-25,52.66s-25-38.86-25-52.66l7.32-230.09V852.27h35.36V1079.6Z" style="fill: url(#linear-gradient-65);filter: url(#filter-54)"/>
      </g>
      <g id="Pana_roz_opac3_7">
        <path d="M515.5,1309.69c0,13.8-11.19,52.66-25,52.66s-25-38.86-25-52.66l7.32-230.09V852.27h35.36V1079.6Z" style="fill: url(#linear-gradient-66);filter: url(#filter-55)"/>
      </g>
      <g id="Pana_roz_opac2_7">
        <path d="M445.5,1207.33c0,13.8-11.19,52.66-25,52.66s-25-38.86-25-52.66l7.32-230.09V749.91h35.36V977.24Z" style="fill: url(#linear-gradient-67);filter: url(#filter-56)"/>
      </g>
      <g id="Pana_roz_opac1_7">
        <path d="M375.5,1088.32c0,13.8-11.19,52.65-25,52.65s-25-38.85-25-52.65l7.32-230.09V630.9h35.36V858.23Z" style="fill: url(#linear-gradient-68);filter: url(#filter-57)"/>
      </g>
    </g>
    <g id="blockcolor6">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row6">
      <g id="Pana_roz_opac8_6">
        <path d="M795.5,1033.66c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V576.24h35.36V803.56Z" style="fill: url(#linear-gradient-69);filter: url(#filter-58)"/>
      </g>
      <g id="Pana_roz_opac7_6">
        <path d="M725.5,925.39c0,13.8-11.19,52.66-25,52.66s-25-38.86-25-52.66l7.32-230.09V468h35.36V695.3Z" style="fill: url(#linear-gradient-70);filter: url(#filter-59)"/>
      </g>
      <g id="Pana_roz_opac6_6">
        <path d="M655.5,1033.67c0,13.8-11.19,52.65-25,52.65s-25-38.85-25-52.65l7.32-230.09V576.25h35.36V803.58Z" style="fill: url(#linear-gradient-71);filter: url(#filter-60)"/>
      </g>
      <g id="Pana_roz_opac5_6">
        <path d="M585.5,924.87c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V467.45h35.36V694.77Z" style="fill: url(#linear-gradient-72);filter: url(#filter-61)"/>
      </g>
      <g id="Pana_roz_opac4_6">
        <path d="M515.5,1033.67c0,13.8-11.19,52.65-25,52.65s-25-38.85-25-52.65l7.32-230.09V576.25h35.36V803.58Z" style="fill: url(#linear-gradient-73);filter: url(#filter-62)"/>
      </g>
      <g id="Pana_roz_opac3_6">
        <path d="M445.5,924.87c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V467.45h35.36V694.77Z" style="fill: url(#linear-gradient-74);filter: url(#filter-63)"/>
      </g>
      <g id="Pana_roz_opac2_6">
        <path d="M375.5,865c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V407.61h35.36V634.93Z" style="fill: url(#linear-gradient-75);filter: url(#filter-64)"/>
      </g>
      <g id="Pana_roz_opac1_6">
        <path d="M305.5,1034.17c0,13.8-11.19,52.65-25,52.65s-25-38.85-25-52.65l7.32-230.09V576.75h35.36V804.08Z" style="fill: url(#linear-gradient-76);filter: url(#filter-65)"/>
      </g>
    </g>
    <g id="blockcolor5">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row5">
      <g id="Pana_roz_opac9_5">
        <path d="M830.24,919.48c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8v-227h35.31v227Z" style="fill: url(#linear-gradient-77);filter: url(#filter-66)"/>
      </g>
      <g id="Pana_roz_opac8_5">
        <path d="M760.24,804.08c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8v-227h35.31v227Z" style="fill: url(#linear-gradient-78);filter: url(#filter-67)"/>
      </g>
      <g id="Pana_roz_opac7_5">
        <path d="M690.24,920.08c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8v-227h35.31v227Z" style="fill: url(#linear-gradient-79);filter: url(#filter-68)"/>
      </g>
      <g id="Pana_roz_opac6_5">
        <path d="M620.24,866.65c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8v-227h35.31v227Z" style="fill: url(#linear-gradient-80);filter: url(#filter-69)"/>
      </g>
      <g id="Pana_roz_opac5_5">
        <path d="M550.24,803.65c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8v-227h35.31v227Z" style="fill: url(#linear-gradient-81);filter: url(#filter-70)"/>
      </g>
      <g id="Pana_roz_opac4_5">
        <path d="M480.24,919.65c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8v-227h35.31v227Z" style="fill: url(#linear-gradient-82);filter: url(#filter-71)"/>
      </g>
      <g id="Pana_roz_opac3_5">
        <path d="M410.24,804.28c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8v-227h35.31v227Z" style="fill: url(#linear-gradient-83);filter: url(#filter-72)"/>
      </g>
      <g id="Pana_roz_opac2_5">
        <path d="M340.24,919.62c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8v-227h35.31v227Z" style="fill: url(#linear-gradient-84);filter: url(#filter-73)"/>
      </g>
      <g id="Pana_roz_opac1_5">
        <path d="M270.24,919.48c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8v-227h35.31v227Z" style="fill: url(#linear-gradient-85);filter: url(#filter-74)"/>
      </g>
    </g>
    <g id="blockcolor4">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row4">
      <g id="Pana_roz_opac10_4">
        <path d="M865.5,810.82c0,13.8-11.19,52.66-25,52.66s-25-38.86-25-52.66l7.32-230.09V353.41h35.36V580.73Z" style="fill: url(#linear-gradient-86);filter: url(#filter-75)"/>
      </g>
      <g id="Pana_roz_opac9_4">
        <path d="M795.5,860.82c0,13.8-11.19,52.66-25,52.66s-25-38.86-25-52.66l7.32-230.09V403.41h35.36V630.73Z" style="fill: url(#linear-gradient-87);filter: url(#filter-76)"/>
      </g>
      <g id="Pana_roz_opac8_4">
        <path d="M725.5,755.84c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V298.42h35.36V525.74Z" style="fill: url(#linear-gradient-88);filter: url(#filter-77)"/>
      </g>
      <g id="Pana_roz_opac7_4">
        <path d="M655.5,755.84c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V298.42h35.36V525.74Z" style="fill: url(#linear-gradient-89);filter: url(#filter-78)"/>
      </g>
      <g id="Pana_roz_opac6_4">
        <path d="M585.5,755.84c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V298.42h35.36V525.74Z" style="fill: url(#linear-gradient-90);filter: url(#filter-79)"/>
      </g>
      <g id="Pana_roz_opac5_4">
        <path d="M515.5,755.84c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V298.42h35.36V525.74Z" style="fill: url(#linear-gradient-91);filter: url(#filter-80)"/>
      </g>
      <g id="Pana_roz_opac4_4">
        <path d="M445.5,755.84c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V298.42h35.36V525.74Z" style="fill: url(#linear-gradient-92);filter: url(#filter-81)"/>
      </g>
      <g id="Pana_roz_opac3_4">
        <path d="M375.5,755.84c0,13.79-11.19,52.65-25,52.65s-25-38.86-25-52.65l7.32-230.1V298.42h35.36V525.74Z" style="fill: url(#linear-gradient-93);filter: url(#filter-82)"/>
      </g>
      <g id="Pana_roz_opac2_4">
        <path d="M305.5,860.82c0,13.8-11.19,52.66-25,52.66s-25-38.86-25-52.66l7.32-230.09V403.41h35.36V630.73Z" style="fill: url(#linear-gradient-94);filter: url(#filter-83)"/>
      </g>
      <g id="Pana_roz_opac1_4">
        <path d="M235.5,810.82c0,13.8-11.19,52.66-25,52.66s-25-38.86-25-52.66l7.32-230.09V353.41h35.36V580.73Z" style="fill: url(#linear-gradient-95);filter: url(#filter-84)"/>
      </g>
    </g>
    <g id="blockcolor3">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row3">
      <g id="Pana_roz_degrade11_3">
        <path d="M900,754.6c0,13.76-11.16,52.52-24.93,52.52s-24.94-38.76-24.94-52.52l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-96);filter: url(#filter-85)"/>
      </g>
      <g id="Pana_roz_degrade10_3">
        <path d="M830,754.6c0,13.76-11.16,52.52-24.93,52.52s-24.94-38.76-24.94-52.52l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-97);filter: url(#filter-86)"/>
      </g>
      <g id="Pana_roz_degrade9_3">
        <path d="M760,805.11c0,13.77-11.16,52.52-24.93,52.52s-24.94-38.75-24.94-52.52l7.3-229.5v-363h35.27v363Z" style="fill: url(#linear-gradient-98);filter: url(#filter-87)"/>
      </g>
      <g id="Pana_roz_degrade8_3">
        <path d="M690,701.19c0,13.77-11.16,52.52-24.93,52.52S640.11,715,640.11,701.19l7.3-229.5v-363h35.27v363Z" style="fill: url(#linear-gradient-99);filter: url(#filter-88)"/>
      </g>
      <g id="Pana_roz_degrade7_3">
        <path d="M620,805.69c0,13.76-11.16,52.52-24.93,52.52s-24.94-38.76-24.94-52.52l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-100);filter: url(#filter-89)"/>
      </g>
      <g id="Pana_roz_degrade6_3">
        <path d="M550,701.76c0,13.77-11.16,52.52-24.93,52.52s-24.94-38.75-24.94-52.52l7.3-229.5v-363h35.27v363Z" style="fill: url(#linear-gradient-101);filter: url(#filter-90)"/>
      </g>
      <g id="Pana_roz_degrade5_3">
        <path d="M480,805.69c0,13.76-11.16,52.52-24.93,52.52s-24.94-38.76-24.94-52.52l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-102);filter: url(#filter-91)"/>
      </g>
      <g id="Pana_roz_degrade4_3">
        <path d="M410,754.19c0,13.77-11.16,52.52-24.93,52.52S360.11,768,360.11,754.19l7.3-229.5v-363h35.27v363Z" style="fill: url(#linear-gradient-103);filter: url(#filter-92)"/>
      </g>
      <g id="Pana_roz_degrade3_3">
        <path d="M340,805.66c0,13.76-11.16,52.52-24.93,52.52s-24.94-38.76-24.94-52.52l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-104);filter: url(#filter-93)"/>
      </g>
      <g id="Pana_roz_degrade2_3">
        <path d="M270,754.6c0,13.76-11.16,52.52-24.93,52.52s-24.94-38.76-24.94-52.52l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-105);filter: url(#filter-94)"/>
      </g>
      <g id="Pana_roz_degrade1_3">
        <path d="M200,754.6c0,13.76-11.16,52.52-24.93,52.52s-24.94-38.76-24.94-52.52l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-106);filter: url(#filter-95)"/>
      </g>
    </g>
    <g id="blockcolor2">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row2">
      <g id="Pana_roz_degrade10_2">
        <path d="M865.24,661.68c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V68.39h35.31V431.88Z" style="fill: url(#linear-gradient-107);filter: url(#filter-96)"/>
      </g>
      <g id="Pana_roz_degrade9_2">
        <path d="M795.24,711.68c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V118.39h35.31V481.88Z" style="fill: url(#linear-gradient-108);filter: url(#filter-97)"/>
      </g>
      <g id="Pana_roz_degrade8_2">
        <path d="M725.24,606.69c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V13.4h35.31V376.89Z" style="fill: url(#linear-gradient-109);filter: url(#filter-98)"/>
      </g>
      <g id="Pana_roz_degrade7_2">
        <path d="M655.24,606.69c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V13.4h35.31V376.89Z" style="fill: url(#linear-gradient-110);filter: url(#filter-99)"/>
      </g>
      <g id="Pana_roz_degrade6_2">
        <path d="M585.24,661.68c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V68.39h35.31V431.88Z" style="fill: url(#linear-gradient-111);filter: url(#filter-100)"/>
      </g>
      <g id="Pana_roz_degrade5_2">
        <path d="M515.24,661.68c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V68.39h35.31V431.88Z" style="fill: url(#linear-gradient-112);filter: url(#filter-101)"/>
      </g>
      <g id="Pana_roz_degrade4_2">
        <path d="M445.24,606.69c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V13.4h35.31V376.89Z" style="fill: url(#linear-gradient-113);filter: url(#filter-102)"/>
      </g>
      <g id="Pana_roz_degrade3_2">
        <path d="M375.24,606.69c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V13.4h35.31V376.89Z" style="fill: url(#linear-gradient-114);filter: url(#filter-103)"/>
      </g>
      <g id="Pana_roz_degrade2_2">
        <path d="M305.24,711.68c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V118.39h35.31V481.88Z" style="fill: url(#linear-gradient-115);filter: url(#filter-104)"/>
      </g>
      <g id="Pana_roz_degrade1_2">
        <path d="M235.24,661.68c0,13.78-11.17,52.59-25,52.59s-25-38.81-25-52.59l7.31-229.8V68.39h35.31V431.88Z" style="fill: url(#linear-gradient-116);filter: url(#filter-105)"/>
      </g>
    </g>
    <g id="blockcolor1">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
    <g id="row1">
      <g id="Pana_roz_degrade7_1">
        <path d="M830,564.74c0,13.77-11.16,52.52-24.93,52.52s-24.94-38.75-24.94-52.52l7.3-229.5v-363h35.27v363Z" style="fill: url(#linear-gradient-117);filter: url(#filter-106)"/>
      </g>
      <g id="Pana_roz_degrade6_1">
        <path d="M760,506.26c0,13.77-11.16,52.52-24.93,52.52S710.11,520,710.11,506.26l7.3-229.5v-363h35.27v363Z" style="fill: url(#linear-gradient-118);filter: url(#filter-107)"/>
      </g>
      <g id="Pana_roz_degrade5_1">
        <path d="M620,564.28c0,13.76-11.16,52.52-24.93,52.52S570.11,578,570.11,564.28l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-119);filter: url(#filter-108)"/>
      </g>
      <g id="Pana_roz_degrade4_1">
        <path d="M550,564.28c0,13.76-11.16,52.52-24.93,52.52S500.11,578,500.11,564.28l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-120);filter: url(#filter-109)"/>
      </g>
      <g id="Pana_roz_degrade3_1">
        <path d="M480,564.28c0,13.76-11.16,52.52-24.93,52.52S430.11,578,430.11,564.28l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-121);filter: url(#filter-110)"/>
      </g>
      <g id="Pana_roz_degrade2_1">
        <path d="M340,506.26c0,13.77-11.16,52.52-24.93,52.52S290.11,520,290.11,506.26l7.3-229.5v-363h35.27v363Z" style="fill: url(#linear-gradient-122);filter: url(#filter-111)"/>
      </g>
      <g id="Pana_roz_degrade1_1">
        <path d="M270,564.11c0,13.76-11.16,52.52-24.93,52.52s-24.94-38.76-24.94-52.52l7.3-229.51v-363h35.27v363Z" style="fill: url(#linear-gradient-123);filter: url(#filter-112)"/>
      </g>
    </g>
    <g id="blockcolor0">
      <g style="opacity: 0">
        <rect x="125" width="800" height="1755" style="fill: #93a0c6"/>
      </g>
    </g>
  </g>
  <g id="SOFT-SKILLS">
    <g>
      <g id="Pana_roz_button5-2" data-name="Pana_roz_button5" style="filter: url(#Pana_roz_button5)">
        <path d="M694.63,454.67c0,13.81-13.43,52.7-30,52.7s-30-38.89-30-52.7l8.79-230.29V0h42.43V224.38Z" style="fill: #fff"/>
      </g>
      <text id="text5" transform="translate(673.37 452.93) rotate(-90)" style="font-size: 22.677169799804688px;fill: #c45353;font-family: YuGothicUI-Light, Yu Gothic UI;font-weight: 300">S<tspan x="14.29" y="0">O</tspan><tspan x="34.61" y="0">F</tspan><tspan x="48.19" y="0">T</tspan><tspan x="62.8" y="0"> </tspan><tspan x="72.08" y="0">S</tspan><tspan x="86.37" y="0">K</tspan><tspan x="101.37" y="0">I</tspan><tspan x="109.59" y="0">L</tspan><tspan x="123" y="0">L</tspan><tspan x="135.98" y="0">S</tspan></text>
    </g>
  </g>
  <g id="ACADEMIC">
    <g>
      <g id="Pana_roz_button4-2" data-name="Pana_roz_button4" style="filter: url(#Pana_roz_button4)">
        <path d="M624.63,454.67c0,13.81-13.43,52.7-30,52.7s-30-38.89-30-52.7l8.79-230.29V0h42.43V224.38Z" style="fill: #fff"/>
      </g>
      <text id="text4" transform="translate(604.31 452.76) rotate(-90)" style="font-size: 22.677169799804688px;fill: #c45353;font-family: YuGothicUI-Light, Yu Gothic UI;font-weight: 300">A<tspan x="19.58" y="0">C</tspan><tspan x="39.33" y="0">A</tspan><tspan x="59.29" y="0">D</tspan><tspan x="80.23" y="0">E</tspan><tspan x="97.25" y="0">M</tspan><tspan x="121.81" y="0">I</tspan><tspan x="132.64" y="0">C</tspan></text>
    </g>
  </g>
  <g id="CV">
    <g>
      <g id="Pana_roz_button3-2" data-name="Pana_roz_button3" style="filter: url(#Pana_roz_button3)">
        <path d="M554.63,454.67c0,13.81-13.43,52.7-30,52.7s-30-38.89-30-52.7l8.79-230.29V0h42.43V224.38Z" style="fill: #fff"/>
      </g>
      <text id="text3" transform="translate(510.91 403.72)" style="font-size: 22.677169799804688px;fill: #c45353;font-family: YuGothicUI-Light, Yu Gothic UI;font-weight: 300">CV</text>
    </g>
  </g>
  <g id="PROFESSIONAL">
    <g>
      <g id="Pana_roz_button2-2" data-name="Pana_roz_button2" style="filter: url(#Pana_roz_button2)">
        <path d="M484.63,454.67c0,13.81-13.43,52.7-30,52.7s-30-38.89-30-52.7l8.79-230.29V0h42.43V224.38Z" style="fill: #fff"/>
      </g>
      <text id="text2" transform="translate(463.39 454.42) rotate(-90)" style="font-size: 22.677169799804688px;fill: #c45353;font-family: YuGothicUI-Light, Yu Gothic UI;font-weight: 300">P<tspan x="12.33" y="0">R</tspan><tspan x="24.71" y="0">O</tspan><tspan x="41.98" y="0">F</tspan><tspan x="52.51" y="0">E</tspan><tspan x="63.86" y="0">S</tspan><tspan x="75.13" y="0">S</tspan><tspan x="86.4" y="0">I</tspan><tspan x="91.59" y="0">O</tspan><tspan x="108.84" y="0">N</tspan><tspan x="124.93" y="0">A</tspan><tspan x="139.2" y="0">L</tspan></text>
    </g>
  </g>
  <g id="HARD-SKILLS">
    <g>
      <g id="Pana_roz_button1-2" data-name="Pana_roz_button1" style="filter: url(#Pana_roz_button1)">
        <path d="M414.63,454.67c0,13.81-13.43,52.7-30,52.7s-30-38.89-30-52.7l8.79-230.29V0h42.43V224.38Z" style="fill: #fff"/>
      </g>
      <text id="text1" transform="translate(394.07 452.82) rotate(-90)" style="font-size: 22.677169799804688px;fill: #c45353;font-family: YuGothicUI-Light, Yu Gothic UI;font-weight: 300">H<tspan x="17.61" y="0">A</tspan><tspan x="34.14" y="0">R</tspan><tspan x="49" y="0">D</tspan><tspan x="66.55" y="0"> </tspan><tspan x="75.05" y="0">S</tspan><tspan x="88.59" y="0">K</tspan><tspan x="102.8" y="0">I</tspan><tspan x="110.24" y="0">L</tspan><tspan x="122.9" y="0">L</tspan><tspan x="135.11" y="0">S</tspan></text>
    </g>
  </g>
</svg>
`,s1=`<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 841.89 595.28">
  <rect width="841.89" height="595.28" style="fill: #cb9898;stroke: #231f20;stroke-miterlimit: 10"/>
  <text transform="translate(372.84 54.89)" style="font-size: 12px;fill: #231f20;font-family: MyriadPro-Regular, Myriad Pro">ha<tspan x="12.44" y="0" style="letter-spacing: -0.010009765625em">r</tspan><tspan x="16.25" y="0">d-SKILLS</tspan></text>
</svg>
`,n1=`<svg id="cv" viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Your CV SVG content here -->
</svg>`,r1=`<svg id="soft-skills" viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Your soft skills SVG content here -->
</svg>`;document.addEventListener("DOMContentLoaded",()=>{try{document.body.style.visibility="visible",document.body.style.opacity="1"}catch(d){console.error("Error setting body visibility:",d)}});try{Qm.workerSrc="/assets/pdfjs/pdf.worker.mjs"}catch(d){console.error("Error setting PDF worker source:",d)}function Kp(){try{const d=document.querySelector(".pdf-container");if(d){d.classList.remove("active"),d.style.removeProperty("visibility"),d.style.removeProperty("opacity"),d.style.removeProperty("pointer-events");const t=document.getElementById("flipbook");t&&(t.innerHTML="")}}catch(d){console.error("Error in hideAllPdfContainers:",d)}}function Qp(){try{const d=document.querySelector(".interactive-container");d&&(d.classList.remove("active"),d.style.removeProperty("visibility"),d.style.removeProperty("opacity"),d.style.removeProperty("pointer-events"),d.innerHTML="")}catch(d){console.error("Error in hideAllSvgContainers:",d)}}function Jp(){try{const t=new DOMParser().parseFromString(Bu,"image/svg+xml");if(t.querySelector("parsererror"))throw new Error("SVG parsing error");const e=document.querySelector("#loading-spinner");if(!e)throw new Error("Loading spinner element not found");e.innerHTML="",e.appendChild(t.documentElement),t.documentElement&&tg(t.documentElement)}catch(d){console.error("Error inserting loading SVG:",d)}}const Hh=document.getElementById("loading-spinner");Hh?Hh.querySelectorAll('[id^="loading"]'):console.error("SVG loading spinner not found!");function tg(d){try{let t=function(){try{if(i<e.length){const s=e[i];if(!s)throw new Error(`Loading element at index ${i} not found`);s.style.transition="opacity 0.5s ease",s.style.opacity="1",i++,setTimeout(t,500)}}catch(s){console.error("Error in loading animation step:",s)}};if(!d)throw new Error("SVG element is null in startLoadingAnimation");const e=d.querySelectorAll('[id^="loading"]');if(!e.length)throw new Error("No loading elements found in SVG");let i=0;t()}catch(t){console.error("Error in startLoadingAnimation:",t)}}function ru(){try{const d=document.getElementById("loading-spinner");if(!d)throw new Error("Loading spinner not found");const t=d.querySelector("svg");if(!t)throw new Error("SVG element not found in loading spinner");t.querySelectorAll('[id^="loading"]').forEach(i=>{try{i.style.opacity="0",i.style.transition="opacity 0.5s"}catch(s){console.error("Error resetting loading element:",s)}})}catch(d){console.error("Error in resetLoadingAnimation:",d)}}function a1(d,t,e){try{const s=new DOMParser().parseFromString(d,"image/svg+xml");if(s.querySelector("parsererror"))throw new Error("SVG parsing error");const n=document.querySelector(t);if(!n)throw new Error(`Container ${t} not found`);n.innerHTML="";const a=s.documentElement;n.appendChild(a),e&&e(a)}catch(i){console.error("Error inserting SVG:",i)}}function o1(d){try{[{layer:"HARD-SKILLS",buttonId:"Pana_roz_button1",textId:"text1"},{layer:"PROFESSIONAL",buttonId:"Pana_roz_button2",textId:"text2"},{layer:"CV",buttonId:"Pana_roz_button3",textId:"text3"},{layer:"ACADEMIC",buttonId:"Pana_roz_button4",textId:"text4"},{layer:"SOFT-SKILLS",buttonId:"Pana_roz_button5",textId:"text5"}].forEach(e=>{try{const i=d.querySelector(`#${e.layer}`);if(!i)throw new Error(`Layer group ${e.layer} not found`);const s=i.querySelector(`[id^="${e.buttonId}"]`),n=i.querySelector(`#${e.textId}`);if(!s||!n)throw new Error(`Elements not found for target: ${JSON.stringify(e)}`);const a=s.getAttribute("fill")||getComputedStyle(s).fill,o=n.getAttribute("fill")||getComputedStyle(n).fill,l=n.style.fontWeight||"",h=n.style.fontFamily||"";let c=0;const f=()=>{s.style.transition="fill 0.3s ease",s.style.fill="#e3125f",n.style.transition="fill 0.3s ease",n.style.fill="#ffca31",n.style.fontFamily="Segoe UI",n.style.fontWeight="bold"},p=()=>{s.style.fill=a,n.style.fill=o,n.style.fontWeight=l,n.style.fontFamily=h},y=()=>{c++,c===1&&f()},v=()=>{c--,c===0&&p()};s.addEventListener("mouseenter",y),s.addEventListener("mouseleave",v),n.addEventListener("mouseenter",y),n.addEventListener("mouseleave",v),n.addEventListener("click",A=>{A.stopPropagation(),s.dispatchEvent(new Event("click",{bubbles:!0}))})}catch(i){console.error("Error setting up hover effects for target:",e,i)}})}catch(t){console.error("Error in addHoverEffects:",t)}}function l1(d){try{[{layer:"HARD-SKILLS",id:"Pana_roz_button1",action:()=>{try{_c("hard-skills",d),Xa(d)}catch(e){console.error("Error in button1 action:",e)}}},{layer:"PROFESSIONAL",id:"Pana_roz_button2",action:()=>{try{Hu("professional.pdf",d),Xa(d)}catch(e){console.error("Error in button2 action:",e)}}},{layer:"CV",id:"Pana_roz_button3",action:()=>{try{_c("cv",d),Xa(d)}catch(e){console.error("Error in button3 action:",e)}}},{layer:"ACADEMIC",id:"Pana_roz_button4",action:()=>{try{Hu("academic.pdf",d),Xa(d)}catch(e){console.error("Error in button4 action:",e)}}},{layer:"SOFT-SKILLS",id:"Pana_roz_button5",action:()=>{try{_c("soft-skills",d),Xa(d)}catch(e){console.error("Error in button5 action:",e)}}},{layer:null,id:"HOME-BUTTON",action:()=>{try{h1(d)}catch(e){console.error("Error in HOME-BUTTON action:",e)}}}].forEach(e=>{try{let i;if(e.layer){const s=d.querySelector(`#${e.layer}`);if(!s)throw new Error(`Layer group ${e.layer} not found`);i=s.querySelector(`[id^="${e.id}"]`)}else i=d.querySelector(`#${e.id}`);if(!i)throw new Error(`Button with ID ${e.id} not found in the SVG.`);i.style.cursor="pointer",i.addEventListener("click",e.action)}catch(i){console.error(`Error setting up button ${e.id}:`,i)}})}catch(t){console.error("Error in attachButtonEvents:",t)}}function h1(d){try{console.log("Home button clicked. Hiding containers, reversing fog, and performing soft reset..."),Qp(),Kp(),c1(d,()=>{try{console.log("Reverse fog effect completed. Performing soft reset...");const t=document.getElementById("content-container");t&&(t.innerHTML="");const e=document.getElementById("loading-overlay");e&&(e.style.visibility="hidden",e.style.opacity="0"),console.log("Soft reset completed. Reloading the page..."),setTimeout(()=>{try{location.reload()}catch(i){console.error("Error reloading page:",i)}},500)}catch(t){console.error("Error in reverse fog callback:",t)}})}catch(t){console.error("Error in handleHomeButtonClick:",t)}}function au(){try{const d=document.getElementById("loading-overlay");if(!d)throw new Error("Loading overlay element not found");d.style.visibility="visible",d.style.opacity="1"}catch(d){console.error("Error in showLoadingOverlay:",d)}}function ds(){try{const d=document.getElementById("loading-overlay");if(!d)throw new Error("Loading overlay element not found");d.style.opacity="0",setTimeout(()=>{try{d.style.visibility="hidden"}catch(t){console.error("Error in hideLoadingOverlay timeout:",t)}},300)}catch(d){console.error("Error in hideLoadingOverlay:",d)}}function Xa(d){try{const t=d.querySelectorAll('[id^="blockcolor"]');if(!t.length)throw new Error("No fog layers found");t.forEach((e,i)=>{try{const s=e.querySelector("g");if(!s)throw new Error("Group element not found in fog layer");const n=i*250;setTimeout(()=>{try{s.style.transition="opacity 1s ease",s.style.opacity="0.35"}catch(a){console.error("Error setting fog layer opacity:",a)}},n)}catch(s){console.error("Error processing fog layer:",s)}})}catch(t){console.error("Error in triggerFogEffect:",t)}}function c1(d,t){try{au(),ru();const e=document.getElementById("loading-spinner");if(e){const n=e.querySelector("svg");n&&tg(n)}const i=Array.from(d.querySelectorAll('[id^="blockcolor"]')).reverse();if(!i.length)throw new Error("No fog layers found for reversal");let s=0;i.forEach((n,a)=>{try{const o=n.querySelector("g");if(!o)throw new Error("Group element not found in fog layer");const l=a*250;setTimeout(()=>{try{o.style.transition="opacity 1s ease",o.style.opacity="0",s++,s===i.length&&(ds(),t&&t())}catch(h){console.error("Error in fog layer reversal:",h)}},l)}catch(o){console.error("Error processing fog layer for reversal:",o)}})}catch(e){console.error("Error in reverseFogEffect:",e)}}async function Hu(d){try{let t=function(l){const h=Math.floor(l*a);n.forEach((c,f)=>{c.style.opacity=f<h?"1":"0"})};const e=document.querySelector(".pdf-container"),i=document.getElementById("flipbook");if(!e||!i)throw new Error("PDF container or flipbook not found");Qp(),au();const s=document.getElementById("loading-spinner");s&&!s.querySelector("svg")&&Jp(),ru();const n=Hh?Hh.querySelectorAll('[id^="loading"]'):[],a=n.length;let o=0;try{i.innerHTML="";const l=`/Portofoliu-FurduNicole/pdfs/${d}`,c=await Jm(l).promise,f=c.numPages,p=Math.max(100,1e3/Math.max(f,a)),y=[];for(let v=1;v<=f;v++)try{const A=await c.getPage(v),_=A.getViewport({scale:1.5}),C=document.createElement("canvas");C.width=_.width,C.height=_.height,await A.render({canvasContext:C.getContext("2d"),viewport:_}).promise,y.push(C.toDataURL()),t(v/f),await new Promise(T=>setTimeout(T,p))}catch(A){console.error(`Error rendering page ${v}:`,A)}y.forEach(v=>{try{const A=document.createElement("div");A.className="page";const _=document.createElement("img");_.src=v,_.style.width="100%",_.style.height="100%",A.appendChild(_),i.appendChild(A)}catch(A){console.error("Error creating page element:",A)}}),setTimeout(()=>{try{e.classList.add("active"),ds()}catch(v){console.error("Error finalizing PDF display:",v)}},100);try{let v,A;window.innerWidth<700?(v=Math.max(window.innerWidth*.95,320),A=Math.max(window.innerHeight*.65,400)):(v=710,A=1100),new i1.PageFlip(i,{size:"fixed",width:v,height:A,maxShadowOpacity:.5,showCover:!1,mobileScrollSupport:!0}).loadFromHTML(document.querySelectorAll("#flipbook .page"))}catch(v){console.error("Error initializing PageFlip:",v)}}catch(l){console.error("Error loading or rendering PDF:",l),ds()}}catch(t){console.error("Error in showPDF:",t),ds()}}async function _c(d,t){const e=document.querySelector(".interactive-container");if(!e){ds();return}Kp(),au();const i=document.getElementById("loading-spinner");i&&!i.querySelector("svg")&&Jp(),ru();const s=i==null?void 0:i.querySelector("svg"),n=s?s.querySelectorAll('[id^="loading"]'):[],a=n.length;let o=0,l;switch(d){case"hard-skills":l=s1;break;case"cv":l=n1;break;case"soft-skills":l=r1;break;default:ds();return}if(!l){ds();return}const c=new DOMParser().parseFromString(l,"image/svg+xml");if(c.querySelector("parsererror")){ds();return}const f=c.documentElement,p=f.querySelectorAll("g, path"),y=Math.max(p.length,1),v=Math.max(100,1e3/Math.max(y,a));for(let A=0;A<y;A++)o<a&&(n[o].style.opacity="1",o++),await new Promise(_=>setTimeout(_,v));for(;o<a;)n[o].style.opacity="1",o++,await new Promise(A=>setTimeout(A,v));await new Promise(A=>setTimeout(A,500)),e.innerHTML="",e.appendChild(f),e.classList.add("active"),e.style.visibility="visible",e.style.opacity="1",ds()}function d1(){try{document.addEventListener("mousemove",d=>{try{const t=d.clientX,e=d.clientY;document.querySelectorAll('[id*="Pana_roz_degrade"], [id*="Pana_roz_opac"], [id*="Pana_gri_opac"], #HARD-SKILLS, #PROFESSIONAL, #CV, #ACADEMIC, #SOFT-SKILLS, #HOME-BUTTON').forEach(s=>{try{const n=s.getBoundingClientRect(),a=t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom;s.style.transition="transform 0.3s ease",s.id==="HOME-BUTTON"?s.style.transform=a?"translateY(5px)":"translateY(0px)":s.style.transform=a?"translateY(30px)":"translateY(0px) scale(1)"}catch(n){console.error("Error processing hover effect for element:",s,n)}})}catch(t){console.error("Error in mousemove handler:",t)}})}catch(d){console.error("Error in addHoverEffectToMainElements:",d)}}let zu,th=!1,Vd,zh=!0;const $d=5e3,Vu=400;function u1(d){const t=d.match(/(\d+)_(\d+)$/);return t?{col:parseInt(t[1],10),row:parseInt(t[2],10)}:{col:0,row:0}}function Wd(){if(window.innerWidth<700&&document.body.classList.contains("no-wave")||th)return;if(th=!0,window.innerWidth<700){const n=Array.from(document.querySelectorAll('[id*="Pana_roz_degrade"], [id*="Pana_roz_opac"], [id*="Pana_gri_opac"]')),a=Math.floor(Math.random()*6)+8;n.sort(()=>Math.random()-.5).slice(0,a).forEach((h,c)=>{setTimeout(()=>{h.style.transition="transform 1s cubic-bezier(.4,1.4,.4,1)",h.style.transform="translateY(50px)",setTimeout(()=>{h.style.transition="transform 0.7s cubic-bezier(.4,1.4,.4,1)",h.style.transform="translateY(0px)"},350)},c*80)}),setTimeout(()=>{th=!1,zh||(Vd=setTimeout(Wd,$d))},a*60+400);return}const t=Array.from(document.querySelectorAll('[id*="Pana_roz_degrade"], [id*="Pana_roz_opac"], [id*="Pana_gri_opac"]')).map(n=>{const{col:a,row:o}=u1(n.id);return{el:n,col:a,row:o}}),e={};t.forEach(({el:n,col:a,row:o})=>{const l=a+o;e[l]||(e[l]=[]),e[l].push(n)});const i=Object.keys(e).map(Number).sort((n,a)=>n-a);i.forEach((n,a)=>{e[n].forEach((o,l)=>{setTimeout(()=>{o.style.transition="transform 0.7s cubic-bezier(.4,1.6,.4,1)",o.style.transform="translateY(30px)",setTimeout(()=>{o.style.transition="transform 0.7s cubic-bezier(.4,1.6,.4,1)",o.style.transform="translateY(0px)"},Vu+120)},a*120+l*10)})});const s=i.length*120+Vu+400;setTimeout(()=>{th=!1,zh||(Vd=setTimeout(Wd,$d))},s)}function ou(){zh=!0,clearTimeout(zu),clearTimeout(Vd),zu=setTimeout(()=>{zh=!1,Wd()},$d)}["mousemove","mousedown","keydown","touchstart","scroll"].forEach(d=>window.addEventListener(d,ou,{passive:!0}));document.addEventListener("mouseover",d=>{d.target.matches('[id*="Pana_roz_degrade"], [id*="Pana_roz_opac"], [id*="Pana_gri_opac"]')&&ou()});ou();window.onload=function(){try{Uu&&a1(Uu,".svg1",d=>{try{o1(d),l1(d),d1()}catch(t){console.error("Error in SVG initialization callback:",t)}})}catch(d){console.error("Error in window.onload:",d)}};
